<!DOCTYPE html>
<html>
  <head>
    <title>Coverage</title>
    <meta charset="utf-8" />
    <style>

body {
  font: 14px/1.6 "Helvetica Neue", Helvetica, Arial, sans-serif;
  margin: 0;
  color: #2C2C2C;
  border-top: 2px solid #ddd;
}

#coverage {
  padding: 60px;
}

h1 a {
  color: inherit;
  font-weight: inherit;
}

h1 a:hover {
  text-decoration: none;
}

.onload h1 {
  opacity: 1;
}

h2 {
  width: 80%;
  margin-top: 80px;
  margin-bottom: 0;
  font-weight: 100;
  letter-spacing: 1px;
  border-bottom: 1px solid #eee;
}

a {
  color: #8A6343;
  font-weight: bold;
  text-decoration: none;
}

a:hover {
  text-decoration: underline;
}

ul {
  margin-top: 20px;
  padding: 0 15px;
  width: 100%;
}

ul li {
  float: left;
  width: 40%;
  margin-top: 5px;
  margin-right: 60px;
  list-style: none;
  border-bottom: 1px solid #eee;
  padding: 5px 0;
  font-size: 12px;
}

ul::after {
  content: '.';
  height: 0;
  display: block;
  visibility: hidden;
  clear: both;
}

code {
  font: 12px monaco, monospace;
}

pre {
  margin: 30px;
  padding: 30px;
  border: 1px solid #eee;
  border-bottom-color: #ddd;
  -webkit-border-radius: 2px;
  -moz-border-radius: 2px;
  -webkit-box-shadow: inset 0 0 10px #eee;
  -moz-box-shadow: inset 0 0 10px #eee;
  overflow-x: auto;
}

img {
  margin: 30px;
  padding: 1px;
  -webkit-border-radius: 3px;
  -moz-border-radius: 3px;
  -webkit-box-shadow: 0 3px 10px #dedede, 0 1px 5px #888;
  -moz-box-shadow: 0 3px 10px #dedede, 0 1px 5px #888;
  max-width: 100%;
}

footer {
  background: #eee;
  width: 100%;
  padding: 50px 0;
  text-align: right;
  border-top: 1px solid #ddd;
}

footer span {
  display: block;
  margin-right: 30px;
  color: #888;
  font-size: 12px;
}

#menu {
  position: fixed;
  font-size: 12px;
  overflow-y: auto;
  top: 0;
  right: 0;
  margin: 0;
  height: 100%;
  padding: 15px 0;
  text-align: right;
  border-left: 1px solid #eee;
  -moz-box-shadow: 0 0 2px #888
     , inset 5px 0 20px rgba(0,0,0,.5)
     , inset 5px 0 3px rgba(0,0,0,.3);
  -webkit-box-shadow: 0 0 2px #888
     , inset 5px 0 20px rgba(0,0,0,.5)
     , inset 5px 0 3px rgba(0,0,0,.3);
  -webkit-font-smoothing: antialiased;
  background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGYAAABmCAMAAAAOARRQAAABelBMVEUjJSU6OzshIyM5OjoqKy02NjgsLS01NTYjJCUzNTUgISMlJSc0NTUvMDA6PDwlJyg1NjYoKis2NjYrLS02ODkpKyw0NDYrLC04ODovLzA4Ojo0NDUtLy86OjwjIyU4OTosLS82ODgtLS8hIyQvMTEnKCooKSsrKy0qLCwkJSUnKCkrLCwpKiwwMjIxMzMqLC0tLS0pKissLC00NTYwMDIwMTQpKysoKSovMDEtLzA2OTkxMzUrKywvLy8qKyszNTY5OzsqKiw6OjswMDExNDUoKiozNDUvMDIyNDY1Njg2Njk5OTozMzU0NjY4ODkiIyUiIyQ4OTkuMDEmKCowMjQwMTErLS4qKywwMTMhIiMpKiopKy0tLjAkJScxNDQvLzExNDYyNDQmKCk5OTslJig5OjskJSYxMzQrLS8gISIwMTIoKCk1NTUlJSUnJygwMDA4ODgiIiMhISI8PDw6Ojo5OTkpKSojIyQ7OzsyMjIpKSssLCw6Ozw1NjlrfLakAAAg2UlEQVR42jR6i3ea6rYvPgANIAhVXh8WvkQlioUiFlFcBtAmoiRNdzxqu9p0J7vrdK29zuPeex77nnvO/35n1r1ndHRktI0jTOacv/l7lCBK5UqVpOha/YxmWK7BC4TQFKVXrbYsnimqxuuMVlOQ0XltWjUdCwRJ1M+tC1KudOs9q6+da2adUewG0SC0SwELfHtgDds93VEuydEbl3QMWeNoYkR7b/0x1ZRobGI3mLwzAhePqTAwhg6aogjNsGy7/jwQ4rkdqe7CWLxF8k9LfMVFyRS7VJqtkrW8Vt/bkR8FZJao16ipknbC3Yw2lM7laO6HBEOadEZ2tpf65c4v8e3u7FyU6qbiNNyCuzXZ6pawgnwgmrpTT/Q7w2EZmiIJ0dzWDI7mhQ80IfRnMu2kzA5r5r1pIFoia+/d93HRYp1GV8TbrkWoU/+jdI0Ff6yGwTjT1Hn8J+8m1rKpGiYPuNiHnMtNMIv+zpsk84MYTNW1/+DpwXLvckdOCMYowVNPREe0QlM8xRHXXFhcNDzupwsSmb5pH+0t0RP2Qk+QtI7F1Qm6JRC6ZPBtPq/dq/kH+jxtCljn9TIpW6rQIgmSVyj6lPICIw4N/taka41PFUInth0je9+jO6Kt1G4/a7V2LEgG02B0pHVuCZrgltSKMuIl5SyufUv9mYuQi+mFgzbBEtFo2g+Dh4sSTrLNu8JPh00sQydpb00tqXBvqRN7Q7kqzcnIxCGnvZt/WmJacoOEO6Dcn8Qre03pOCSQxbMOXUuDNx9SxuLz4W1I18gvjViQ67zV0rxdWL8Te/TQkuo8STS41DR48W7L6YP2uWIqiUV8rd6Gbf/rnegKZeG8TpAM6afhGze9JAOxbLjsnUXEbrZ9vLYd7MT32cPF5mKKxmjy7huaoD9n62GOxni3iIJwv0IzZAZjdZkUtolCNLVfYZNaquFjGszVVf+J0vrz4CawoKdHnOzb0NMH7CDBOybfYNJ4rfeMyFNjkFYVTzMFs87rnPGXLUOeNKRVc0LnU7/UIgelzsy3CMuth0YfvnY0wsD3vODUL3eJcKqHQpm8yM3XZQWJxO6Un9iYloyyLpOwN2obHy6W6gbpcb44XmyC+mg+itAcaprGcrwZCqMj/GmtKn0zPvpTz/Cv1dw21XwP3cRupg3H3MF/S71eTKj1YrdwKdc2Mw0fRmb2sFf8lW3aU6JbIZSEPqvXvjM7G/aApyXlXeqKfMq0g/Su3rUGJPSPrtGElgknrZM3xUXqsAP6zMCNVn5u8aJnSNpJv2uru7t2jfRziW2+GuhqfldUNbPk71olwo+46ePUo1U3WKk/e5YK07F/wGRgcpODmQnIlVeHCWBE4puBi2jq28UKpqiN1/4UOrGz59TNYrrQHtd+11sG40BGD+pXdelNqGOg4NXe8W4eacJV/NS9/2Umtym6WQqveqR9xdCMElpxnbkalM4Vf9uaEcWZaKdyibEIjWKxJZPN95niCL3GiaXyssIrHxoLkqkzLCXULN46/f2h3tQJgyip+Tk9EAjJ9aJshq7t8X45aowSKspMSvPf7r9R8yxNptIaHS5ozuEm6luPDApugyNP8OaqiQ4BjaequXA54SLC83eHIY2r+CZp4409Xqw8Aa2oI7XkCrQi+in0w5AqF/kLNrcUz+qkl/lAobY1jSnx5OJNhyXIz3qfNFlXc0TKaglNwdWkWYt9QQ1Kr6W8zue21iNrdJk+N5oCr2O9nEtWKC7IS5J/zdDEYrmnAYfg6agCy+qcgz7ZofeDc4PbUWSvkshWuAc7OjiUyLkj+RAtdlwXJcjxdpkTTHDhK8lBCi8+JtvDVL1W6elmOM++YS0LuSlaP1oUvAeiW3cFnvTr8EbTz1tsSMYdGeZe40sRWu5uAfj7q+ZoKv2FNQ0p5XY1lmlcigHZqTPpabufEVrNuNPi165w3uCVQJHyJqmSJ7ZHnguqwtCmwViIJijj04ba2JNYtB+yORf5gg1/9t9iw4vUpeqiunSAbf+IBdj/b+iG2qrHvuNP0Vd/+ThVZT/lrvHYjjgDbbyxaqgHNM2uhxa1GW3UedZYhMMwM4mQhltouK+IV4NdbIQNM+8Yv311RZk9kT4tiYR4LkyFcuPpdcjuhUuFqBAWRZa11lcZ3gEBlXywsNhrt+plISZP5DlsV9l4EgY6J3yZPTUcMrgaWAT3oI79eSbGEbcJpr6BD8kyDiVt+G0/hXosQN4NFXKlfWIfsIs0BHODVok1/IGnKFHJYIquh8Xo+2+bkQNTGgWmN/fZ0Y33LSj6lr1GyV7mWIKg7ZTRZPGuhF/zjRNcQ1UPtSYgnWQxSs0yrVhwNDcdGMNSNe2JT3WuzbAM3HykyAajS3Uphf6STKEqxLas9EnmnhA/lyj9Uj+JoY7SVgVmGLl46Rm2u98sbkap2lzAdKBG4r6LgulQOSSjQv1GWdQ0jtDUK/mAaqM1Uqjpu4k3Rvfvxv7YTxLSK+wN3E5jVIzmF23uZ7hiH/sVP49D7tvoKp4S8b1LuvRlivVB/algbhcFITYVXvDpLzpDfplR2uD5V4XJFxpjmIpLc9Y5sB2TpBRix7Bme6GZIq+06v3XzNeTcA4obQIKxrnT4C2JpOqD92dbmSX8MGazly5EsZVMvSU1f4RZwyu8iQXbVdeLlZrjuTT1jrY1uk5c7iZ7RsvhhluqAkq4JpVQAg7RJFtSu+xgJ8Pv6O1j5DkLxT8mkbfyRW5DrQmG7hiDIjCgBsADbjuof6YHLGeV6a5Q1Smx9joUXPpdaaDx97A/Wq00oJkdR7ZYuQRfS533JtxO1erduqWOYIt3wh0wpbLuCNIYkwxbswbikCUu2CDCS+Q+7rgVtfRcm+SOcdKPRlZ/rE7wNVUEE39KTS5uvUKN1PUnkloPkyzhyGQ8qkouEjJ3H/VXdqG6asSRiw3ecMlBvDDt8dDhBHXMwZ2Cajzjr7/76T+IavqPYvz6r7//E/3X3+N//h/0QozbjPgPiir69P/8X3/9F/yv8b/827/++98WItPu5/Hvwd8YPf5bp/2/lX/T/+Of/0MJ/lYTa+L/Ef+d9vN/3/2T6P/+jyTzu/evf6U7vxN7B6pJkRtAF6jUr8I+P8RsP/ptGhfqFk+pQ/DgAy6NJtRYJdXmp4gK7WLqLKJ+MaKhGjOojvL+SnIWrkpy0SLHDe4QuyNzaEA15mLMCcmE8Em+4HdOihW4/ZWuppJEmzeAwcDtv7MuLc9y2V5atvxXNe3S4DUMt5/Qy2LM9kSYKiVWBuKlfp4nxTntpuW03JbIlkiRvBXmT23g1I2OYe6IizUHPIq6zm6mbfsbteKmi/sg9J+ocQBMctGFO7iljo8TPN+z3jxw4do+ZwfqoR9dkNTKHyM305GpTkfhcHexVkPVGEbUOjuo9f0UMPHBFlGEx0SLvJvVRKTwW7PSew5oPme+E42+frJa9cGt2njS3dK5kIif2eYbhuSEQXEqMVfUjhGIuin0G0/W5ezJyJQy3SpMLai4M0JUWb5u1k9tny5bd1pPwYBpQuDCXZl62xg4CdVEAtflXHs6JKmP/pH6mOl796Lgopj0o8d5kKh00hxG3OSdEE/QBo9Hgr8JJqAeLDwJohG5j/DGh61Rc/+tf22/8kEnxHNCEjo0ElvvGfESZkqmz2BDcKV1H1buSkhkdg7p1IMGs2s17nYjpblrWuE2K9WEO/hcRp5e9oOF/QBmOaDtgil+oaU6szPrdwW65fOB0KUTsVUn7LFU7J8e6cxJIl9+FHw5MQMzuQJ+4oxMH3iW/5GK+hWuG0T+gTLs+fAjdtUd58TmIUq04EeyRCYCjkldow234aIgR5bqwrtZosZ+6YEqAmDqatJ9lWasz4IquKALPtd92hGI3Z2BdzzZue+REl1Om4DIWD+RrtUTOJLI+S0jHowXXdAxsGLSd40zYNuEUlOGhrwL6c7tcOtUOvpJCP7QBQS19H+GvZn05ewjlVLz+IGKoC9TyfQjLMBNmXCuqqtTdOSukZW48B0HqgSTCBrBnlFvF4CG2Su7yFzqmJFURK3UmTT3ru050r0ptUpMilYnBJWfl2Bv6kPlUuE1kxxpdzui9AubsR2N2boVSu81OulAwBqoSr1LZ0LLYOomyZHmjqnXlP72s8LnDouEJjtodBvdHaG1jMySYO7crWd90MpCRyCG14vb5IE7Arupw/y/RcCm/Tm3zK6zYj8PYNaGldiUfkB/LHWcmf2lVM+mwyU27a0qq2tscrQ/vzBjN26DnntIrOyGizzXK35yKQdYnUABkyN4saz3WD/viF+eCcsXnIajdWYJWaYHRstIis9CS+tqnFGmz2j5uzfr3Z4prqgK4XOT/PyftvjZqIm8lhkfxJ7Ol3CJF1piYBGAG8wtAk56Drw1YwmOpcz+NdfkSpSLplRXLXHL0Rquj6YW/gabqgK7Dgr6NwtH0B/AN7XrN+MVJ6AmXmUuqmQulrNNYPmH0RoDogydOKLo/QbfYNARSQQKISRCzRXU+q9WWJFL3LZW6u34CkeG97xC0NNGaJ0bvK6SnZS3zPskr5EtuCgjMWR5o2x5BqhKmDWJPRe7JMEOyRb5uUKlHaGVtq5ivSOaSliSXp9SQm2qk8MRJh10MAp9QQ2H5t59J8rjiwSZtoIfMGjlLPVNdYl/LBR0AO6WLGDmkLkIPRE45Y9MftdAK/yNu1Hn6tzOQTesgQ+8fSzB19wO91vCnO23vOWQdwJ63SJrYjdfKFW6W281PKs2k8iT9ai1cgJ4sa3xqdvmtxR8/+D1B8AKc2u+6JftryRhMWSQtoSBgIyyQGyxcnELuAasXN12oSriU4RMz1DD6RL0TSV+om7i1Yt+jEE/jnawM8cX/UhN4nkiv/w9eALrzNhXuQfOzFL0Fi6SjF7/4Qn8rLYBoa85cvgAnkCEBP+HPbEnquVXCZsMS/yzYw2Vru60P/+nJPYKkzZFjmbykzUoEqV836T5q3fP/L383dF82tx18/AZgZczMAgyeWYKmSZIqtHL+e+O4ZRcq9VI3g/qPeCoiK4pcgEqdbS0S/Be54sbVQOuJVPNBblIghzeasNu7h/g+Sz1IdhI5lCwq1nUb3Ji4OCIcqQZqtqJ5w7rXrg/DA9IgVmEGhDgGecEwnCTHffXcXs0V3OCEVzYDKS1vp/oX+ng+6XVU86UjA6FMO2RXOOOrqY1GgPvrAk9HV/BXtCu5RuwF8qgdGDLsBcui4E33ymdBip1X8uKyhIWT8qNRDsXz+gvO9UiEC0d8RG4Tf2x8H4slljgHtCBcxHLTWOYJm5H/fCPCzOgf9qgOUxTRZ0Pc6ha5yLuLVT9ntvIa6gacE99mCovdUumTQdRP4RPsS9129eEe2uSvvGh0bV4Y3QPPhPZMqhZWSMa5R0Hc1SGO4IVOQc0FrirlibTVfKRrYkD8kz3b+X65/QkUNaZdrdl3mCap0Hf3YcCw/LiouJYNbqz88UqeDYv93yO7vvXtgl4XCyAO4ODkY6W+83+LZU//p3/zXNGGrUKClCiOnL27iJZbNWDF02XXAOeFlB7IaADoMH1Yqr+UP9biyZDEa/iJt4MDeIz6GKTdLVBfWGVtRN4fdT2rgReX8UXwF2zOrradm4J0nyTgdPnai3RvzpZvCKDUqjOwD/QA6EDaMCLewX6QWYVnHY1sx1bd8ovYnPm1ZvPH+rE20lWjOCnZ66/xDt0QAl15FjfBcZp+i9OU0RNPQ0t3x2pSNWo8eiYudwsnuP1Hq6iH1LJCJynkYsfgJ0p3pF6SoQk2l+jqE8CPk+ziGJRSKjs+W5AO185umPdkYzlK4wl7TC9NxyyDP7ZoyYVoXiuS6SjnInlLWrwz1i8bGTKXX0AVQWkSfIlglW3zRJRJ8bg5VgE6ZEnqNu9B++0GNQvDQJvFize4ESNKBJP+8vA3LM4AX5SIBq08Mob+7QMTCZx4nwP/64+4BnlZC+8WtlP/CXw6t1PwMwkJ3jhP1FiXLhDF/3I6FGUzO2DSi9ABxKyyL9paZxSEz40ZCPQToDAJu1959k7QdbVxgB4icsu2s4zsTPJhcEDo+N1GX4zSk/wriRh8AqwL62972i9HJHd1ydaLXVzvKvOfGGw5RVcUVMiKXFH4APdkQU/dc5BX0YfKTNZYXCW9mb8bc8mufoQP6BbdQmT99ZjoYfr/go4TgQX9IDgztim7wyFeGMfbNaeqj8Dzs38pgcqwSv2hbqB3oSGKWKy+sesY7p57wAHldqE6NDudk/W7s/zjrK4rZFlFvaGxnSZdHbc1y47qDN6xkoK8O3bfr2j41dlJZ71rB4dlDqapPFa8N6xBrprUdtenUCHwxKNhw1uuTBh+9uU45k4REpQABN2bAO9DSLqoIL26gNroWgup5pUMxHUNSq4Gyz47vBPvilpo5f9OYI2ddAqTqmnxXERxQJ3UK8fHbVE9HagHi3+tqNRoNsArdmAxHA5LwtQo9ZAaNKUTljnokljo2x8scqVpEEIPc01fPCdHOCg0DeWBz8D5TVAAfx8aRH5X2ZYNI3ebKDZdeJ+oBDAxmRqJ30Eh2/DaeAy5diVNMpEDmXiPDsGTzBLXy8eVDdJoIafgx/gxMyQi454QrW56nCyeELgSuNNEmYkflF+t3CZQOVRWjKhIuCclmQSlAXT3+4JGG75B4t/5hQ+ldMP4LsAW6z3XmU6IJJwpnGVnsgUZhoY1fZlwTR8wSU7xRejf2uCx9Z5trVTRRJP9KnEb134dEieil6eCOGWgboI7xsqsqM99jfJLTePjygKlH2CVxxsse9QRzTBFjD/Kjqitr/CCTBt/SJ6nLxz7cKP9pFqBpp0lN5y+adKNsZjrPuroemZauH9aTTFD3EKHW8S55XBLFQAt1jgxTQCTwxmx/JyfsZDN1RroN3VaxpSenpIX7K+ZbL8VdlQDcI4Cbzg3QJLa9yVqNxUelu+EtxLVqeekaAvSJkO6sSVqbUajxqhKshNpvZqoeApF0k/0P0ikkwUcbdwc4A1ejN7Oo0O15kG7hTMoK3hZRBCX7YYeLW0wvcXx/18n/u37yLgzBYVBUvORGli+sfRcX/74uD6P4hq+7xu54TlWJLFzT63uwUDwuEDdOjJQqx7JV+ZjaEAPi7t0MMrR4Q8Rkf18uxD6RK0RKh0hL8YU+DeL97i4pa5ZSyAfXKwZRS/8gXcxdZXm62RBDj8U3sN8x95b5PpPs/mCBKYvpaA50pN5Ct/499AFTtwQ5vgeSh+NHrKIi4NVpwM/XzRaNfJD856lPE6M21zWPguFsH7jbLVyEDfRmt4VwrhCJ5VTYmcSPfGgO5clfN+vbaDZ7sakU5+2vZ2WCDY031NxJarVytfDDVtiafcTGO2rJ/taoL3zChN2qmjxofczTOYQPPVQPh0JVtYgdUQINcSiNEEy58UdYXX1MpWUCEBx7LbcGtAm8XWRQTVOaoV3ySri4RShhs/B/0m4jX6OAwXOvcA09bNSG4czEGv/Wey6V/jbTCNTW6awXdNTcA1GsPe1E9fZdGl7R0vyoVpIdJtfC6d32NNErrvq/R+d65VG+YOwRXppXxOCYyGNSf1K3x6VxAW/vtz4EC1SgCOSPdN62sLsoIzuDfg8GwZAbquVO8HIuFP/ToVoeUB7nnwMF35a1wK1tI6fkrqFKhQdeJpwyls0pIy8AZde3/6LUUbFaYJthyUJSU/kqDXTLQElnn0Jr4B2RVghNrmNmoEn7pXIeshPguXVsvwoTdmClq49JJU3LWhHyWTrJL9bRP6VKv3tZoA/th77p5Jw++OEENvyvWy/pNeExiDUVQaXIRGh8xySZTI36yueFaSXo1uJY0RnXYgEOoWWOJHeaVuX/bGNhHsh2yinznl/++NJcE9j6fBPRcBdq9hb8awNw8U7Bl6GM7x69EDOIIbX/npZ++amlHR9L/35mE/2Ss4gb0xCcY4VyTFLRE796vHysLAamqcyO+aFQyJIDBNslbH2/MrAvZiSEIedc/cqjmv4fbda2pXbv+F5a2szSsdkm9noiNURXt8edUhGUF6fSZWd1IJaXKFwD+49R6eCXD4Bkef7j9tRtNMVgW8BhRz/Qpy1TmeYk0doyjZoJSbePOReVHgkFsCFuQJ+Lgc4BxeAsK/cOiNDRmdNw0ctYhn/nQ498dYI5znzGLoJi1rav7Cn88rL3wLePVtDK5gl77Tki3gHEsIAQ2+IKgarj7Y8W1IQzV5V9N+0TjLqbg68WfKcOmBCOj3JkwJhVIkwDhc+JorXuZEPMEh0vvH3x7iqf+VAwXgd4diZiaJD1zHL9Snx6Wfg4IugreyhabQkcir+y5XgDtdx3Avs7lkeeCBwDvZoTUCXx5QrZkcEqWfYEiEYRs/EphmRALSNGR1Iclgdr5VFoELpzF4++f35w3/j0t5ucW3n2ch4PQCLuUXupsPRR7UA5FjSKrMtPcKAZJfagO4lGE7FH3YKMjorpK0ZxAv+i2JkJhtAMWWWFej4RhPR/cJ3DxwocCvXDi4SGZU4cu+K32XndiFWgopAl+0GApcwf1XvymJcFs39jExIBO4yUjU9MExBLQYc9H+W7+IgdESPRpciT+rKZPebVtaVq+1GYO/5xTAL3HASjNTGIgMvdjWbgc7JvdE1zIFpuC0U9ESiZyzBixzxWxj4Kwh8My34q+FK3KNLtmsA1qyrmKSNQOXCPUZd+ONelBTvFoUI/CYsqa/RhtKiyMf2CgSFqEPk59Y3uqnlZ8gFpswfSYyko23yVZYxzKGxGm49Zqxg1l8oz5Ra9XaRwHkuxepmgyhm0SoNy2KlbcEqK+9QqS9PNx9Ihm9U7gsR55SSJ1FBDNnkuWKxIZ0SDpXuOGwZdoUbOMDPHP4vBAgz2VlSEJAHZGJVbYIg7l/FO5KfIVvxC8pPPxMGcNMoevFDeStt2iqztE10n2TA4dgJH76YS9HDhKHD3iCx6ieFX84BAI3QQnngh76f5ruPQVbr5qZmck/5UjDc26lfrOvUBWy0Ogl8bCoOkMOns81TnC3cuUS9KW8+9A+fe3XYZOFUPG1u5epSSmDLw0s5s2F0W30ANeo+zJkJQz9SPZgzwYpEoktofhGVfmLOAB20boCbW1QWq/NpET/hnMecw/uSyAH4NJc3ECOU4nnkK1fj3S/i5dwb3R7k00AqQQUwt7Ie1qV0aY/VQX0J8hLPy7eBNXMHYZYDNxHZ2Qh6AuXJxq+AeRec/Q+JLhZV6hpXwQEzw7bf5v9uUf2vpq3qlhmy0IIGTkwYdCfSAFmqbdo+3XvDTDjFJde0mbeQLcn2n31xaAqJ0ixO/CLsT4I4G4DoncVTgRGNBtsCcjISWT+oeXZ4Iedw/8OsJI1aPnNKLX/60VvcZb94uasRxCkqlPQ11u1Sa2hHvB80WQENxVyzjns0/PiEByyil21Te6oisk3mNCEMrhouCFO3yEZTHHOCMy9eb/4Tmi8cVf3Lf7P53SY2hX3PSN033As3ETIMLHWumWEO9JXHA2y2SIBlIPpLGG2qvNsCIlIr+B1SWAqRKm2w6Blf7U+zCSBwJrfHG5i8J5Gax/cVonMlon7aHJX/gSvucIncRP93XCqkv7D8IFKFsLiBgHqUpXhE3pYjEcV1dk/JD9zFVCfEaQIVX8Jmfz7IIofcBKQ4OaG+C3xC2veX9CD+iAFXDNaGg9eTVxvkbJRJlW4Nk9Wk13kn696jWppRDe/8pDrYMO9ZyxZ98ReKSz9kWKLLyk2zCZgAniCkLJVX3n1M9DYbomyahWiv/KixRIV9hj/oFz87I+HLznbPTjpa+D+bZQnMuRsljTpv90vQUt/pK7jCFnA30B/jtroSF2/m/gpWn1aQs5WeA6ghzF8SdqWI20fghdSeDOCSCmLgTkfaGgGDmw7nHFkRzGtag57IHS2na06I+gzEphXo1w/Zx2BM/jKL2nZoFjHggtFQjYi8nSVRSXIE58RPbBObXk7uuIL9+rs/5Zo7suJInEUxgsiZZAWS25iBtpEiZeBgDtghEoAE0sjcayNq85M4tbu/LF5h51335PsGzQ09O875+vUS89lkWMyNOFoip2PuyWyMP/iU2XIZdfCCJNDjebDoBLQdpy7QQZC7s9c0wjHJervQNDu2jWzBW5MSAJMr7bP+Iv92BkS/GGgzjEn7MF1IRKFwwzbjbS4/slGOmhx9cZrFu7HSEefojNv3r0UaKfKOWzXsq1zEugbzlMDFsacRJJI/iJlK3vtkZ+PLZIVMFlKA32wbq2Kd5T0uCLZ1CPkAfCdzkz2EYscjDcZq2AWfziN2covN4kXE1lQXPPLTNM1xx3tbiepcO/t3SWm4w87qfh99SL0ZnY+LKFPLPeXVM2mIIoVWt+9Nk0I7nY4O79iGYqxZ8RVz289an6NVdJWnSKZvJQCAuHNiVaDxPAFoH392t9wot5t0/qmU95eEWNbU2udUW5sN9JVqcYlvAIfLeYC33oUzzxZgSktsv21mA7Uly1FA5VnoJFh6N244Wmv3YJGFv/TCPryaw+ZORlpZjQdq/2DYXr3EZskfed0G61P09ipTKmlTQ1067Rg5+PAk5FlQ9e0SWbGf2B/08kqymOTMVOznsALHHNFH4LFRKl2F/NOiYFl9khNHnSu9Ak5sq26Ynl/i2fdTle29Y1ugqmR5Yj4YT9pvslFyYCbw0mNFr5rVQm1LvkG27QMq9ph3t8fmn6r6SQ4oSbr5tz+J1kIawGzDxb6VYOvvWhobDTXfBeNv3b4aNm5XUinsCGqG2q/45m3+LoCOsddFceYhRx1Tsss9PLdPfJdErFMjYd3gddjiP0+XQjcRadZP6bwNLySvunFf20Czy6JqdEW2a96KxdYdOryBv1BjbuUq2yCHeh+6sk7fGmmPi50pe/1l5TyPe5oHW9oPnhPswLyf2TFDdCyYlhwBCstv5C1HwlW7xWoGT9XZt4qVj5WryLPLLD6h/5cMLEjWzgCeAIKNsLak92aBqBsHl4AJwl2N4jfvbSkBExGimv0nFvv09uDScQbjx+w4kPQjgjlW+g9ws9VEJvI2k8N6XxVu0uIwovgTFdunG24gBtaDi+y1YLQwZ8mwbip5fVlO3k0n0AEr/ETbtu8Vjkm+nNSiEb7X/3fMjBL5A8PdgG+/FnbexbFFExmEfetXAnisEKy5z44WVPpQZjSy/jzeGn4yDRsFGqhh87QPaDBWhlo37IFbe/C0xynS91d2tP/AJoJS0sVF6iwAAAAAElFTkSuQmCC");
}

#menu::after {
  display: block;
  content: '';
  padding-top: 80px;
}

#logo {
  position: fixed;
  bottom: 10px;
  right: 10px;
  background: rgba(255,255,255,.1);
  font-size: 11px;
  display: block;
  width: 20px;
  height: 20px;
  line-height: 20px;
  text-align: center;
  -webkit-border-radius: 20px;
  -moz-border-radius: 20px;
  -webkit-box-shadow: 0 0 3px rgba(0,0,0,.2);
  -moz-box-shadow: 0 0 3px rgba(0,0,0,.2);
  color: inherit;
}

#menu li a {
  display: block;
  color: white;
  padding: 0 35px 0 25px;
  -webkit-transition: background 300ms;
  -moz-transition: background 300ms;
}

#menu li {
  position: relative;
  list-style: none;
}

#menu a:hover,
#menu a.active {
  text-decoration: none;
  background: rgba(255,255,255,.1);
}

#menu li:hover .cov {
  opacity: 1;
}

#menu li .dirname {
  opacity: .60;
  padding-right: 2px;
}

#menu li .basename {
  opacity: 1;
}

#menu .cov {
  background: rgba(0,0,0,.4);
  position: absolute;
  top: 0;
  right: 8px;
  font-size: 9px;
  opacity: .6;
  text-align: left;
  width: 17px;
  -webkit-border-radius: 10px;
  -moz-border-radius: 10px;
  padding: 2px 3px;
  text-align: center;
}

#stats:nth-child(2n) {
  display: inline-block;
  margin-top: 15px;
  border: 1px solid #eee;
  padding: 10px;
  -webkit-box-shadow: inset 0 0 2px #eee;
  -moz-box-shadow: inset 0 0 2px #eee;
  -webkit-border-radius: 5px;
  -moz-border-radius: 5px;
}

#stats div {
  float: left;
  padding: 0 5px;
}

#stats::after {
  display: block;
  content: '';
  clear: both;
}

#stats .sloc::after {
  content: ' SLOC';
  color: #b6b6b6;
}

#stats .percentage::after {
  content: ' coverage';
  color: #b6b6b6;
}

#stats .hits,
#stats .misses {
  display: none;
}

.high {
  color: #00d4b4;
}
.medium {
  color: #e87d0d;
}
.low {
  color: #d4081a;
}
.terrible {
  color: #d4081a;
  font-weight: bold;
}

table {
  width: 80%;
  margin-top: 10px;
  border-collapse: collapse;
  border: 1px solid #cbcbcb;
  color: #363636;
  -webkit-border-radius: 3px;
  -moz-border-radius: 3px;
}

table thead {
  display: none;
}

table td.line,
table td.hits {
  width: 20px;
  background: #eaeaea;
  text-align: center;
  font-size: 11px;
  padding: 0 10px;
  color: #949494;
}

table td.hits {
  width: 10px;
  padding: 2px 5px;
  color: rgba(0,0,0,.2);
  background: #f0f0f0;
}

tr.miss td.line,
tr.miss td.hits {
  background: rgba(185,73,71,0.3);
}

tr.miss td {
  background: rgba(185,73,71,0.2);
}

tr.hit td.line,
tr.hit td.hits {
  background: rgba(95,151,68,0.3);
}

tr.hit td {
  background: rgba(95,151,68,0.2);
}

td.source {
  padding-left: 15px;
  line-height: 15px;
  white-space: pre;
  font: 12px monaco, monospace;
}

code .comment { color: #ddd }
code .init { color: #2F6FAD }
code .string { color: #5890AD }
code .keyword { color: #8A6343 }
code .number { color: #2F6FAD }
</style>

    <script>
headings = [];
onload = function(){
  headings = document.querySelectorAll('h2');
};
onscroll = function(e){
  var heading = find(window.scrollY);
  if (!heading) return;
  var links = document.querySelectorAll('#menu a')
    , link;
  for (var i = 0, len = links.length; i < len; ++i) {
    link = links[i];
    link.className = link.getAttribute('href') == '#' + heading.id
      ? 'active'
      : '';
  }
};
function find(y) {
  var i = headings.length
    , heading;
  while (i--) {
    heading = headings[i];
    if (y >= heading.offsetTop) {
      return heading;
    }
  }
}
</script>

  </head>
  <body>
    <div id='coverage'>
      <h1 id='overview'>Coverage</h1>
      <div id="menu">
        <li><a href='#overview'>overview</a></li>
        
          <li>
            <span class='cov terrible'>0</span>
            <a href='#lib/parkapp.ex'>
              
              
                <span class='dirname'>lib/</span>
              
              <span class='basename'>parkapp.ex</span>
            </a>
          </li>
        
          <li>
            <span class='cov high'>75</span>
            <a href='#lib/parkapp/application.ex'>
              
              
                <span class='dirname'>lib/parkapp/</span>
              
              <span class='basename'>application.ex</span>
            </a>
          </li>
        
          <li>
            <span class='cov high'>100</span>
            <a href='#lib/parkapp/auth/device_model.ex'>
              
              
                <span class='dirname'>lib/parkapp/auth/</span>
              
              <span class='basename'>device_model.ex</span>
            </a>
          </li>
        
          <li>
            <span class='cov high'>100</span>
            <a href='#lib/parkapp/auth/devices.ex'>
              
              
                <span class='dirname'>lib/parkapp/auth/</span>
              
              <span class='basename'>devices.ex</span>
            </a>
          </li>
        
          <li>
            <span class='cov high'>100</span>
            <a href='#lib/parkapp/helpers/runtime_migrations.ex'>
              
              
                <span class='dirname'>lib/parkapp/helpers/</span>
              
              <span class='basename'>runtime_migrations.ex</span>
            </a>
          </li>
        
          <li>
            <span class='cov high'>100</span>
            <a href='#lib/parkapp/logging/external_payment_log.ex'>
              
              
                <span class='dirname'>lib/parkapp/logging/</span>
              
              <span class='basename'>external_payment_log.ex</span>
            </a>
          </li>
        
          <li>
            <span class='cov high'>100</span>
            <a href='#lib/parkapp/logging/logging.ex'>
              
              
                <span class='dirname'>lib/parkapp/logging/</span>
              
              <span class='basename'>logging.ex</span>
            </a>
          </li>
        
          <li>
            <span class='cov terrible'>0</span>
            <a href='#lib/parkapp/repo.ex'>
              
              
                <span class='dirname'>lib/parkapp/</span>
              
              <span class='basename'>repo.ex</span>
            </a>
          </li>
        
          <li>
            <span class='cov terrible'>0</span>
            <a href='#lib/parkapp/reservations/guards.ex'>
              
              
                <span class='dirname'>lib/parkapp/reservations/</span>
              
              <span class='basename'>guards.ex</span>
            </a>
          </li>
        
          <li>
            <span class='cov high'>100</span>
            <a href='#lib/parkapp/reservations/reservation.ex'>
              
              
                <span class='dirname'>lib/parkapp/reservations/</span>
              
              <span class='basename'>reservation.ex</span>
            </a>
          </li>
        
          <li>
            <span class='cov medium'>50</span>
            <a href='#lib/parkapp/reservations/reservation_status.ex'>
              
              
                <span class='dirname'>lib/parkapp/reservations/</span>
              
              <span class='basename'>reservation_status.ex</span>
            </a>
          </li>
        
          <li>
            <span class='cov high'>100</span>
            <a href='#lib/parkapp/reservations/reservation_status_history.ex'>
              
              
                <span class='dirname'>lib/parkapp/reservations/</span>
              
              <span class='basename'>reservation_status_history.ex</span>
            </a>
          </li>
        
          <li>
            <span class='cov medium'>50</span>
            <a href='#lib/parkapp/reservations/reservation_type.ex'>
              
              
                <span class='dirname'>lib/parkapp/reservations/</span>
              
              <span class='basename'>reservation_type.ex</span>
            </a>
          </li>
        
          <li>
            <span class='cov high'>89.3</span>
            <a href='#lib/parkapp/reservations/reservations_context.ex'>
              
              
                <span class='dirname'>lib/parkapp/reservations/</span>
              
              <span class='basename'>reservations_context.ex</span>
            </a>
          </li>
        
          <li>
            <span class='cov terrible'>0</span>
            <a href='#lib/parkapp_web.ex'>
              
              
                <span class='dirname'>lib/</span>
              
              <span class='basename'>parkapp_web.ex</span>
            </a>
          </li>
        
          <li>
            <span class='cov high'>89.7</span>
            <a href='#lib/parkapp_web/api_integration/api_integration.ex'>
              
              
                <span class='dirname'>lib/parkapp_web/api_integration/</span>
              
              <span class='basename'>api_integration.ex</span>
            </a>
          </li>
        
          <li>
            <span class='cov high'>75</span>
            <a href='#lib/parkapp_web/api_integration/embers/api.ex'>
              
              
                <span class='dirname'>lib/parkapp_web/api_integration/embers/</span>
              
              <span class='basename'>api.ex</span>
            </a>
          </li>
        
          <li>
            <span class='cov terrible'>0</span>
            <a href='#lib/parkapp_web/api_integration/embers/behaviour.ex'>
              
              
                <span class='dirname'>lib/parkapp_web/api_integration/embers/</span>
              
              <span class='basename'>behaviour.ex</span>
            </a>
          </li>
        
          <li>
            <span class='cov high'>93.1</span>
            <a href='#lib/parkapp_web/api_integration/embers/helpers.ex'>
              
              
                <span class='dirname'>lib/parkapp_web/api_integration/embers/</span>
              
              <span class='basename'>helpers.ex</span>
            </a>
          </li>
        
          <li>
            <span class='cov terrible'>0</span>
            <a href='#lib/parkapp_web/api_integration/embers/mock.ex'>
              
              
                <span class='dirname'>lib/parkapp_web/api_integration/embers/</span>
              
              <span class='basename'>mock.ex</span>
            </a>
          </li>
        
          <li>
            <span class='cov terrible'>0</span>
            <a href='#lib/parkapp_web/api_integration/gen_servers/reservation_state.ex'>
              
              
                <span class='dirname'>lib/parkapp_web/api_integration/gen_servers/</span>
              
              <span class='basename'>reservation_state.ex</span>
            </a>
          </li>
        
          <li>
            <span class='cov low'>34.5</span>
            <a href='#lib/parkapp_web/api_integration/gen_servers/reservation_to_inpark.ex'>
              
              
                <span class='dirname'>lib/parkapp_web/api_integration/gen_servers/</span>
              
              <span class='basename'>reservation_to_inpark.ex</span>
            </a>
          </li>
        
          <li>
            <span class='cov high'>100</span>
            <a href='#lib/parkapp_web/api_integration/helpers.ex'>
              
              
                <span class='dirname'>lib/parkapp_web/api_integration/</span>
              
              <span class='basename'>helpers.ex</span>
            </a>
          </li>
        
          <li>
            <span class='cov high'>100</span>
            <a href='#lib/parkapp_web/api_integration/mb_way/api.ex'>
              
              
                <span class='dirname'>lib/parkapp_web/api_integration/mb_way/</span>
              
              <span class='basename'>api.ex</span>
            </a>
          </li>
        
          <li>
            <span class='cov terrible'>0</span>
            <a href='#lib/parkapp_web/api_integration/mb_way/behaviour.ex'>
              
              
                <span class='dirname'>lib/parkapp_web/api_integration/mb_way/</span>
              
              <span class='basename'>behaviour.ex</span>
            </a>
          </li>
        
          <li>
            <span class='cov high'>80</span>
            <a href='#lib/parkapp_web/api_integration/mb_way/helpers.ex'>
              
              
                <span class='dirname'>lib/parkapp_web/api_integration/mb_way/</span>
              
              <span class='basename'>helpers.ex</span>
            </a>
          </li>
        
          <li>
            <span class='cov terrible'>0</span>
            <a href='#lib/parkapp_web/api_integration/mb_way/mock.ex'>
              
              
                <span class='dirname'>lib/parkapp_web/api_integration/mb_way/</span>
              
              <span class='basename'>mock.ex</span>
            </a>
          </li>
        
          <li>
            <span class='cov high'>91.7</span>
            <a href='#lib/parkapp_web/auth/auth.ex'>
              
              
                <span class='dirname'>lib/parkapp_web/auth/</span>
              
              <span class='basename'>auth.ex</span>
            </a>
          </li>
        
          <li>
            <span class='cov high'>100</span>
            <a href='#lib/parkapp_web/auth/guardian/error_handler.ex'>
              
              
                <span class='dirname'>lib/parkapp_web/auth/guardian/</span>
              
              <span class='basename'>error_handler.ex</span>
            </a>
          </li>
        
          <li>
            <span class='cov high'>100</span>
            <a href='#lib/parkapp_web/auth/guardian/guardian.ex'>
              
              
                <span class='dirname'>lib/parkapp_web/auth/guardian/</span>
              
              <span class='basename'>guardian.ex</span>
            </a>
          </li>
        
          <li>
            <span class='cov terrible'>0</span>
            <a href='#lib/parkapp_web/auth/guardian/guardian_pipeline.ex'>
              
              
                <span class='dirname'>lib/parkapp_web/auth/guardian/</span>
              
              <span class='basename'>guardian_pipeline.ex</span>
            </a>
          </li>
        
          <li>
            <span class='cov high'>83.3</span>
            <a href='#lib/parkapp_web/auth/rsa/key_loader.ex'>
              
              
                <span class='dirname'>lib/parkapp_web/auth/rsa/</span>
              
              <span class='basename'>key_loader.ex</span>
            </a>
          </li>
        
          <li>
            <span class='cov high'>100</span>
            <a href='#lib/parkapp_web/auth/rsa/rsa_crypto.ex'>
              
              
                <span class='dirname'>lib/parkapp_web/auth/rsa/</span>
              
              <span class='basename'>rsa_crypto.ex</span>
            </a>
          </li>
        
          <li>
            <span class='cov high'>100</span>
            <a href='#lib/parkapp_web/auth/secret.ex'>
              
              
                <span class='dirname'>lib/parkapp_web/auth/</span>
              
              <span class='basename'>secret.ex</span>
            </a>
          </li>
        
          <li>
            <span class='cov high'>78.6</span>
            <a href='#lib/parkapp_web/channels/reservation_channel.ex'>
              
              
                <span class='dirname'>lib/parkapp_web/channels/</span>
              
              <span class='basename'>reservation_channel.ex</span>
            </a>
          </li>
        
          <li>
            <span class='cov terrible'>0</span>
            <a href='#lib/parkapp_web/channels/user_socket.ex'>
              
              
                <span class='dirname'>lib/parkapp_web/channels/</span>
              
              <span class='basename'>user_socket.ex</span>
            </a>
          </li>
        
          <li>
            <span class='cov high'>100</span>
            <a href='#lib/parkapp_web/controllers/authentication_controller.ex'>
              
              
                <span class='dirname'>lib/parkapp_web/controllers/</span>
              
              <span class='basename'>authentication_controller.ex</span>
            </a>
          </li>
        
          <li>
            <span class='cov medium'>71.4</span>
            <a href='#lib/parkapp_web/controllers/fallback_controller.ex'>
              
              
                <span class='dirname'>lib/parkapp_web/controllers/</span>
              
              <span class='basename'>fallback_controller.ex</span>
            </a>
          </li>
        
          <li>
            <span class='cov high'>88</span>
            <a href='#lib/parkapp_web/controllers/reservation_controller.ex'>
              
              
                <span class='dirname'>lib/parkapp_web/controllers/</span>
              
              <span class='basename'>reservation_controller.ex</span>
            </a>
          </li>
        
          <li>
            <span class='cov high'>90</span>
            <a href='#lib/parkapp_web/controllers/routing_controller.ex'>
              
              
                <span class='dirname'>lib/parkapp_web/controllers/</span>
              
              <span class='basename'>routing_controller.ex</span>
            </a>
          </li>
        
          <li>
            <span class='cov medium'>50</span>
            <a href='#lib/parkapp_web/endpoint.ex'>
              
              
                <span class='dirname'>lib/parkapp_web/</span>
              
              <span class='basename'>endpoint.ex</span>
            </a>
          </li>
        
          <li>
            <span class='cov terrible'>0</span>
            <a href='#lib/parkapp_web/gettext.ex'>
              
              
                <span class='dirname'>lib/parkapp_web/</span>
              
              <span class='basename'>gettext.ex</span>
            </a>
          </li>
        
          <li>
            <span class='cov high'>94.1</span>
            <a href='#lib/parkapp_web/router.ex'>
              
              
                <span class='dirname'>lib/parkapp_web/</span>
              
              <span class='basename'>router.ex</span>
            </a>
          </li>
        
          <li>
            <span class='cov high'>100</span>
            <a href='#lib/parkapp_web/utils.ex'>
              
              
                <span class='dirname'>lib/parkapp_web/</span>
              
              <span class='basename'>utils.ex</span>
            </a>
          </li>
        
          <li>
            <span class='cov high'>100</span>
            <a href='#lib/parkapp_web/views/changeset_view.ex'>
              
              
                <span class='dirname'>lib/parkapp_web/views/</span>
              
              <span class='basename'>changeset_view.ex</span>
            </a>
          </li>
        
          <li>
            <span class='cov low'>40</span>
            <a href='#lib/parkapp_web/views/error_helpers.ex'>
              
              
                <span class='dirname'>lib/parkapp_web/views/</span>
              
              <span class='basename'>error_helpers.ex</span>
            </a>
          </li>
        
          <li>
            <span class='cov high'>100</span>
            <a href='#lib/parkapp_web/views/error_view.ex'>
              
              
                <span class='dirname'>lib/parkapp_web/views/</span>
              
              <span class='basename'>error_view.ex</span>
            </a>
          </li>
        
          <li>
            <span class='cov terrible'>0</span>
            <a href='#lib/parkapp_web/views/layout_view.ex'>
              
              
                <span class='dirname'>lib/parkapp_web/views/</span>
              
              <span class='basename'>layout_view.ex</span>
            </a>
          </li>
        
          <li>
            <span class='cov high'>100</span>
            <a href='#lib/parkapp_web/views/reservation_view.ex'>
              
              
                <span class='dirname'>lib/parkapp_web/views/</span>
              
              <span class='basename'>reservation_view.ex</span>
            </a>
          </li>
        
          <li>
            <span class='cov high'>100</span>
            <a href='#test/support/channel_case.ex'>
              
              
                <span class='dirname'>test/support/</span>
              
              <span class='basename'>channel_case.ex</span>
            </a>
          </li>
        
          <li>
            <span class='cov high'>100</span>
            <a href='#test/support/conn_case.ex'>
              
              
                <span class='dirname'>test/support/</span>
              
              <span class='basename'>conn_case.ex</span>
            </a>
          </li>
        
          <li>
            <span class='cov high'>100</span>
            <a href='#test/support/data_case.ex'>
              
              
                <span class='dirname'>test/support/</span>
              
              <span class='basename'>data_case.ex</span>
            </a>
          </li>
        
      </div>

      <div id='stats' class='high'>
        <div class='percentage'>86.5</div>
        <div class='sloc'>502</div>
        <div class='hits'>9859</div>
        <div class='misses'>68</div>
      </div>
      <div id='files'>
        
          <div class='file'>
            <h2 id='lib/parkapp.ex'>lib/parkapp.ex</h1>
            <div id='stats' class='terrible'>
              <div class='percentage'>0</div>
              <div class='sloc'>0</div>
              <div class='hits'>0</div>
              <div class='misses'>0</div>
            </div>
            <table id='source'>
              <thead>
                <tr>
                  <th>Line</th>
                  <th>Hits</th>
                  <th>Source</th>
                </tr>
              <tbody>
                
                  
                      <tr>
                        <td class='line'>0</td>
                        <td class='hits'></td>
                        <td class='source'>defmodule Parkapp do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>1</td>
                        <td class='hits'></td>
                        <td class='source'>  @moduledoc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>2</td>
                        <td class='hits'></td>
                        <td class='source'>  Parkapp keeps the contexts that define your domain</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>3</td>
                        <td class='hits'></td>
                        <td class='source'>  and business logic.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>4</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>5</td>
                        <td class='hits'></td>
                        <td class='source'>  Contexts are also responsible for managing your data, regardless</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>6</td>
                        <td class='hits'></td>
                        <td class='source'>  if it comes from the database, an external API or others.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>7</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>8</td>
                        <td class='hits'></td>
                        <td class='source'>end</td>
                      </tr>
                  
                
              </tbody>
            </table>
          </div>
        
          <div class='file'>
            <h2 id='lib/parkapp/application.ex'>lib/parkapp/application.ex</h1>
            <div id='stats' class='high'>
              <div class='percentage'>75</div>
              <div class='sloc'>4</div>
              <div class='hits'>3</div>
              <div class='misses'>1</div>
            </div>
            <table id='source'>
              <thead>
                <tr>
                  <th>Line</th>
                  <th>Hits</th>
                  <th>Source</th>
                </tr>
              <tbody>
                
                  
                      <tr>
                        <td class='line'>0</td>
                        <td class='hits'></td>
                        <td class='source'>defmodule Parkapp.Application do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>1</td>
                        <td class='hits'></td>
                        <td class='source'>  use Application</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>2</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>3</td>
                        <td class='hits'></td>
                        <td class='source'>  # See https://hexdocs.pm/elixir/Application.html</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>4</td>
                        <td class='hits'></td>
                        <td class='source'>  # for more information on OTP Applications</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>5</td>
                        <td class='hits'></td>
                        <td class='source'>  def start(_type, _args) do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>6</td>
                        <td class='hits'></td>
                        <td class='source'>    import Supervisor.Spec</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>7</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>8</td>
                        <td class='hits'></td>
                        <td class='source'>    # Define workers and child supervisors to be supervised</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>9</td>
                        <td class='hits'>1</td>
                        <td class='source'>    children = [</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>10</td>
                        <td class='hits'></td>
                        <td class='source'>      # Start the Ecto repository</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>11</td>
                        <td class='hits'></td>
                        <td class='source'>      supervisor(Parkapp.Repo, []),</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>12</td>
                        <td class='hits'></td>
                        <td class='source'>      # Start the endpoint when the application starts</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>13</td>
                        <td class='hits'></td>
                        <td class='source'>      supervisor(ParkappWeb.Endpoint, []),</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>14</td>
                        <td class='hits'></td>
                        <td class='source'>      # Start the server responsible for running migrations</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>15</td>
                        <td class='hits'></td>
                        <td class='source'>      worker(Parkapp.Helpers.RuntimeMigrations, [], restart: :temporary)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>16</td>
                        <td class='hits'></td>
                        <td class='source'>      # Start your own worker by calling: Parkapp.Worker.start_link(arg1, arg2, arg3)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>17</td>
                        <td class='hits'></td>
                        <td class='source'>      # worker(Parkapp.Worker, [arg1, arg2, arg3]),</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>18</td>
                        <td class='hits'></td>
                        <td class='source'>    ]</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>19</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>20</td>
                        <td class='hits'></td>
                        <td class='source'>    # See https://hexdocs.pm/elixir/Supervisor.html</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>21</td>
                        <td class='hits'></td>
                        <td class='source'>    # for other strategies and supported options</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>22</td>
                        <td class='hits'>1</td>
                        <td class='source'>    opts = [strategy: :one_for_one, name: Parkapp.Supervisor]</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>23</td>
                        <td class='hits'>1</td>
                        <td class='source'>    Supervisor.start_link(children, opts)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>24</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>25</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>26</td>
                        <td class='hits'></td>
                        <td class='source'>  # Tell Phoenix to update the endpoint configuration</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>27</td>
                        <td class='hits'></td>
                        <td class='source'>  # whenever the application is updated.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>28</td>
                        <td class='hits'></td>
                        <td class='source'>  def config_change(changed, _new, removed) do</td>
                      </tr>
                  
                
                  
                      <tr class='miss'>
                        <td class='line'>29</td>
                        <td class='hits'>0</td>
                        <td class='source'>    ParkappWeb.Endpoint.config_change(changed, removed)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>30</td>
                        <td class='hits'></td>
                        <td class='source'>    :ok</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>31</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>32</td>
                        <td class='hits'></td>
                        <td class='source'>end</td>
                      </tr>
                  
                
              </tbody>
            </table>
          </div>
        
          <div class='file'>
            <h2 id='lib/parkapp/auth/device_model.ex'>lib/parkapp/auth/device_model.ex</h1>
            <div id='stats' class='high'>
              <div class='percentage'>100</div>
              <div class='sloc'>4</div>
              <div class='hits'>602</div>
              <div class='misses'>0</div>
            </div>
            <table id='source'>
              <thead>
                <tr>
                  <th>Line</th>
                  <th>Hits</th>
                  <th>Source</th>
                </tr>
              <tbody>
                
                  
                      <tr>
                        <td class='line'>0</td>
                        <td class='hits'></td>
                        <td class='source'>defmodule Parkapp.Auth.Device do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>1</td>
                        <td class='hits'></td>
                        <td class='source'>  @moduledoc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>2</td>
                        <td class='hits'></td>
                        <td class='source'>  The Device module contains the Device Schema and changesets.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>3</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>4</td>
                        <td class='hits'></td>
                        <td class='source'>  use Ecto.Schema</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>5</td>
                        <td class='hits'></td>
                        <td class='source'>  import Ecto.Changeset</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>6</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>7</td>
                        <td class='hits'></td>
                        <td class='source'>  @primary_key {:device_id, Ecto.UUID, autogenerate: false}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>8</td>
                        <td class='hits'></td>
                        <td class='source'>  @derive {Phoenix.Param, key: :device_id}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>9</td>
                        <td class='hits'></td>
                        <td class='source'>  @derive {Poison.Encoder, only: [:device_id, :key, :secret]}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>10</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>11</td>
                        <td class='hits'>304</td>
                        <td class='source'>  schema &quot;devices&quot; do</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>12</td>
                        <td class='hits'></td>
                        <td class='source'>    # text, in the migration</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>13</td>
                        <td class='hits'></td>
                        <td class='source'>    field(:key, :string)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>14</td>
                        <td class='hits'></td>
                        <td class='source'>    # text, in the migration</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>15</td>
                        <td class='hits'></td>
                        <td class='source'>    field(:secret, :string)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>16</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>17</td>
                        <td class='hits'></td>
                        <td class='source'>    timestamps()</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>18</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>19</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>20</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc false</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>21</td>
                        <td class='hits'></td>
                        <td class='source'>  def base_changeset(device, attrs) do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>22</td>
                        <td class='hits'></td>
                        <td class='source'>    device</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>23</td>
                        <td class='hits'></td>
                        <td class='source'>    |&gt; cast(attrs, [:device_id, :key])</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>24</td>
                        <td class='hits'>80</td>
                        <td class='source'>    |&gt; base_validation</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>25</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>26</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>27</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc false</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>28</td>
                        <td class='hits'></td>
                        <td class='source'>  def set_secret_changeset(device, attrs) do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>29</td>
                        <td class='hits'></td>
                        <td class='source'>    device</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>30</td>
                        <td class='hits'></td>
                        <td class='source'>    |&gt; cast(attrs, [:device_id, :key, :secret])</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>31</td>
                        <td class='hits'></td>
                        <td class='source'>    |&gt; base_validation</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>32</td>
                        <td class='hits'>69</td>
                        <td class='source'>    |&gt; validate_required([:secret])</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>33</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>34</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>35</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc false</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>36</td>
                        <td class='hits'></td>
                        <td class='source'>  def base_validation(changeset) do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>37</td>
                        <td class='hits'></td>
                        <td class='source'>    changeset</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>38</td>
                        <td class='hits'></td>
                        <td class='source'>    |&gt; validate_required([:device_id, :key])</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>39</td>
                        <td class='hits'>149</td>
                        <td class='source'>    |&gt; unique_constraint(:device_id, name: &quot;devices_pkey&quot;)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>40</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>41</td>
                        <td class='hits'></td>
                        <td class='source'>end</td>
                      </tr>
                  
                
              </tbody>
            </table>
          </div>
        
          <div class='file'>
            <h2 id='lib/parkapp/auth/devices.ex'>lib/parkapp/auth/devices.ex</h1>
            <div id='stats' class='high'>
              <div class='percentage'>100</div>
              <div class='sloc'>7</div>
              <div class='hits'>310</div>
              <div class='misses'>0</div>
            </div>
            <table id='source'>
              <thead>
                <tr>
                  <th>Line</th>
                  <th>Hits</th>
                  <th>Source</th>
                </tr>
              <tbody>
                
                  
                      <tr>
                        <td class='line'>0</td>
                        <td class='hits'></td>
                        <td class='source'>defmodule Parkapp.Auth.Devices do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>1</td>
                        <td class='hits'></td>
                        <td class='source'>  @moduledoc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>2</td>
                        <td class='hits'></td>
                        <td class='source'>  The Devices module contains the Device/DB communication related methods.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>3</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>4</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>5</td>
                        <td class='hits'></td>
                        <td class='source'>  alias Parkapp.Repo</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>6</td>
                        <td class='hits'></td>
                        <td class='source'>  alias Parkapp.Auth.Device</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>7</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>8</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>9</td>
                        <td class='hits'></td>
                        <td class='source'>  Creates a device.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>10</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>11</td>
                        <td class='hits'></td>
                        <td class='source'>  ## Examples</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>12</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>13</td>
                        <td class='hits'></td>
                        <td class='source'>      iex&gt; create_device(%{field: value})</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>14</td>
                        <td class='hits'></td>
                        <td class='source'>      {:ok, %Device{}}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>15</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>16</td>
                        <td class='hits'></td>
                        <td class='source'>      iex&gt; create_device(%{field: bad_value})</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>17</td>
                        <td class='hits'></td>
                        <td class='source'>      {:error, %Ecto.Changeset{}}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>18</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>19</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>20</td>
                        <td class='hits'></td>
                        <td class='source'>  def create_device(attrs) do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>21</td>
                        <td class='hits'></td>
                        <td class='source'>    %Device{}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>22</td>
                        <td class='hits'></td>
                        <td class='source'>    |&gt; Device.base_changeset(attrs)</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>23</td>
                        <td class='hits'>79</td>
                        <td class='source'>    |&gt; Repo.insert()</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>24</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>25</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>26</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>27</td>
                        <td class='hits'></td>
                        <td class='source'>  Updates a device base.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>28</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>29</td>
                        <td class='hits'></td>
                        <td class='source'>  ## Examples</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>30</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>31</td>
                        <td class='hits'></td>
                        <td class='source'>      iex&gt; update_device_base(device, %{field: new_value})</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>32</td>
                        <td class='hits'></td>
                        <td class='source'>      {:ok, %Device{}}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>33</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>34</td>
                        <td class='hits'></td>
                        <td class='source'>      iex&gt; update_device_base(device, %{field: bad_value})</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>35</td>
                        <td class='hits'></td>
                        <td class='source'>      {:error, %Ecto.Changeset{}}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>36</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>37</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>38</td>
                        <td class='hits'></td>
                        <td class='source'>  def update_device_base(device, attrs) do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>39</td>
                        <td class='hits'></td>
                        <td class='source'>    device</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>40</td>
                        <td class='hits'></td>
                        <td class='source'>    |&gt; Device.base_changeset(attrs)</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>41</td>
                        <td class='hits'>1</td>
                        <td class='source'>    |&gt; Repo.update()</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>42</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>43</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>44</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>45</td>
                        <td class='hits'></td>
                        <td class='source'>  Updates a device secret.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>46</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>47</td>
                        <td class='hits'></td>
                        <td class='source'>  ## Examples</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>48</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>49</td>
                        <td class='hits'></td>
                        <td class='source'>      iex&gt; update_device_secret(device, %{field: new_value})</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>50</td>
                        <td class='hits'></td>
                        <td class='source'>      {:ok, %Device{}}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>51</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>52</td>
                        <td class='hits'></td>
                        <td class='source'>      iex&gt; update_device_secret(device, %{field: bad_value})</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>53</td>
                        <td class='hits'></td>
                        <td class='source'>      {:error, %Ecto.Changeset{}}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>54</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>55</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>56</td>
                        <td class='hits'></td>
                        <td class='source'>  def update_device_secret(device, attrs) do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>57</td>
                        <td class='hits'></td>
                        <td class='source'>    device</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>58</td>
                        <td class='hits'></td>
                        <td class='source'>    |&gt; Device.set_secret_changeset(attrs)</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>59</td>
                        <td class='hits'>69</td>
                        <td class='source'>    |&gt; Repo.update()</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>60</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>61</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>62</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>63</td>
                        <td class='hits'></td>
                        <td class='source'>  Gets a single device.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>64</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>65</td>
                        <td class='hits'></td>
                        <td class='source'>  Returns nil if there is no device with the given id</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>66</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>67</td>
                        <td class='hits'></td>
                        <td class='source'>  ## Examples</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>68</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>69</td>
                        <td class='hits'></td>
                        <td class='source'>      iex&gt; get_device(123)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>70</td>
                        <td class='hits'></td>
                        <td class='source'>      %Device{}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>71</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>72</td>
                        <td class='hits'></td>
                        <td class='source'>      iex&gt; get_device(456)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>73</td>
                        <td class='hits'></td>
                        <td class='source'>      nil</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>74</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>75</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>76</td>
                        <td class='hits'></td>
                        <td class='source'>  def get_device(device_id) do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>77</td>
                        <td class='hits'>40</td>
                        <td class='source'>    Repo.get(Device, device_id)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>78</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>79</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>80</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>81</td>
                        <td class='hits'></td>
                        <td class='source'>  Gets a single device.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>82</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>83</td>
                        <td class='hits'></td>
                        <td class='source'>  Raises Ecto.NoResultsError if the device does not exist</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>84</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>85</td>
                        <td class='hits'></td>
                        <td class='source'>  ## Examples</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>86</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>87</td>
                        <td class='hits'></td>
                        <td class='source'>      iex&gt; get_device(123)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>88</td>
                        <td class='hits'></td>
                        <td class='source'>      %Device{}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>89</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>90</td>
                        <td class='hits'></td>
                        <td class='source'>      iex&gt; get_device(456)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>91</td>
                        <td class='hits'></td>
                        <td class='source'>      Ecto.NoResultsError</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>92</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>93</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>94</td>
                        <td class='hits'></td>
                        <td class='source'>  def get_device!(device_id) do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>95</td>
                        <td class='hits'>119</td>
                        <td class='source'>    Repo.get!(Device, device_id)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>96</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>97</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>98</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>99</td>
                        <td class='hits'></td>
                        <td class='source'>  Gets a field from a single device.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>100</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>101</td>
                        <td class='hits'></td>
                        <td class='source'>  Returns nil if there is no device with the given id</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>102</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>103</td>
                        <td class='hits'></td>
                        <td class='source'>  ## Examples</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>104</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>105</td>
                        <td class='hits'></td>
                        <td class='source'>      iex&gt; get_device_field(123, :field)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>106</td>
                        <td class='hits'></td>
                        <td class='source'>      value</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>107</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>108</td>
                        <td class='hits'></td>
                        <td class='source'>      iex&gt; get_device_field(456, :field)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>109</td>
                        <td class='hits'></td>
                        <td class='source'>      nil</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>110</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>111</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>112</td>
                        <td class='hits'></td>
                        <td class='source'>  def get_device_field(device_id, field) when is_atom(field) do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>113</td>
                        <td class='hits'>1</td>
                        <td class='source'>    case get_device(device_id) do</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>114</td>
                        <td class='hits'></td>
                        <td class='source'>      nil -&gt; nil</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>115</td>
                        <td class='hits'>1</td>
                        <td class='source'>      device -&gt; Map.get(device, field)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>116</td>
                        <td class='hits'></td>
                        <td class='source'>    end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>117</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>118</td>
                        <td class='hits'></td>
                        <td class='source'>end</td>
                      </tr>
                  
                
              </tbody>
            </table>
          </div>
        
          <div class='file'>
            <h2 id='lib/parkapp/helpers/runtime_migrations.ex'>lib/parkapp/helpers/runtime_migrations.ex</h1>
            <div id='stats' class='high'>
              <div class='percentage'>100</div>
              <div class='sloc'>7</div>
              <div class='hits'>7</div>
              <div class='misses'>0</div>
            </div>
            <table id='source'>
              <thead>
                <tr>
                  <th>Line</th>
                  <th>Hits</th>
                  <th>Source</th>
                </tr>
              <tbody>
                
                  
                      <tr>
                        <td class='line'>0</td>
                        <td class='hits'></td>
                        <td class='source'>defmodule Parkapp.Helpers.RuntimeMigrations do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>1</td>
                        <td class='hits'></td>
                        <td class='source'>  @moduledoc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>2</td>
                        <td class='hits'></td>
                        <td class='source'>   Since mix tasks are not available in production, this strategy let&#39;s us</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>3</td>
                        <td class='hits'></td>
                        <td class='source'>   have a server that can be called to run the migrations we might have.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>4</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>5</td>
                        <td class='hits'></td>
                        <td class='source'>  require Logger</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>6</td>
                        <td class='hits'></td>
                        <td class='source'>  use GenServer</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>7</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>8</td>
                        <td class='hits'></td>
                        <td class='source'>  def start_link do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>9</td>
                        <td class='hits'>1</td>
                        <td class='source'>    GenServer.start_link(__MODULE__, [:ok], name: __MODULE__)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>10</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>11</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>12</td>
                        <td class='hits'></td>
                        <td class='source'>  def init(state) do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>13</td>
                        <td class='hits'>1</td>
                        <td class='source'>    send(self(), :work)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>14</td>
                        <td class='hits'></td>
                        <td class='source'>    {:ok, state}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>15</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>16</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>17</td>
                        <td class='hits'></td>
                        <td class='source'>  def handle_info(:work, state) do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>18</td>
                        <td class='hits'>1</td>
                        <td class='source'>    Logger.info(&quot;Running database migrations...&quot;)</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>19</td>
                        <td class='hits'>1</td>
                        <td class='source'>    {:ok, _} = Application.ensure_all_started(:parkapp)</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>20</td>
                        <td class='hits'>1</td>
                        <td class='source'>    path = Application.app_dir(:parkapp, &quot;priv/repo/migrations&quot;)</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>21</td>
                        <td class='hits'>1</td>
                        <td class='source'>    Ecto.Migrator.run(Parkapp.Repo, path, :up, all: true)</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>22</td>
                        <td class='hits'>1</td>
                        <td class='source'>    {:stop, :normal, state}</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>23</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>24</td>
                        <td class='hits'></td>
                        <td class='source'>end</td>
                      </tr>
                  
                
              </tbody>
            </table>
          </div>
        
          <div class='file'>
            <h2 id='lib/parkapp/logging/external_payment_log.ex'>lib/parkapp/logging/external_payment_log.ex</h1>
            <div id='stats' class='high'>
              <div class='percentage'>100</div>
              <div class='sloc'>2</div>
              <div class='hits'>51</div>
              <div class='misses'>0</div>
            </div>
            <table id='source'>
              <thead>
                <tr>
                  <th>Line</th>
                  <th>Hits</th>
                  <th>Source</th>
                </tr>
              <tbody>
                
                  
                      <tr>
                        <td class='line'>0</td>
                        <td class='hits'></td>
                        <td class='source'>defmodule Parkapp.Logging.ExternalPaymentLog do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>1</td>
                        <td class='hits'></td>
                        <td class='source'>  use Ecto.Schema</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>2</td>
                        <td class='hits'></td>
                        <td class='source'>  import Ecto.Changeset</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>3</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>4</td>
                        <td class='hits'></td>
                        <td class='source'>  alias Parkapp.Reservations.Reservation</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>5</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>6</td>
                        <td class='hits'>31</td>
                        <td class='source'>  schema &quot;external_payment_logs&quot; do</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>7</td>
                        <td class='hits'></td>
                        <td class='source'>    field(:params, :string)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>8</td>
                        <td class='hits'></td>
                        <td class='source'>    field(:received_at, :utc_datetime)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>9</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>10</td>
                        <td class='hits'></td>
                        <td class='source'>    belongs_to(:reservation, Reservation)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>11</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>12</td>
                        <td class='hits'></td>
                        <td class='source'>    timestamps()</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>13</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>14</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>15</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc false</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>16</td>
                        <td class='hits'></td>
                        <td class='source'>  def changeset(external_payment_log, attrs) do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>17</td>
                        <td class='hits'></td>
                        <td class='source'>    external_payment_log</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>18</td>
                        <td class='hits'></td>
                        <td class='source'>    |&gt; cast(attrs, [:received_at, :params, :reservation_id])</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>19</td>
                        <td class='hits'></td>
                        <td class='source'>    |&gt; validate_required([:received_at, :params, :reservation_id])</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>20</td>
                        <td class='hits'>20</td>
                        <td class='source'>    |&gt; foreign_key_constraint(:reservation_id)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>21</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>22</td>
                        <td class='hits'></td>
                        <td class='source'>end</td>
                      </tr>
                  
                
              </tbody>
            </table>
          </div>
        
          <div class='file'>
            <h2 id='lib/parkapp/logging/logging.ex'>lib/parkapp/logging/logging.ex</h1>
            <div id='stats' class='high'>
              <div class='percentage'>100</div>
              <div class='sloc'>7</div>
              <div class='hits'>28</div>
              <div class='misses'>0</div>
            </div>
            <table id='source'>
              <thead>
                <tr>
                  <th>Line</th>
                  <th>Hits</th>
                  <th>Source</th>
                </tr>
              <tbody>
                
                  
                      <tr>
                        <td class='line'>0</td>
                        <td class='hits'></td>
                        <td class='source'>defmodule Parkapp.Logging do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>1</td>
                        <td class='hits'></td>
                        <td class='source'>  @moduledoc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>2</td>
                        <td class='hits'></td>
                        <td class='source'>  The Logging context.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>3</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>4</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>5</td>
                        <td class='hits'></td>
                        <td class='source'>  import Ecto.Query, warn: false</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>6</td>
                        <td class='hits'></td>
                        <td class='source'>  alias Parkapp.Repo</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>7</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>8</td>
                        <td class='hits'></td>
                        <td class='source'>  alias Parkapp.Logging.ExternalPaymentLog</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>9</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>10</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>11</td>
                        <td class='hits'></td>
                        <td class='source'>  Returns the list of external_payment_logs.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>12</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>13</td>
                        <td class='hits'></td>
                        <td class='source'>  ## Examples</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>14</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>15</td>
                        <td class='hits'></td>
                        <td class='source'>      iex&gt; list_external_payment_logs()</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>16</td>
                        <td class='hits'></td>
                        <td class='source'>      [%ExternalPaymentLog{}, ...]</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>17</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>18</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>19</td>
                        <td class='hits'></td>
                        <td class='source'>  def list_external_payment_logs do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>20</td>
                        <td class='hits'>1</td>
                        <td class='source'>    Repo.all(ExternalPaymentLog)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>21</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>22</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>23</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>24</td>
                        <td class='hits'></td>
                        <td class='source'>  Returns the list of external_payment_logs for the given reservation_id.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>25</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>26</td>
                        <td class='hits'></td>
                        <td class='source'>  ## Examples</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>27</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>28</td>
                        <td class='hits'></td>
                        <td class='source'>      iex&gt; list_external_payment_logs(reservation_id)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>29</td>
                        <td class='hits'></td>
                        <td class='source'>      [%ExternalPaymentLog{}, ...]</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>30</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>31</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>32</td>
                        <td class='hits'></td>
                        <td class='source'>  def list_external_payment_logs(reservation_id) do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>33</td>
                        <td class='hits'></td>
                        <td class='source'>    from(epl in ExternalPaymentLog)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>34</td>
                        <td class='hits'></td>
                        <td class='source'>    |&gt; where([epl], epl.reservation_id == ^reservation_id)</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>35</td>
                        <td class='hits'>3</td>
                        <td class='source'>    |&gt; Repo.all()</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>36</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>37</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>38</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>39</td>
                        <td class='hits'></td>
                        <td class='source'>  Gets a single external_payment_log.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>40</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>41</td>
                        <td class='hits'></td>
                        <td class='source'>  Raises `Ecto.NoResultsError` if the External payment log does not exist.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>42</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>43</td>
                        <td class='hits'></td>
                        <td class='source'>  ## Examples</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>44</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>45</td>
                        <td class='hits'></td>
                        <td class='source'>      iex&gt; get_external_payment_log!(123)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>46</td>
                        <td class='hits'></td>
                        <td class='source'>      %ExternalPaymentLog{}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>47</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>48</td>
                        <td class='hits'></td>
                        <td class='source'>      iex&gt; get_external_payment_log!(456)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>49</td>
                        <td class='hits'></td>
                        <td class='source'>      ** (Ecto.NoResultsError)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>50</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>51</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>52</td>
                        <td class='hits'>3</td>
                        <td class='source'>  def get_external_payment_log!(id), do: Repo.get!(ExternalPaymentLog, id)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>53</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>54</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>55</td>
                        <td class='hits'></td>
                        <td class='source'>  Creates a external_payment_log.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>56</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>57</td>
                        <td class='hits'></td>
                        <td class='source'>  ## Examples</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>58</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>59</td>
                        <td class='hits'></td>
                        <td class='source'>      iex&gt; create_external_payment_log(%{field: value})</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>60</td>
                        <td class='hits'></td>
                        <td class='source'>      {:ok, %ExternalPaymentLog{}}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>61</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>62</td>
                        <td class='hits'></td>
                        <td class='source'>      iex&gt; create_external_payment_log(%{field: bad_value})</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>63</td>
                        <td class='hits'></td>
                        <td class='source'>      {:error, %Ecto.Changeset{}}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>64</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>65</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>66</td>
                        <td class='hits'></td>
                        <td class='source'>  def create_external_payment_log(attrs \\ %{}) do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>67</td>
                        <td class='hits'></td>
                        <td class='source'>    %ExternalPaymentLog{}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>68</td>
                        <td class='hits'></td>
                        <td class='source'>    |&gt; ExternalPaymentLog.changeset(attrs)</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>69</td>
                        <td class='hits'>17</td>
                        <td class='source'>    |&gt; Repo.insert()</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>70</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>71</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>72</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>73</td>
                        <td class='hits'></td>
                        <td class='source'>  Updates a external_payment_log.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>74</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>75</td>
                        <td class='hits'></td>
                        <td class='source'>  ## Examples</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>76</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>77</td>
                        <td class='hits'></td>
                        <td class='source'>      iex&gt; update_external_payment_log(external_payment_log, %{field: new_value})</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>78</td>
                        <td class='hits'></td>
                        <td class='source'>      {:ok, %ExternalPaymentLog{}}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>79</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>80</td>
                        <td class='hits'></td>
                        <td class='source'>      iex&gt; update_external_payment_log(external_payment_log, %{field: bad_value})</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>81</td>
                        <td class='hits'></td>
                        <td class='source'>      {:error, %Ecto.Changeset{}}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>82</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>83</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>84</td>
                        <td class='hits'></td>
                        <td class='source'>  def update_external_payment_log(%ExternalPaymentLog{} = external_payment_log, attrs) do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>85</td>
                        <td class='hits'></td>
                        <td class='source'>    external_payment_log</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>86</td>
                        <td class='hits'></td>
                        <td class='source'>    |&gt; ExternalPaymentLog.changeset(attrs)</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>87</td>
                        <td class='hits'>2</td>
                        <td class='source'>    |&gt; Repo.update()</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>88</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>89</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>90</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>91</td>
                        <td class='hits'></td>
                        <td class='source'>  Deletes a ExternalPaymentLog.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>92</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>93</td>
                        <td class='hits'></td>
                        <td class='source'>  ## Examples</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>94</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>95</td>
                        <td class='hits'></td>
                        <td class='source'>      iex&gt; delete_external_payment_log(external_payment_log)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>96</td>
                        <td class='hits'></td>
                        <td class='source'>      {:ok, %ExternalPaymentLog{}}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>97</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>98</td>
                        <td class='hits'></td>
                        <td class='source'>      iex&gt; delete_external_payment_log(external_payment_log)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>99</td>
                        <td class='hits'></td>
                        <td class='source'>      {:error, %Ecto.Changeset{}}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>100</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>101</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>102</td>
                        <td class='hits'></td>
                        <td class='source'>  def delete_external_payment_log(%ExternalPaymentLog{} = external_payment_log) do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>103</td>
                        <td class='hits'>1</td>
                        <td class='source'>    Repo.delete(external_payment_log)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>104</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>105</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>106</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>107</td>
                        <td class='hits'></td>
                        <td class='source'>  Returns an `%Ecto.Changeset{}` for tracking external_payment_log changes.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>108</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>109</td>
                        <td class='hits'></td>
                        <td class='source'>  ## Examples</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>110</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>111</td>
                        <td class='hits'></td>
                        <td class='source'>      iex&gt; change_external_payment_log(external_payment_log)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>112</td>
                        <td class='hits'></td>
                        <td class='source'>      %Ecto.Changeset{source: %ExternalPaymentLog{}}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>113</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>114</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>115</td>
                        <td class='hits'></td>
                        <td class='source'>  def change_external_payment_log(%ExternalPaymentLog{} = external_payment_log) do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>116</td>
                        <td class='hits'>1</td>
                        <td class='source'>    ExternalPaymentLog.changeset(external_payment_log, %{})</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>117</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>118</td>
                        <td class='hits'></td>
                        <td class='source'>end</td>
                      </tr>
                  
                
              </tbody>
            </table>
          </div>
        
          <div class='file'>
            <h2 id='lib/parkapp/repo.ex'>lib/parkapp/repo.ex</h1>
            <div id='stats' class='terrible'>
              <div class='percentage'>0</div>
              <div class='sloc'>0</div>
              <div class='hits'>0</div>
              <div class='misses'>0</div>
            </div>
            <table id='source'>
              <thead>
                <tr>
                  <th>Line</th>
                  <th>Hits</th>
                  <th>Source</th>
                </tr>
              <tbody>
                
                  
                      <tr>
                        <td class='line'>0</td>
                        <td class='hits'></td>
                        <td class='source'>defmodule Parkapp.Repo do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>1</td>
                        <td class='hits'></td>
                        <td class='source'>  use Ecto.Repo, otp_app: :parkapp</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>2</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>3</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>4</td>
                        <td class='hits'></td>
                        <td class='source'>  Dynamically loads the repository url from the</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>5</td>
                        <td class='hits'></td>
                        <td class='source'>  DATABASE_URL environment variable.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>6</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>7</td>
                        <td class='hits'></td>
                        <td class='source'>  def init(_, opts) do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>8</td>
                        <td class='hits'></td>
                        <td class='source'>    {:ok, Keyword.put(opts, :url, System.get_env(&quot;DATABASE_URL&quot;))}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>9</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>10</td>
                        <td class='hits'></td>
                        <td class='source'>end</td>
                      </tr>
                  
                
              </tbody>
            </table>
          </div>
        
          <div class='file'>
            <h2 id='lib/parkapp/reservations/guards.ex'>lib/parkapp/reservations/guards.ex</h1>
            <div id='stats' class='terrible'>
              <div class='percentage'>0</div>
              <div class='sloc'>1</div>
              <div class='hits'>0</div>
              <div class='misses'>1</div>
            </div>
            <table id='source'>
              <thead>
                <tr>
                  <th>Line</th>
                  <th>Hits</th>
                  <th>Source</th>
                </tr>
              <tbody>
                
                  
                      <tr>
                        <td class='line'>0</td>
                        <td class='hits'></td>
                        <td class='source'>defmodule Parkapp.Reservations.Guards do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>1</td>
                        <td class='hits'></td>
                        <td class='source'>  @moduledoc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>2</td>
                        <td class='hits'></td>
                        <td class='source'>    Custom guards for the reservation&#39;s context</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>3</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>4</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr class='miss'>
                        <td class='line'>5</td>
                        <td class='hits'>0</td>
                        <td class='source'>  defguard is_reservation_type(type) when type in [1]</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>6</td>
                        <td class='hits'></td>
                        <td class='source'>end</td>
                      </tr>
                  
                
              </tbody>
            </table>
          </div>
        
          <div class='file'>
            <h2 id='lib/parkapp/reservations/reservation.ex'>lib/parkapp/reservations/reservation.ex</h1>
            <div id='stats' class='high'>
              <div class='percentage'>100</div>
              <div class='sloc'>4</div>
              <div class='hits'>316</div>
              <div class='misses'>0</div>
            </div>
            <table id='source'>
              <thead>
                <tr>
                  <th>Line</th>
                  <th>Hits</th>
                  <th>Source</th>
                </tr>
              <tbody>
                
                  
                      <tr>
                        <td class='line'>0</td>
                        <td class='hits'></td>
                        <td class='source'>defmodule Parkapp.Reservations.Reservation do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>1</td>
                        <td class='hits'></td>
                        <td class='source'>  use Ecto.Schema</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>2</td>
                        <td class='hits'></td>
                        <td class='source'>  import Ecto.Changeset</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>3</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>4</td>
                        <td class='hits'></td>
                        <td class='source'>  alias Parkapp.Reservations.{ReservationType, ReservationStatus}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>5</td>
                        <td class='hits'></td>
                        <td class='source'>  alias Parkapp.Auth.Device</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>6</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>7</td>
                        <td class='hits'>193</td>
                        <td class='source'>  schema &quot;reservations&quot; do</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>8</td>
                        <td class='hits'></td>
                        <td class='source'>    field(:amount, :string)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>9</td>
                        <td class='hits'></td>
                        <td class='source'>    field(:barcode, :string)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>10</td>
                        <td class='hits'></td>
                        <td class='source'>    field(:context_token, :string)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>11</td>
                        <td class='hits'></td>
                        <td class='source'>    field(:locator, :string)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>12</td>
                        <td class='hits'></td>
                        <td class='source'>    field(:parking_start_time, :utc_datetime)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>13</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>14</td>
                        <td class='hits'></td>
                        <td class='source'>    belongs_to(:reservation_type, ReservationType)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>15</td>
                        <td class='hits'></td>
                        <td class='source'>    belongs_to(:reservation_status, ReservationStatus)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>16</td>
                        <td class='hits'></td>
                        <td class='source'>    belongs_to(:device, Device, references: :device_id, type: Ecto.UUID)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>17</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>18</td>
                        <td class='hits'></td>
                        <td class='source'>    timestamps()</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>19</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>20</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>21</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc false</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>22</td>
                        <td class='hits'></td>
                        <td class='source'>  def changeset(reservation, attrs) do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>23</td>
                        <td class='hits'></td>
                        <td class='source'>    reservation</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>24</td>
                        <td class='hits'></td>
                        <td class='source'>    |&gt; cast(attrs, [:barcode, :locator, :device_id, :reservation_type_id, :reservation_status_id])</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>25</td>
                        <td class='hits'></td>
                        <td class='source'>    |&gt; validate_required([:barcode, :locator, :device_id, :reservation_type_id, :reservation_status_id])</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>26</td>
                        <td class='hits'></td>
                        <td class='source'>    |&gt; foreign_key_constraint(:device_id)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>27</td>
                        <td class='hits'></td>
                        <td class='source'>    |&gt; foreign_key_constraint(:reservation_type_id)</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>28</td>
                        <td class='hits'>100</td>
                        <td class='source'>    |&gt; foreign_key_constraint(:reservation_status_id)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>29</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>30</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>31</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc false</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>32</td>
                        <td class='hits'></td>
                        <td class='source'>  def inpark_changeset(reservation, attrs) do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>33</td>
                        <td class='hits'></td>
                        <td class='source'>    reservation</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>34</td>
                        <td class='hits'></td>
                        <td class='source'>    |&gt; cast(attrs, [:parking_start_time])</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>35</td>
                        <td class='hits'>12</td>
                        <td class='source'>    |&gt; validate_required([:parking_start_time])</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>36</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>37</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>38</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc false</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>39</td>
                        <td class='hits'></td>
                        <td class='source'>  def payment_changeset(reservation, attrs) do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>40</td>
                        <td class='hits'></td>
                        <td class='source'>    reservation</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>41</td>
                        <td class='hits'></td>
                        <td class='source'>    |&gt; cast(attrs, [:context_token, :amount])</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>42</td>
                        <td class='hits'>11</td>
                        <td class='source'>    |&gt; validate_required([:context_token, :amount])</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>43</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>44</td>
                        <td class='hits'></td>
                        <td class='source'>end</td>
                      </tr>
                  
                
              </tbody>
            </table>
          </div>
        
          <div class='file'>
            <h2 id='lib/parkapp/reservations/reservation_status.ex'>lib/parkapp/reservations/reservation_status.ex</h1>
            <div id='stats' class='medium'>
              <div class='percentage'>50</div>
              <div class='sloc'>2</div>
              <div class='hits'>8</div>
              <div class='misses'>1</div>
            </div>
            <table id='source'>
              <thead>
                <tr>
                  <th>Line</th>
                  <th>Hits</th>
                  <th>Source</th>
                </tr>
              <tbody>
                
                  
                      <tr>
                        <td class='line'>0</td>
                        <td class='hits'></td>
                        <td class='source'>defmodule Parkapp.Reservations.ReservationStatus do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>1</td>
                        <td class='hits'></td>
                        <td class='source'>  use Ecto.Schema</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>2</td>
                        <td class='hits'></td>
                        <td class='source'>  import Ecto.Changeset</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>3</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>4</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>5</td>
                        <td class='hits'>8</td>
                        <td class='source'>  schema &quot;reservation_status&quot; do</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>6</td>
                        <td class='hits'></td>
                        <td class='source'>    field :description, :string</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>7</td>
                        <td class='hits'></td>
                        <td class='source'>    field :name, :string</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>8</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>9</td>
                        <td class='hits'></td>
                        <td class='source'>    timestamps()</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>10</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>11</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>12</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc false</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>13</td>
                        <td class='hits'></td>
                        <td class='source'>  def changeset(reservation_status, attrs) do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>14</td>
                        <td class='hits'></td>
                        <td class='source'>    reservation_status</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>15</td>
                        <td class='hits'></td>
                        <td class='source'>    |&gt; cast(attrs, [:name, :description, :id])</td>
                      </tr>
                  
                
                  
                      <tr class='miss'>
                        <td class='line'>16</td>
                        <td class='hits'>0</td>
                        <td class='source'>    |&gt; validate_required([:name, :description, :id])</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>17</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>18</td>
                        <td class='hits'></td>
                        <td class='source'>end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>19</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>20</td>
                        <td class='hits'></td>
                        <td class='source'>defmodule Parkapp.Reservations.ReservationStatus.Enum do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>21</td>
                        <td class='hits'></td>
                        <td class='source'>  @moduledoc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>22</td>
                        <td class='hits'></td>
                        <td class='source'>    Enum for reservation status</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>23</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>24</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>25</td>
                        <td class='hits'></td>
                        <td class='source'>  def open(), do: 1</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>26</td>
                        <td class='hits'></td>
                        <td class='source'>  def in_park(), do: 2</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>27</td>
                        <td class='hits'></td>
                        <td class='source'>  def payment1(), do: 3</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>28</td>
                        <td class='hits'></td>
                        <td class='source'>  def external_payment(), do: 4</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>29</td>
                        <td class='hits'></td>
                        <td class='source'>  def payment2(), do: 5</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>30</td>
                        <td class='hits'></td>
                        <td class='source'>  def closed(), do: 6</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>31</td>
                        <td class='hits'></td>
                        <td class='source'>end</td>
                      </tr>
                  
                
              </tbody>
            </table>
          </div>
        
          <div class='file'>
            <h2 id='lib/parkapp/reservations/reservation_status_history.ex'>lib/parkapp/reservations/reservation_status_history.ex</h1>
            <div id='stats' class='high'>
              <div class='percentage'>100</div>
              <div class='sloc'>2</div>
              <div class='hits'>340</div>
              <div class='misses'>0</div>
            </div>
            <table id='source'>
              <thead>
                <tr>
                  <th>Line</th>
                  <th>Hits</th>
                  <th>Source</th>
                </tr>
              <tbody>
                
                  
                      <tr>
                        <td class='line'>0</td>
                        <td class='hits'></td>
                        <td class='source'>defmodule Parkapp.Reservations.ReservationStatusHistory do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>1</td>
                        <td class='hits'></td>
                        <td class='source'>  use Ecto.Schema</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>2</td>
                        <td class='hits'></td>
                        <td class='source'>  import Ecto.Changeset</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>3</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>4</td>
                        <td class='hits'></td>
                        <td class='source'>  alias Parkapp.Reservations.{Reservation, ReservationStatus}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>5</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>6</td>
                        <td class='hits'>210</td>
                        <td class='source'>  schema &quot;reservation_status_history&quot; do</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>7</td>
                        <td class='hits'></td>
                        <td class='source'>    field(:transitioned_at, :utc_datetime)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>8</td>
                        <td class='hits'></td>
                        <td class='source'>    field(:active, :boolean)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>9</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>10</td>
                        <td class='hits'></td>
                        <td class='source'>    belongs_to(:reservation, Reservation)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>11</td>
                        <td class='hits'></td>
                        <td class='source'>    belongs_to(:previous_reservation_status, ReservationStatus)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>12</td>
                        <td class='hits'></td>
                        <td class='source'>    belongs_to(:next_reservation_status, ReservationStatus)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>13</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>14</td>
                        <td class='hits'></td>
                        <td class='source'>    timestamps()</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>15</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>16</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>17</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc false</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>18</td>
                        <td class='hits'></td>
                        <td class='source'>  def changeset(reservation_status_history, attrs) do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>19</td>
                        <td class='hits'></td>
                        <td class='source'>    reservation_status_history</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>20</td>
                        <td class='hits'></td>
                        <td class='source'>    |&gt; cast(attrs, [:transitioned_at, :reservation_id, :previous_reservation_status_id, :next_reservation_status_id, :active])</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>21</td>
                        <td class='hits'></td>
                        <td class='source'>    |&gt; validate_required([:transitioned_at, :reservation_id, :next_reservation_status_id, :active])</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>22</td>
                        <td class='hits'></td>
                        <td class='source'>    |&gt; foreign_key_constraint(:reservation_id)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>23</td>
                        <td class='hits'></td>
                        <td class='source'>    |&gt; foreign_key_constraint(:previous_reservation_status_id)</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>24</td>
                        <td class='hits'>130</td>
                        <td class='source'>    |&gt; foreign_key_constraint(:next_reservation_status_id)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>25</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>26</td>
                        <td class='hits'></td>
                        <td class='source'>end</td>
                      </tr>
                  
                
              </tbody>
            </table>
          </div>
        
          <div class='file'>
            <h2 id='lib/parkapp/reservations/reservation_type.ex'>lib/parkapp/reservations/reservation_type.ex</h1>
            <div id='stats' class='medium'>
              <div class='percentage'>50</div>
              <div class='sloc'>2</div>
              <div class='hits'>3</div>
              <div class='misses'>1</div>
            </div>
            <table id='source'>
              <thead>
                <tr>
                  <th>Line</th>
                  <th>Hits</th>
                  <th>Source</th>
                </tr>
              <tbody>
                
                  
                      <tr>
                        <td class='line'>0</td>
                        <td class='hits'></td>
                        <td class='source'>defmodule Parkapp.Reservations.ReservationType do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>1</td>
                        <td class='hits'></td>
                        <td class='source'>  use Ecto.Schema</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>2</td>
                        <td class='hits'></td>
                        <td class='source'>  import Ecto.Changeset</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>3</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>4</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>5</td>
                        <td class='hits'>3</td>
                        <td class='source'>  schema &quot;reservation_types&quot; do</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>6</td>
                        <td class='hits'></td>
                        <td class='source'>    field :description, :string</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>7</td>
                        <td class='hits'></td>
                        <td class='source'>    field :name, :string</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>8</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>9</td>
                        <td class='hits'></td>
                        <td class='source'>    timestamps()</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>10</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>11</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>12</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc false</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>13</td>
                        <td class='hits'></td>
                        <td class='source'>  def changeset(reservation_type, attrs) do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>14</td>
                        <td class='hits'></td>
                        <td class='source'>    reservation_type</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>15</td>
                        <td class='hits'></td>
                        <td class='source'>    |&gt; cast(attrs, [:name, :description, :id])</td>
                      </tr>
                  
                
                  
                      <tr class='miss'>
                        <td class='line'>16</td>
                        <td class='hits'>0</td>
                        <td class='source'>    |&gt; validate_required([:name, :description, :id])</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>17</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>18</td>
                        <td class='hits'></td>
                        <td class='source'>end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>19</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>20</td>
                        <td class='hits'></td>
                        <td class='source'>defmodule Parkapp.Reservations.ReservationType.Enum do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>21</td>
                        <td class='hits'></td>
                        <td class='source'>  @moduledoc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>22</td>
                        <td class='hits'></td>
                        <td class='source'>    Enum for reservation types</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>23</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>24</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>25</td>
                        <td class='hits'></td>
                        <td class='source'>  def single_use(), do: 1</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>26</td>
                        <td class='hits'></td>
                        <td class='source'>end</td>
                      </tr>
                  
                
              </tbody>
            </table>
          </div>
        
          <div class='file'>
            <h2 id='lib/parkapp/reservations/reservations_context.ex'>lib/parkapp/reservations/reservations_context.ex</h1>
            <div id='stats' class='high'>
              <div class='percentage'>89.3</div>
              <div class='sloc'>75</div>
              <div class='hits'>1245</div>
              <div class='misses'>8</div>
            </div>
            <table id='source'>
              <thead>
                <tr>
                  <th>Line</th>
                  <th>Hits</th>
                  <th>Source</th>
                </tr>
              <tbody>
                
                  
                      <tr>
                        <td class='line'>0</td>
                        <td class='hits'></td>
                        <td class='source'>defmodule Parkapp.ReservationsContext do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>1</td>
                        <td class='hits'></td>
                        <td class='source'>  @moduledoc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>2</td>
                        <td class='hits'></td>
                        <td class='source'>  The Reservations context.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>3</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>4</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>5</td>
                        <td class='hits'></td>
                        <td class='source'>  import Ecto.Query, warn: false</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>6</td>
                        <td class='hits'></td>
                        <td class='source'>  alias Parkapp.Repo</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>7</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>8</td>
                        <td class='hits'></td>
                        <td class='source'>  alias Parkapp.Reservations.ReservationType</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>9</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>10</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>11</td>
                        <td class='hits'></td>
                        <td class='source'>  Returns the list of reservation_types.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>12</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>13</td>
                        <td class='hits'></td>
                        <td class='source'>  ## Examples</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>14</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>15</td>
                        <td class='hits'></td>
                        <td class='source'>      iex&gt; list_reservation_types()</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>16</td>
                        <td class='hits'></td>
                        <td class='source'>      [%ReservationType{}, ...]</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>17</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>18</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>19</td>
                        <td class='hits'></td>
                        <td class='source'>  def list_reservation_types do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>20</td>
                        <td class='hits'>1</td>
                        <td class='source'>    Repo.all(ReservationType)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>21</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>22</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>23</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>24</td>
                        <td class='hits'></td>
                        <td class='source'>  Gets a single reservation_type.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>25</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>26</td>
                        <td class='hits'></td>
                        <td class='source'>  Raises `Ecto.NoResultsError` if the Reservation type does not exist.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>27</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>28</td>
                        <td class='hits'></td>
                        <td class='source'>  ## Examples</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>29</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>30</td>
                        <td class='hits'></td>
                        <td class='source'>      iex&gt; get_reservation_type!(123)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>31</td>
                        <td class='hits'></td>
                        <td class='source'>      %ReservationType{}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>32</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>33</td>
                        <td class='hits'></td>
                        <td class='source'>      iex&gt; get_reservation_type!(456)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>34</td>
                        <td class='hits'></td>
                        <td class='source'>      ** (Ecto.NoResultsError)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>35</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>36</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>37</td>
                        <td class='hits'>1</td>
                        <td class='source'>  def get_reservation_type!(id), do: Repo.get!(ReservationType, id)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>38</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>39</td>
                        <td class='hits'></td>
                        <td class='source'>  alias Parkapp.Reservations.ReservationStatus</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>40</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>41</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>42</td>
                        <td class='hits'></td>
                        <td class='source'>  Returns the list of reservation_status.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>43</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>44</td>
                        <td class='hits'></td>
                        <td class='source'>  ## Examples</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>45</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>46</td>
                        <td class='hits'></td>
                        <td class='source'>      iex&gt; list_reservation_status()</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>47</td>
                        <td class='hits'></td>
                        <td class='source'>      [%ReservationStatus{}, ...]</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>48</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>49</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>50</td>
                        <td class='hits'></td>
                        <td class='source'>  def list_reservation_status do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>51</td>
                        <td class='hits'>1</td>
                        <td class='source'>    Repo.all(ReservationStatus)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>52</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>53</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>54</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>55</td>
                        <td class='hits'></td>
                        <td class='source'>  Gets a single reservation_status.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>56</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>57</td>
                        <td class='hits'></td>
                        <td class='source'>  Raises `Ecto.NoResultsError` if the Reservation status does not exist.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>58</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>59</td>
                        <td class='hits'></td>
                        <td class='source'>  ## Examples</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>60</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>61</td>
                        <td class='hits'></td>
                        <td class='source'>      iex&gt; get_reservation_status!(123)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>62</td>
                        <td class='hits'></td>
                        <td class='source'>      %ReservationStatus{}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>63</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>64</td>
                        <td class='hits'></td>
                        <td class='source'>      iex&gt; get_reservation_status!(456)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>65</td>
                        <td class='hits'></td>
                        <td class='source'>      ** (Ecto.NoResultsError)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>66</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>67</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>68</td>
                        <td class='hits'>1</td>
                        <td class='source'>  def get_reservation_status!(id), do: Repo.get!(ReservationStatus, id)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>69</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>70</td>
                        <td class='hits'></td>
                        <td class='source'>  alias Parkapp.Reservations.Reservation</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>71</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>72</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>73</td>
                        <td class='hits'></td>
                        <td class='source'>  Returns the list of reservations.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>74</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>75</td>
                        <td class='hits'></td>
                        <td class='source'>  ## Examples</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>76</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>77</td>
                        <td class='hits'></td>
                        <td class='source'>      iex&gt; list_reservations()</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>78</td>
                        <td class='hits'></td>
                        <td class='source'>      [%Reservation{}, ...]</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>79</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>80</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>81</td>
                        <td class='hits'></td>
                        <td class='source'>  def list_reservations do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>82</td>
                        <td class='hits'>1</td>
                        <td class='source'>    Repo.all(Reservation)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>83</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>84</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>85</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>86</td>
                        <td class='hits'></td>
                        <td class='source'>  Gets a single reservation.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>87</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>88</td>
                        <td class='hits'></td>
                        <td class='source'>  Raises `Ecto.NoResultsError` if the Reservation does not exist.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>89</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>90</td>
                        <td class='hits'></td>
                        <td class='source'>  ## Examples</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>91</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>92</td>
                        <td class='hits'></td>
                        <td class='source'>      iex&gt; get_reservation!(123)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>93</td>
                        <td class='hits'></td>
                        <td class='source'>      %Reservation{}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>94</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>95</td>
                        <td class='hits'></td>
                        <td class='source'>      iex&gt; get_reservation!(456)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>96</td>
                        <td class='hits'></td>
                        <td class='source'>      ** (Ecto.NoResultsError)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>97</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>98</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>99</td>
                        <td class='hits'>7</td>
                        <td class='source'>  def get_reservation!(id), do: Repo.get!(Reservation, id)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>100</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>101</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>102</td>
                        <td class='hits'></td>
                        <td class='source'>  Creates a reservation.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>103</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>104</td>
                        <td class='hits'></td>
                        <td class='source'>  ## Examples</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>105</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>106</td>
                        <td class='hits'></td>
                        <td class='source'>      iex&gt; create_reservation(%{field: value})</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>107</td>
                        <td class='hits'></td>
                        <td class='source'>      {:ok, %Reservation{}}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>108</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>109</td>
                        <td class='hits'></td>
                        <td class='source'>      iex&gt; create_reservation(%{field: bad_value})</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>110</td>
                        <td class='hits'></td>
                        <td class='source'>      {:error, %Ecto.Changeset{}}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>111</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>112</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>113</td>
                        <td class='hits'></td>
                        <td class='source'>  def create_reservation(attrs \\ %{}) do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>114</td>
                        <td class='hits'></td>
                        <td class='source'>    %Reservation{}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>115</td>
                        <td class='hits'></td>
                        <td class='source'>    |&gt; Reservation.changeset(attrs)</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>116</td>
                        <td class='hits'>55</td>
                        <td class='source'>    |&gt; Repo.insert()</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>117</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>118</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>119</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>120</td>
                        <td class='hits'></td>
                        <td class='source'>  Updates a reservation.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>121</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>122</td>
                        <td class='hits'></td>
                        <td class='source'>  ## Examples</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>123</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>124</td>
                        <td class='hits'></td>
                        <td class='source'>      iex&gt; update_reservation(reservation, %{field: new_value})</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>125</td>
                        <td class='hits'></td>
                        <td class='source'>      {:ok, %Reservation{}}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>126</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>127</td>
                        <td class='hits'></td>
                        <td class='source'>      iex&gt; update_reservation(reservation, %{field: bad_value})</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>128</td>
                        <td class='hits'></td>
                        <td class='source'>      {:error, %Ecto.Changeset{}}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>129</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>130</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>131</td>
                        <td class='hits'></td>
                        <td class='source'>  def update_reservation(%Reservation{} = reservation, attrs) do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>132</td>
                        <td class='hits'></td>
                        <td class='source'>    reservation</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>133</td>
                        <td class='hits'></td>
                        <td class='source'>    |&gt; Reservation.changeset(attrs)</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>134</td>
                        <td class='hits'>44</td>
                        <td class='source'>    |&gt; Repo.update()</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>135</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>136</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>137</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>138</td>
                        <td class='hits'></td>
                        <td class='source'>  Updates a reservation using the in park changeset.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>139</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>140</td>
                        <td class='hits'></td>
                        <td class='source'>  ## Examples</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>141</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>142</td>
                        <td class='hits'></td>
                        <td class='source'>      iex&gt; update_reservation_inpark(reservation, %{field: new_value})</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>143</td>
                        <td class='hits'></td>
                        <td class='source'>      {:ok, %Reservation{}}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>144</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>145</td>
                        <td class='hits'></td>
                        <td class='source'>      iex&gt; update_reservation_inpark(reservation, %{field: bad_value})</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>146</td>
                        <td class='hits'></td>
                        <td class='source'>      {:error, %Ecto.Changeset{}}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>147</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>148</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>149</td>
                        <td class='hits'></td>
                        <td class='source'>  def update_reservation_inpark(%Reservation{} = reservation, attrs) do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>150</td>
                        <td class='hits'></td>
                        <td class='source'>    reservation</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>151</td>
                        <td class='hits'></td>
                        <td class='source'>    |&gt; Reservation.inpark_changeset(attrs)</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>152</td>
                        <td class='hits'>12</td>
                        <td class='source'>    |&gt; Repo.update()</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>153</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>154</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>155</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>156</td>
                        <td class='hits'></td>
                        <td class='source'>  Updates a reservation using the payment changeset.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>157</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>158</td>
                        <td class='hits'></td>
                        <td class='source'>  ## Examples</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>159</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>160</td>
                        <td class='hits'></td>
                        <td class='source'>      iex&gt; update_reservation_after_payment(reservation, %{field: new_value})</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>161</td>
                        <td class='hits'></td>
                        <td class='source'>      {:ok, %Reservation{}}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>162</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>163</td>
                        <td class='hits'></td>
                        <td class='source'>      iex&gt; update_reservation_after_payment(reservation, %{field: bad_value})</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>164</td>
                        <td class='hits'></td>
                        <td class='source'>      {:error, %Ecto.Changeset{}}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>165</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>166</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>167</td>
                        <td class='hits'></td>
                        <td class='source'>  def update_reservation_after_payment(%Reservation{} = reservation, attrs) do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>168</td>
                        <td class='hits'></td>
                        <td class='source'>    reservation</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>169</td>
                        <td class='hits'></td>
                        <td class='source'>    |&gt; Reservation.payment_changeset(attrs)</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>170</td>
                        <td class='hits'>11</td>
                        <td class='source'>    |&gt; Repo.update()</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>171</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>172</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>173</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>174</td>
                        <td class='hits'></td>
                        <td class='source'>  Deletes a Reservation.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>175</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>176</td>
                        <td class='hits'></td>
                        <td class='source'>  ## Examples</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>177</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>178</td>
                        <td class='hits'></td>
                        <td class='source'>      iex&gt; delete_reservation(reservation)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>179</td>
                        <td class='hits'></td>
                        <td class='source'>      {:ok, %Reservation{}}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>180</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>181</td>
                        <td class='hits'></td>
                        <td class='source'>      iex&gt; delete_reservation(reservation)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>182</td>
                        <td class='hits'></td>
                        <td class='source'>      {:error, %Ecto.Changeset{}}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>183</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>184</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>185</td>
                        <td class='hits'></td>
                        <td class='source'>  def delete_reservation(%Reservation{} = reservation) do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>186</td>
                        <td class='hits'>1</td>
                        <td class='source'>    Repo.delete(reservation)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>187</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>188</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>189</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>190</td>
                        <td class='hits'></td>
                        <td class='source'>  Returns an `%Ecto.Changeset{}` for tracking reservation changes.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>191</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>192</td>
                        <td class='hits'></td>
                        <td class='source'>  ## Examples</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>193</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>194</td>
                        <td class='hits'></td>
                        <td class='source'>      iex&gt; change_reservation(reservation)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>195</td>
                        <td class='hits'></td>
                        <td class='source'>      %Ecto.Changeset{source: %Reservation{}}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>196</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>197</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>198</td>
                        <td class='hits'></td>
                        <td class='source'>  def change_reservation(%Reservation{} = reservation) do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>199</td>
                        <td class='hits'>1</td>
                        <td class='source'>    Reservation.changeset(reservation, %{})</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>200</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>201</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>202</td>
                        <td class='hits'></td>
                        <td class='source'>  alias Parkapp.Reservations.ReservationStatusHistory</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>203</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>204</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>205</td>
                        <td class='hits'></td>
                        <td class='source'>  Returns the list of revervation_status_history.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>206</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>207</td>
                        <td class='hits'></td>
                        <td class='source'>  ## Examples</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>208</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>209</td>
                        <td class='hits'></td>
                        <td class='source'>      iex&gt; list_revervation_status_history()</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>210</td>
                        <td class='hits'></td>
                        <td class='source'>      [%ReservationStatusHistory{}, ...]</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>211</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>212</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>213</td>
                        <td class='hits'></td>
                        <td class='source'>  def list_revervation_status_history do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>214</td>
                        <td class='hits'>1</td>
                        <td class='source'>    Repo.all(ReservationStatusHistory)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>215</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>216</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>217</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>218</td>
                        <td class='hits'></td>
                        <td class='source'>  Gets a single reservation_status_history.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>219</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>220</td>
                        <td class='hits'></td>
                        <td class='source'>  Raises `Ecto.NoResultsError` if the Reservation status history does not exist.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>221</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>222</td>
                        <td class='hits'></td>
                        <td class='source'>  ## Examples</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>223</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>224</td>
                        <td class='hits'></td>
                        <td class='source'>      iex&gt; get_reservation_status_history!(123)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>225</td>
                        <td class='hits'></td>
                        <td class='source'>      %ReservationStatusHistory{}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>226</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>227</td>
                        <td class='hits'></td>
                        <td class='source'>      iex&gt; get_reservation_status_history!(456)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>228</td>
                        <td class='hits'></td>
                        <td class='source'>      ** (Ecto.NoResultsError)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>229</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>230</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>231</td>
                        <td class='hits'>8</td>
                        <td class='source'>  def get_reservation_status_history!(id), do: Repo.get!(ReservationStatusHistory, id)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>232</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>233</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>234</td>
                        <td class='hits'></td>
                        <td class='source'>  Creates a reservation_status_history.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>235</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>236</td>
                        <td class='hits'></td>
                        <td class='source'>  ## Examples</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>237</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>238</td>
                        <td class='hits'></td>
                        <td class='source'>      iex&gt; create_reservation_status_history(%{field: value})</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>239</td>
                        <td class='hits'></td>
                        <td class='source'>      {:ok, %ReservationStatusHistory{}}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>240</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>241</td>
                        <td class='hits'></td>
                        <td class='source'>      iex&gt; create_reservation_status_history(%{field: bad_value})</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>242</td>
                        <td class='hits'></td>
                        <td class='source'>      {:error, %Ecto.Changeset{}}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>243</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>244</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>245</td>
                        <td class='hits'></td>
                        <td class='source'>  def create_reservation_status_history(attrs \\ %{}) do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>246</td>
                        <td class='hits'></td>
                        <td class='source'>    %ReservationStatusHistory{}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>247</td>
                        <td class='hits'></td>
                        <td class='source'>    |&gt; ReservationStatusHistory.changeset(attrs)</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>248</td>
                        <td class='hits'>85</td>
                        <td class='source'>    |&gt; Repo.insert()</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>249</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>250</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>251</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>252</td>
                        <td class='hits'></td>
                        <td class='source'>  Creates a reservation_status_history.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>253</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>254</td>
                        <td class='hits'></td>
                        <td class='source'>  def create_reservation_status_history(reservation_id, previous_status, next_status) do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>255</td>
                        <td class='hits'>70</td>
                        <td class='source'>    create_reservation_status_history(%{</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>256</td>
                        <td class='hits'></td>
                        <td class='source'>      transitioned_at: DateTime.utc_now(),</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>257</td>
                        <td class='hits'></td>
                        <td class='source'>      reservation_id: reservation_id,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>258</td>
                        <td class='hits'></td>
                        <td class='source'>      previous_reservation_status_id: previous_status,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>259</td>
                        <td class='hits'></td>
                        <td class='source'>      next_reservation_status_id: next_status,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>260</td>
                        <td class='hits'></td>
                        <td class='source'>      active: true</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>261</td>
                        <td class='hits'></td>
                        <td class='source'>    })</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>262</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>263</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>264</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>265</td>
                        <td class='hits'></td>
                        <td class='source'>  Updates a reservation_status_history.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>266</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>267</td>
                        <td class='hits'></td>
                        <td class='source'>  ## Examples</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>268</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>269</td>
                        <td class='hits'></td>
                        <td class='source'>      iex&gt; update_reservation_status_history(reservation_status_history, %{field: new_value})</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>270</td>
                        <td class='hits'></td>
                        <td class='source'>      {:ok, %ReservationStatusHistory{}}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>271</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>272</td>
                        <td class='hits'></td>
                        <td class='source'>      iex&gt; update_reservation_status_history(reservation_status_history, %{field: bad_value})</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>273</td>
                        <td class='hits'></td>
                        <td class='source'>      {:error, %Ecto.Changeset{}}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>274</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>275</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>276</td>
                        <td class='hits'></td>
                        <td class='source'>  def update_reservation_status_history(</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>277</td>
                        <td class='hits'></td>
                        <td class='source'>        %ReservationStatusHistory{} = reservation_status_history,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>278</td>
                        <td class='hits'></td>
                        <td class='source'>        attrs</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>279</td>
                        <td class='hits'></td>
                        <td class='source'>      ) do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>280</td>
                        <td class='hits'></td>
                        <td class='source'>    reservation_status_history</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>281</td>
                        <td class='hits'></td>
                        <td class='source'>    |&gt; ReservationStatusHistory.changeset(attrs)</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>282</td>
                        <td class='hits'>44</td>
                        <td class='source'>    |&gt; Repo.update()</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>283</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>284</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>285</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>286</td>
                        <td class='hits'></td>
                        <td class='source'>  Deletes a ReservationStatusHistory.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>287</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>288</td>
                        <td class='hits'></td>
                        <td class='source'>  ## Examples</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>289</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>290</td>
                        <td class='hits'></td>
                        <td class='source'>      iex&gt; delete_reservation_status_history(reservation_status_history)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>291</td>
                        <td class='hits'></td>
                        <td class='source'>      {:ok, %ReservationStatusHistory{}}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>292</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>293</td>
                        <td class='hits'></td>
                        <td class='source'>      iex&gt; delete_reservation_status_history(reservation_status_history)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>294</td>
                        <td class='hits'></td>
                        <td class='source'>      {:error, %Ecto.Changeset{}}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>295</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>296</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>297</td>
                        <td class='hits'></td>
                        <td class='source'>  def delete_reservation_status_history(%ReservationStatusHistory{} = reservation_status_history) do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>298</td>
                        <td class='hits'>1</td>
                        <td class='source'>    Repo.delete(reservation_status_history)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>299</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>300</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>301</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>302</td>
                        <td class='hits'></td>
                        <td class='source'>  Returns an `%Ecto.Changeset{}` for tracking reservation_status_history changes.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>303</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>304</td>
                        <td class='hits'></td>
                        <td class='source'>  ## Examples</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>305</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>306</td>
                        <td class='hits'></td>
                        <td class='source'>      iex&gt; change_reservation_status_history(reservation_status_history)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>307</td>
                        <td class='hits'></td>
                        <td class='source'>      %Ecto.Changeset{source: %ReservationStatusHistory{}}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>308</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>309</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>310</td>
                        <td class='hits'></td>
                        <td class='source'>  def change_reservation_status_history(%ReservationStatusHistory{} = reservation_status_history) do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>311</td>
                        <td class='hits'>1</td>
                        <td class='source'>    ReservationStatusHistory.changeset(reservation_status_history, %{})</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>312</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>313</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>314</td>
                        <td class='hits'></td>
                        <td class='source'>  # API</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>315</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>316</td>
                        <td class='hits'></td>
                        <td class='source'>  alias Parkapp.Logging</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>317</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>318</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>319</td>
                        <td class='hits'></td>
                        <td class='source'>    Retrieves from the database the active history for the given reservation</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>320</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>321</td>
                        <td class='hits'></td>
                        <td class='source'>  @spec get_active_reservation_history(Integer) :: ReservationStatusHistory | nil</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>322</td>
                        <td class='hits'></td>
                        <td class='source'>  def get_active_reservation_history(reservation_id) do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>323</td>
                        <td class='hits'>58</td>
                        <td class='source'>    Repo.get_by(ReservationStatusHistory, active: true, reservation_id: reservation_id)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>324</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>325</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>326</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>327</td>
                        <td class='hits'></td>
                        <td class='source'>    Retrives the current reservation for the given device.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>328</td>
                        <td class='hits'></td>
                        <td class='source'>    It makes sure the status history is correct and ignores the closed reservations</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>329</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>330</td>
                        <td class='hits'></td>
                        <td class='source'>  @spec get_current_reservation(Integer) :: Reservation | nil</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>331</td>
                        <td class='hits'></td>
                        <td class='source'>  def get_current_reservation(device_id) do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>332</td>
                        <td class='hits'></td>
                        <td class='source'>    from(r in Reservation)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>333</td>
                        <td class='hits'></td>
                        <td class='source'>    |&gt; join(</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>334</td>
                        <td class='hits'></td>
                        <td class='source'>      :inner,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>335</td>
                        <td class='hits'></td>
                        <td class='source'>      [r],</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>336</td>
                        <td class='hits'></td>
                        <td class='source'>      history in ReservationStatusHistory,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>337</td>
                        <td class='hits'></td>
                        <td class='source'>      r.id == history.reservation_id and history.active == true</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>338</td>
                        <td class='hits'></td>
                        <td class='source'>    )</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>339</td>
                        <td class='hits'>39</td>
                        <td class='source'>    |&gt; where(</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>340</td>
                        <td class='hits'></td>
                        <td class='source'>      [r, history],</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>341</td>
                        <td class='hits'></td>
                        <td class='source'>      r.device_id == ^device_id and r.reservation_status_id != ^ReservationStatus.Enum.closed()</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>342</td>
                        <td class='hits'></td>
                        <td class='source'>    )</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>343</td>
                        <td class='hits'>39</td>
                        <td class='source'>    |&gt; Repo.one()</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>344</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>345</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>346</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>347</td>
                        <td class='hits'></td>
                        <td class='source'>  Gets the active history for the given reservation and deactivates it.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>348</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>349</td>
                        <td class='hits'></td>
                        <td class='source'>  @spec deactivate_reservation_status_history(Integer) ::</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>350</td>
                        <td class='hits'></td>
                        <td class='source'>          {:ok, ReservationStatusHistory} | {:error, Changeset} | nil</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>351</td>
                        <td class='hits'></td>
                        <td class='source'>  def deactivate_reservation_status_history(reservation_id) do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>352</td>
                        <td class='hits'>1</td>
                        <td class='source'>    with(</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>353</td>
                        <td class='hits'>43</td>
                        <td class='source'>      last_history &lt;- get_active_reservation_history(reservation_id),</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>354</td>
                        <td class='hits'>43</td>
                        <td class='source'>      false &lt;- is_nil(last_history),</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>355</td>
                        <td class='hits'>42</td>
                        <td class='source'>      {:ok, inactive_history} &lt;-</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>356</td>
                        <td class='hits'></td>
                        <td class='source'>        update_reservation_status_history(last_history, %{</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>357</td>
                        <td class='hits'></td>
                        <td class='source'>          active: false</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>358</td>
                        <td class='hits'></td>
                        <td class='source'>        })</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>359</td>
                        <td class='hits'></td>
                        <td class='source'>    ) do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>360</td>
                        <td class='hits'></td>
                        <td class='source'>      {:ok, inactive_history}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>361</td>
                        <td class='hits'></td>
                        <td class='source'>    else</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>362</td>
                        <td class='hits'></td>
                        <td class='source'>      {:error, changeset} -&gt;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>363</td>
                        <td class='hits'></td>
                        <td class='source'>        {:error, changeset}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>364</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>365</td>
                        <td class='hits'></td>
                        <td class='source'>      _error -&gt;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>366</td>
                        <td class='hits'></td>
                        <td class='source'>        nil</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>367</td>
                        <td class='hits'></td>
                        <td class='source'>    end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>368</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>369</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>370</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>371</td>
                        <td class='hits'></td>
                        <td class='source'>    Creates a reservation with the given attributes in the open state.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>372</td>
                        <td class='hits'></td>
                        <td class='source'>    Creates the first entry in the status history.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>373</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>374</td>
                        <td class='hits'></td>
                        <td class='source'>  @spec create_reservation_initial_state(Map) :: {:ok, Reservation} | {:error, Changeset} | nil</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>375</td>
                        <td class='hits'></td>
                        <td class='source'>  def create_reservation_initial_state(attrs) when is_map(attrs) do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>376</td>
                        <td class='hits'></td>
                        <td class='source'>    Repo.transaction(fn -&gt;</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>377</td>
                        <td class='hits'>2</td>
                        <td class='source'>      with(</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>378</td>
                        <td class='hits'>31</td>
                        <td class='source'>        open_status &lt;- ReservationStatus.Enum.open(),</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>379</td>
                        <td class='hits'>31</td>
                        <td class='source'>        attrs &lt;- Map.put(attrs, :reservation_status_id, open_status),</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>380</td>
                        <td class='hits'>31</td>
                        <td class='source'>        {:ok, reservation} &lt;- create_reservation(attrs),</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>381</td>
                        <td class='hits'>29</td>
                        <td class='source'>        {:ok, _reservation_status_history} &lt;-</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>382</td>
                        <td class='hits'>29</td>
                        <td class='source'>          create_reservation_status_history(reservation.id, nil, open_status)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>383</td>
                        <td class='hits'></td>
                        <td class='source'>      ) do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>384</td>
                        <td class='hits'></td>
                        <td class='source'>        {:ok, reservation}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>385</td>
                        <td class='hits'></td>
                        <td class='source'>      else</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>386</td>
                        <td class='hits'></td>
                        <td class='source'>        {:error, changeset} -&gt;</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>387</td>
                        <td class='hits'>2</td>
                        <td class='source'>          Repo.rollback({:error, changeset})</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>388</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>389</td>
                        <td class='hits'></td>
                        <td class='source'>        _error -&gt;</td>
                      </tr>
                  
                
                  
                      <tr class='miss'>
                        <td class='line'>390</td>
                        <td class='hits'>0</td>
                        <td class='source'>          Repo.rollback(nil)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>391</td>
                        <td class='hits'></td>
                        <td class='source'>      end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>392</td>
                        <td class='hits'></td>
                        <td class='source'>    end)</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>393</td>
                        <td class='hits'>31</td>
                        <td class='source'>    |&gt; elem(1)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>394</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>395</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>396</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>397</td>
                        <td class='hits'></td>
                        <td class='source'>    Updates the reservation to the in park state.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>398</td>
                        <td class='hits'></td>
                        <td class='source'>    Creates the second entry in the status history. Deactivates the previous one.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>399</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>400</td>
                        <td class='hits'></td>
                        <td class='source'>  @spec move_to_in_park_state(Reservation, DateTime) :: {:ok, Reservation} | {:error, Changeset} | nil</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>401</td>
                        <td class='hits'></td>
                        <td class='source'>  def move_to_in_park_state(%Reservation{} = reservation, parking_start_time) do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>402</td>
                        <td class='hits'>11</td>
                        <td class='source'>    open_status = ReservationStatus.Enum.open()</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>403</td>
                        <td class='hits'>11</td>
                        <td class='source'>    in_park_status = ReservationStatus.Enum.in_park()</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>404</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>405</td>
                        <td class='hits'></td>
                        <td class='source'>    Repo.transaction(fn -&gt;</td>
                      </tr>
                  
                
                  
                      <tr class='miss'>
                        <td class='line'>406</td>
                        <td class='hits'>0</td>
                        <td class='source'>      with(</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>407</td>
                        <td class='hits'>11</td>
                        <td class='source'>        {:ok, reservation} &lt;-</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>408</td>
                        <td class='hits'></td>
                        <td class='source'>          update_reservation_inpark(reservation, %{</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>409</td>
                        <td class='hits'></td>
                        <td class='source'>            parking_start_time: parking_start_time</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>410</td>
                        <td class='hits'></td>
                        <td class='source'>          }),</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>411</td>
                        <td class='hits'>11</td>
                        <td class='source'>        {:ok, reservation} &lt;- move_reservation_from_to(reservation, open_status, in_park_status)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>412</td>
                        <td class='hits'></td>
                        <td class='source'>      ) do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>413</td>
                        <td class='hits'></td>
                        <td class='source'>        {:ok, reservation}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>414</td>
                        <td class='hits'></td>
                        <td class='source'>      else</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>415</td>
                        <td class='hits'></td>
                        <td class='source'>        {:error, changeset} -&gt;</td>
                      </tr>
                  
                
                  
                      <tr class='miss'>
                        <td class='line'>416</td>
                        <td class='hits'>0</td>
                        <td class='source'>          Repo.rollback({:error, changeset})</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>417</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>418</td>
                        <td class='hits'></td>
                        <td class='source'>        _error -&gt;</td>
                      </tr>
                  
                
                  
                      <tr class='miss'>
                        <td class='line'>419</td>
                        <td class='hits'>0</td>
                        <td class='source'>          Repo.rollback(nil)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>420</td>
                        <td class='hits'></td>
                        <td class='source'>      end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>421</td>
                        <td class='hits'></td>
                        <td class='source'>    end)</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>422</td>
                        <td class='hits'>11</td>
                        <td class='source'>    |&gt; elem(1)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>423</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>424</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>425</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>426</td>
                        <td class='hits'></td>
                        <td class='source'>    Updates the reservation to the payment1 state. Sets the context_token and amount.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>427</td>
                        <td class='hits'></td>
                        <td class='source'>    Creates the third entry in the status history. Deactivates the previous one.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>428</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>429</td>
                        <td class='hits'></td>
                        <td class='source'>  @spec move_to_payment1_state(Reservation, String, String) ::</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>430</td>
                        <td class='hits'></td>
                        <td class='source'>          {:ok, Reservation} | {:error, Changeset} | nil</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>431</td>
                        <td class='hits'></td>
                        <td class='source'>  def move_to_payment1_state(%Reservation{} = reservation, context_token, amount)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>432</td>
                        <td class='hits'></td>
                        <td class='source'>      when is_bitstring(context_token) and is_bitstring(amount) do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>433</td>
                        <td class='hits'>10</td>
                        <td class='source'>    in_park_status = ReservationStatus.Enum.in_park()</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>434</td>
                        <td class='hits'>10</td>
                        <td class='source'>    payment1_status = ReservationStatus.Enum.payment1()</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>435</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>436</td>
                        <td class='hits'></td>
                        <td class='source'>    Repo.transaction(fn -&gt;</td>
                      </tr>
                  
                
                  
                      <tr class='miss'>
                        <td class='line'>437</td>
                        <td class='hits'>0</td>
                        <td class='source'>      with(</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>438</td>
                        <td class='hits'>10</td>
                        <td class='source'>        {:ok, reservation} &lt;-</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>439</td>
                        <td class='hits'></td>
                        <td class='source'>          update_reservation_after_payment(reservation, %{</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>440</td>
                        <td class='hits'></td>
                        <td class='source'>            context_token: context_token,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>441</td>
                        <td class='hits'></td>
                        <td class='source'>            amount: amount</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>442</td>
                        <td class='hits'></td>
                        <td class='source'>          }),</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>443</td>
                        <td class='hits'>10</td>
                        <td class='source'>        {:ok, reservation} &lt;-</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>444</td>
                        <td class='hits'></td>
                        <td class='source'>          move_reservation_from_to(reservation, in_park_status, payment1_status)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>445</td>
                        <td class='hits'></td>
                        <td class='source'>      ) do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>446</td>
                        <td class='hits'></td>
                        <td class='source'>        {:ok, reservation}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>447</td>
                        <td class='hits'></td>
                        <td class='source'>      else</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>448</td>
                        <td class='hits'></td>
                        <td class='source'>        {:error, changeset} -&gt;</td>
                      </tr>
                  
                
                  
                      <tr class='miss'>
                        <td class='line'>449</td>
                        <td class='hits'>0</td>
                        <td class='source'>          Repo.rollback({:error, changeset})</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>450</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>451</td>
                        <td class='hits'></td>
                        <td class='source'>        _error -&gt;</td>
                      </tr>
                  
                
                  
                      <tr class='miss'>
                        <td class='line'>452</td>
                        <td class='hits'>0</td>
                        <td class='source'>          Repo.rollback(nil)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>453</td>
                        <td class='hits'></td>
                        <td class='source'>      end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>454</td>
                        <td class='hits'></td>
                        <td class='source'>    end)</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>455</td>
                        <td class='hits'>10</td>
                        <td class='source'>    |&gt; elem(1)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>456</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>457</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>458</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>459</td>
                        <td class='hits'></td>
                        <td class='source'>    Updates the reservation to the external payment state.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>460</td>
                        <td class='hits'></td>
                        <td class='source'>    Creates the forth entry in the status history. Deactivates the previous one.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>461</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>462</td>
                        <td class='hits'></td>
                        <td class='source'>  @spec move_to_external_payment_state(Reservation) ::</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>463</td>
                        <td class='hits'></td>
                        <td class='source'>          {:ok, Reservation} | {:error, Changeset} | nil</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>464</td>
                        <td class='hits'></td>
                        <td class='source'>  def move_to_external_payment_state(%Reservation{} = reservation) do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>465</td>
                        <td class='hits'>10</td>
                        <td class='source'>    payment1_status = ReservationStatus.Enum.payment1()</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>466</td>
                        <td class='hits'>10</td>
                        <td class='source'>    external_payment_status = ReservationStatus.Enum.external_payment()</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>467</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>468</td>
                        <td class='hits'>10</td>
                        <td class='source'>    move_reservation_from_to(reservation, payment1_status, external_payment_status)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>469</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>470</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>471</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>472</td>
                        <td class='hits'></td>
                        <td class='source'>    Updates the reservation to the payment2 state.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>473</td>
                        <td class='hits'></td>
                        <td class='source'>    Creates the fifth entry in the status history. Deactivates the previous one.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>474</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>475</td>
                        <td class='hits'></td>
                        <td class='source'>  @spec move_to_payment2_state(Reservation, String) ::</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>476</td>
                        <td class='hits'></td>
                        <td class='source'>          {:ok, Reservation} | {:error, Changeset} | nil</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>477</td>
                        <td class='hits'></td>
                        <td class='source'>  def move_to_payment2_state(%Reservation{} = reservation, webhook_params) do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>478</td>
                        <td class='hits'>8</td>
                        <td class='source'>    external_payment_status = ReservationStatus.Enum.external_payment()</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>479</td>
                        <td class='hits'>8</td>
                        <td class='source'>    payment2_status = ReservationStatus.Enum.payment2()</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>480</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>481</td>
                        <td class='hits'></td>
                        <td class='source'>    Repo.transaction(fn -&gt;</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>482</td>
                        <td class='hits'>2</td>
                        <td class='source'>      with(</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>483</td>
                        <td class='hits'>8</td>
                        <td class='source'>        {:ok, _log} &lt;-</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>484</td>
                        <td class='hits'></td>
                        <td class='source'>          Logging.create_external_payment_log(%{</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>485</td>
                        <td class='hits'>8</td>
                        <td class='source'>            reservation_id: reservation.id,</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>486</td>
                        <td class='hits'></td>
                        <td class='source'>            received_at: DateTime.utc_now(),</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>487</td>
                        <td class='hits'></td>
                        <td class='source'>            params: webhook_params</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>488</td>
                        <td class='hits'></td>
                        <td class='source'>          }),</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>489</td>
                        <td class='hits'>7</td>
                        <td class='source'>        {:ok, reservation} &lt;-</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>490</td>
                        <td class='hits'></td>
                        <td class='source'>          move_reservation_from_to(reservation, external_payment_status, payment2_status)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>491</td>
                        <td class='hits'></td>
                        <td class='source'>      ) do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>492</td>
                        <td class='hits'></td>
                        <td class='source'>        {:ok, reservation}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>493</td>
                        <td class='hits'></td>
                        <td class='source'>      else</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>494</td>
                        <td class='hits'></td>
                        <td class='source'>        {:error, changeset} -&gt;</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>495</td>
                        <td class='hits'>1</td>
                        <td class='source'>          Repo.rollback({:error, changeset})</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>496</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>497</td>
                        <td class='hits'></td>
                        <td class='source'>        _error -&gt;</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>498</td>
                        <td class='hits'>1</td>
                        <td class='source'>          Repo.rollback(nil)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>499</td>
                        <td class='hits'></td>
                        <td class='source'>      end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>500</td>
                        <td class='hits'></td>
                        <td class='source'>    end)</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>501</td>
                        <td class='hits'>8</td>
                        <td class='source'>    |&gt; elem(1)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>502</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>503</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>504</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>505</td>
                        <td class='hits'></td>
                        <td class='source'>    Updates the reservation to the closed state.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>506</td>
                        <td class='hits'></td>
                        <td class='source'>    Creates the sixth and final entry in the status history. Deactivates the previous one.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>507</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>508</td>
                        <td class='hits'></td>
                        <td class='source'>  @spec move_to_closed_state(Reservation) :: {:ok, Reservation} | {:error, Changeset} | nil</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>509</td>
                        <td class='hits'></td>
                        <td class='source'>  def move_to_closed_state(%Reservation{} = reservation) do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>510</td>
                        <td class='hits'>4</td>
                        <td class='source'>    payment2_status = ReservationStatus.Enum.payment2()</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>511</td>
                        <td class='hits'>4</td>
                        <td class='source'>    closed_status = ReservationStatus.Enum.closed()</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>512</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>513</td>
                        <td class='hits'>4</td>
                        <td class='source'>    move_reservation_from_to(reservation, payment2_status, closed_status)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>514</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>515</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>516</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>517</td>
                        <td class='hits'></td>
                        <td class='source'>    Abstract function that knows tghe steps involved into changing a reservation status.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>518</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>519</td>
                        <td class='hits'></td>
                        <td class='source'>  @spec move_reservation_from_to(Reservation, Integer, Integer) ::</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>520</td>
                        <td class='hits'></td>
                        <td class='source'>          {:ok, Reservation} | {:error, Changeset} | nil</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>521</td>
                        <td class='hits'></td>
                        <td class='source'>  defp move_reservation_from_to(%Reservation{} = reservation, previous_status, next_status)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>522</td>
                        <td class='hits'></td>
                        <td class='source'>       when is_integer(previous_status) and is_integer(next_status) do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>523</td>
                        <td class='hits'></td>
                        <td class='source'>    Repo.transaction(fn -&gt;</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>524</td>
                        <td class='hits'>1</td>
                        <td class='source'>      with(</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>525</td>
                        <td class='hits'>42</td>
                        <td class='source'>        true &lt;- reservation.reservation_status_id == previous_status,</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>526</td>
                        <td class='hits'>41</td>
                        <td class='source'>        {:ok, reservation} &lt;-</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>527</td>
                        <td class='hits'></td>
                        <td class='source'>          update_reservation(reservation, %{</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>528</td>
                        <td class='hits'></td>
                        <td class='source'>            reservation_status_id: next_status</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>529</td>
                        <td class='hits'></td>
                        <td class='source'>          }),</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>530</td>
                        <td class='hits'>41</td>
                        <td class='source'>        {:ok, _inactive_history} &lt;- deactivate_reservation_status_history(reservation.id),</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>531</td>
                        <td class='hits'>41</td>
                        <td class='source'>        {:ok, _reservation_status_history} &lt;-</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>532</td>
                        <td class='hits'>41</td>
                        <td class='source'>          create_reservation_status_history(reservation.id, previous_status, next_status)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>533</td>
                        <td class='hits'></td>
                        <td class='source'>      ) do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>534</td>
                        <td class='hits'></td>
                        <td class='source'>        {:ok, reservation}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>535</td>
                        <td class='hits'></td>
                        <td class='source'>      else</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>536</td>
                        <td class='hits'></td>
                        <td class='source'>        {:error, changeset} -&gt;</td>
                      </tr>
                  
                
                  
                      <tr class='miss'>
                        <td class='line'>537</td>
                        <td class='hits'>0</td>
                        <td class='source'>          Repo.rollback({:error, changeset})</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>538</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>539</td>
                        <td class='hits'></td>
                        <td class='source'>        _error -&gt;</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>540</td>
                        <td class='hits'>1</td>
                        <td class='source'>          Repo.rollback(nil)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>541</td>
                        <td class='hits'></td>
                        <td class='source'>      end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>542</td>
                        <td class='hits'></td>
                        <td class='source'>    end)</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>543</td>
                        <td class='hits'>42</td>
                        <td class='source'>    |&gt; elem(1)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>544</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>545</td>
                        <td class='hits'></td>
                        <td class='source'>end</td>
                      </tr>
                  
                
              </tbody>
            </table>
          </div>
        
          <div class='file'>
            <h2 id='lib/parkapp_web.ex'>lib/parkapp_web.ex</h1>
            <div id='stats' class='terrible'>
              <div class='percentage'>0</div>
              <div class='sloc'>1</div>
              <div class='hits'>0</div>
              <div class='misses'>1</div>
            </div>
            <table id='source'>
              <thead>
                <tr>
                  <th>Line</th>
                  <th>Hits</th>
                  <th>Source</th>
                </tr>
              <tbody>
                
                  
                      <tr>
                        <td class='line'>0</td>
                        <td class='hits'></td>
                        <td class='source'>defmodule ParkappWeb do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>1</td>
                        <td class='hits'></td>
                        <td class='source'>  @moduledoc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>2</td>
                        <td class='hits'></td>
                        <td class='source'>  The entrypoint for defining your web interface, such</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>3</td>
                        <td class='hits'></td>
                        <td class='source'>  as controllers, views, channels and so on.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>4</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>5</td>
                        <td class='hits'></td>
                        <td class='source'>  This can be used in your application as:</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>6</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>7</td>
                        <td class='hits'></td>
                        <td class='source'>      use ParkappWeb, :controller</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>8</td>
                        <td class='hits'></td>
                        <td class='source'>      use ParkappWeb, :view</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>9</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>10</td>
                        <td class='hits'></td>
                        <td class='source'>  The definitions below will be executed for every view,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>11</td>
                        <td class='hits'></td>
                        <td class='source'>  controller, etc, so keep them short and clean, focused</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>12</td>
                        <td class='hits'></td>
                        <td class='source'>  on imports, uses and aliases.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>13</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>14</td>
                        <td class='hits'></td>
                        <td class='source'>  Do NOT define functions inside the quoted expressions</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>15</td>
                        <td class='hits'></td>
                        <td class='source'>  below. Instead, define any helper function in modules</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>16</td>
                        <td class='hits'></td>
                        <td class='source'>  and import those modules here.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>17</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>18</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>19</td>
                        <td class='hits'></td>
                        <td class='source'>  def controller do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>20</td>
                        <td class='hits'></td>
                        <td class='source'>    quote do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>21</td>
                        <td class='hits'></td>
                        <td class='source'>      use Phoenix.Controller, namespace: ParkappWeb</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>22</td>
                        <td class='hits'></td>
                        <td class='source'>      import Plug.Conn</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>23</td>
                        <td class='hits'></td>
                        <td class='source'>      import ParkappWeb.Router.Helpers</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>24</td>
                        <td class='hits'></td>
                        <td class='source'>      import ParkappWeb.Gettext</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>25</td>
                        <td class='hits'></td>
                        <td class='source'>      require Logger</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>26</td>
                        <td class='hits'></td>
                        <td class='source'>    end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>27</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>28</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>29</td>
                        <td class='hits'></td>
                        <td class='source'>  def view do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>30</td>
                        <td class='hits'></td>
                        <td class='source'>    quote do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>31</td>
                        <td class='hits'></td>
                        <td class='source'>      use Phoenix.View, root: &quot;lib/parkapp_web/templates&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>32</td>
                        <td class='hits'></td>
                        <td class='source'>                        namespace: ParkappWeb</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>33</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>34</td>
                        <td class='hits'></td>
                        <td class='source'>      # Import convenience functions from controllers</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>35</td>
                        <td class='hits'></td>
                        <td class='source'>      import Phoenix.Controller, only: [get_flash: 2, view_module: 1]</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>36</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>37</td>
                        <td class='hits'></td>
                        <td class='source'>      # Use all HTML functionality (forms, tags, etc)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>38</td>
                        <td class='hits'></td>
                        <td class='source'>      use Phoenix.HTML</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>39</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>40</td>
                        <td class='hits'></td>
                        <td class='source'>      import ParkappWeb.Router.Helpers</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>41</td>
                        <td class='hits'></td>
                        <td class='source'>      import ParkappWeb.ErrorHelpers</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>42</td>
                        <td class='hits'></td>
                        <td class='source'>      import ParkappWeb.Gettext</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>43</td>
                        <td class='hits'></td>
                        <td class='source'>    end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>44</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>45</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>46</td>
                        <td class='hits'></td>
                        <td class='source'>  def router do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>47</td>
                        <td class='hits'></td>
                        <td class='source'>    quote do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>48</td>
                        <td class='hits'></td>
                        <td class='source'>      use Phoenix.Router</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>49</td>
                        <td class='hits'></td>
                        <td class='source'>      import Plug.Conn</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>50</td>
                        <td class='hits'></td>
                        <td class='source'>      import Phoenix.Controller</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>51</td>
                        <td class='hits'></td>
                        <td class='source'>    end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>52</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>53</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>54</td>
                        <td class='hits'></td>
                        <td class='source'>  def channel do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>55</td>
                        <td class='hits'></td>
                        <td class='source'>    quote do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>56</td>
                        <td class='hits'></td>
                        <td class='source'>      use Phoenix.Channel</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>57</td>
                        <td class='hits'></td>
                        <td class='source'>      import ParkappWeb.Gettext</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>58</td>
                        <td class='hits'></td>
                        <td class='source'>    end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>59</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>60</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>61</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>62</td>
                        <td class='hits'></td>
                        <td class='source'>  When used, dispatch to the appropriate controller/view/etc.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>63</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>64</td>
                        <td class='hits'></td>
                        <td class='source'>  defmacro __using__(which) when is_atom(which) do</td>
                      </tr>
                  
                
                  
                      <tr class='miss'>
                        <td class='line'>65</td>
                        <td class='hits'>0</td>
                        <td class='source'>    apply(__MODULE__, which, [])</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>66</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>67</td>
                        <td class='hits'></td>
                        <td class='source'>end</td>
                      </tr>
                  
                
              </tbody>
            </table>
          </div>
        
          <div class='file'>
            <h2 id='lib/parkapp_web/api_integration/api_integration.ex'>lib/parkapp_web/api_integration/api_integration.ex</h1>
            <div id='stats' class='high'>
              <div class='percentage'>89.7</div>
              <div class='sloc'>39</div>
              <div class='hits'>293</div>
              <div class='misses'>4</div>
            </div>
            <table id='source'>
              <thead>
                <tr>
                  <th>Line</th>
                  <th>Hits</th>
                  <th>Source</th>
                </tr>
              <tbody>
                
                  
                      <tr>
                        <td class='line'>0</td>
                        <td class='hits'></td>
                        <td class='source'>defmodule ParkappWeb.ApiIntegration do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>1</td>
                        <td class='hits'></td>
                        <td class='source'>  @moduledoc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>2</td>
                        <td class='hits'></td>
                        <td class='source'>    This module handles coordination beetween thir party APIs and the server&#39;s database</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>3</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>4</td>
                        <td class='hits'></td>
                        <td class='source'>  import Parkapp.Reservations.Guards</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>5</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>6</td>
                        <td class='hits'></td>
                        <td class='source'>  alias __MODULE__.Embers.Helpers, as: EmbersHelpers</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>7</td>
                        <td class='hits'></td>
                        <td class='source'>  alias __MODULE__.MBWay.Helpers, as: MBWayHelpers</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>8</td>
                        <td class='hits'></td>
                        <td class='source'>  alias Parkapp.Reservations.ReservationStatus.Enum, as: ReservationStatusEnum</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>9</td>
                        <td class='hits'></td>
                        <td class='source'>  alias Parkapp.Reservations.ReservationType.Enum, as: ReservationTypeEnum</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>10</td>
                        <td class='hits'></td>
                        <td class='source'>  alias Parkapp.ReservationsContext</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>11</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>12</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>13</td>
                        <td class='hits'></td>
                        <td class='source'>    Performs the reservation with the Embers API and updates the databse.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>14</td>
                        <td class='hits'></td>
                        <td class='source'>    If anythings go wrong, the reservation is cancelled.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>15</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>16</td>
                        <td class='hits'></td>
                        <td class='source'>  @spec reserve_single_use(String) :: {:ok, Map} | {:error, Changeset} | nil</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>17</td>
                        <td class='hits'></td>
                        <td class='source'>  def reserve_single_use(device_id) when is_bitstring(device_id) do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>18</td>
                        <td class='hits'>16</td>
                        <td class='source'>    reserve(device_id, ReservationTypeEnum.single_use())</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>19</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>20</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>21</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>22</td>
                        <td class='hits'></td>
                        <td class='source'>    Performs the reservation with the Embers API and updates the databse.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>23</td>
                        <td class='hits'></td>
                        <td class='source'>    If anythings go wrong, the reservation is cancelled.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>24</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>25</td>
                        <td class='hits'></td>
                        <td class='source'>  @spec reserve(String, ReservationTypeEnum) :: {:ok, Map} | {:error, Changeset} | nil</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>26</td>
                        <td class='hits'></td>
                        <td class='source'>  defp reserve(device_id, product_type)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>27</td>
                        <td class='hits'></td>
                        <td class='source'>       when is_bitstring(device_id) and is_reservation_type(product_type) do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>28</td>
                        <td class='hits'>16</td>
                        <td class='source'>    module = EmbersHelpers.get_api_module()</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>29</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>30</td>
                        <td class='hits'>16</td>
                        <td class='source'>    case module.make_reservation(product_type) do</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>31</td>
                        <td class='hits'></td>
                        <td class='source'>      {:ok, result} -&gt;</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>32</td>
                        <td class='hits'>16</td>
                        <td class='source'>        locator = Map.get(result, &quot;locator&quot;)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>33</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>34</td>
                        <td class='hits'>16</td>
                        <td class='source'>        barcode =</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>35</td>
                        <td class='hits'></td>
                        <td class='source'>          Map.get(result, &quot;product&quot;)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>36</td>
                        <td class='hits'></td>
                        <td class='source'>          |&gt; Map.get(&quot;barcode&quot;)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>37</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>38</td>
                        <td class='hits'>16</td>
                        <td class='source'>        case ReservationsContext.create_reservation_initial_state(%{</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>39</td>
                        <td class='hits'></td>
                        <td class='source'>               device_id: device_id,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>40</td>
                        <td class='hits'></td>
                        <td class='source'>               locator: locator,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>41</td>
                        <td class='hits'></td>
                        <td class='source'>               barcode: barcode,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>42</td>
                        <td class='hits'></td>
                        <td class='source'>               reservation_type_id: product_type</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>43</td>
                        <td class='hits'></td>
                        <td class='source'>             }) do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>44</td>
                        <td class='hits'></td>
                        <td class='source'>          {:ok, reservation} -&gt;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>45</td>
                        <td class='hits'></td>
                        <td class='source'>            {:ok, reservation}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>46</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>47</td>
                        <td class='hits'></td>
                        <td class='source'>          error -&gt;</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>48</td>
                        <td class='hits'>1</td>
                        <td class='source'>            module.delete_reservation(locator)</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>49</td>
                        <td class='hits'>1</td>
                        <td class='source'>            error</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>50</td>
                        <td class='hits'></td>
                        <td class='source'>        end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>51</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>52</td>
                        <td class='hits'></td>
                        <td class='source'>      _other -&gt;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>53</td>
                        <td class='hits'></td>
                        <td class='source'>        nil</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>54</td>
                        <td class='hits'></td>
                        <td class='source'>    end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>55</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>56</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>57</td>
                        <td class='hits'></td>
                        <td class='source'>  @spec pay(String, String) :: {:ok, Map} | {:error, Changeset} | nil</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>58</td>
                        <td class='hits'></td>
                        <td class='source'>  def pay(device_id, phone_number) do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>59</td>
                        <td class='hits'>12</td>
                        <td class='source'>    reservation = ReservationsContext.get_current_reservation(device_id)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>60</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>61</td>
                        <td class='hits'>12</td>
                        <td class='source'>    cond do</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>62</td>
                        <td class='hits'></td>
                        <td class='source'>      is_nil(reservation) -&gt;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>63</td>
                        <td class='hits'></td>
                        <td class='source'>        nil</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>64</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>65</td>
                        <td class='hits'>11</td>
                        <td class='source'>      reservation.reservation_status_id == ReservationStatusEnum.in_park() -&gt;</td>
                      </tr>
                    
                
                  
                      <tr class='miss'>
                        <td class='line'>66</td>
                        <td class='hits'>0</td>
                        <td class='source'>        with(</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>67</td>
                        <td class='hits'>8</td>
                        <td class='source'>          {:ok, reservation} &lt;- payment1(reservation),</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>68</td>
                        <td class='hits'>8</td>
                        <td class='source'>          {:ok, reservation} &lt;- external_payment(reservation, device_id, phone_number)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>69</td>
                        <td class='hits'></td>
                        <td class='source'>        ) do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>70</td>
                        <td class='hits'></td>
                        <td class='source'>          {:ok, reservation}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>71</td>
                        <td class='hits'></td>
                        <td class='source'>        else</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>72</td>
                        <td class='hits'></td>
                        <td class='source'>          error -&gt;</td>
                      </tr>
                  
                
                  
                      <tr class='miss'>
                        <td class='line'>73</td>
                        <td class='hits'>0</td>
                        <td class='source'>            error</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>74</td>
                        <td class='hits'></td>
                        <td class='source'>        end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>75</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>76</td>
                        <td class='hits'>3</td>
                        <td class='source'>      reservation.reservation_status_id == ReservationStatusEnum.payment1() -&gt;</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>77</td>
                        <td class='hits'>1</td>
                        <td class='source'>        external_payment(reservation, device_id, phone_number)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>78</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>79</td>
                        <td class='hits'></td>
                        <td class='source'>      true -&gt;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>80</td>
                        <td class='hits'></td>
                        <td class='source'>        nil</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>81</td>
                        <td class='hits'></td>
                        <td class='source'>    end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>82</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>83</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>84</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>85</td>
                        <td class='hits'></td>
                        <td class='source'>    Handles the payment1 api request + database state transition</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>86</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>87</td>
                        <td class='hits'></td>
                        <td class='source'>  @spec payment1(Reservation) :: {:ok, Map} | {:error, Changeset} | nil</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>88</td>
                        <td class='hits'></td>
                        <td class='source'>  defp payment1(reservation) do</td>
                      </tr>
                  
                
                  
                      <tr class='miss'>
                        <td class='line'>89</td>
                        <td class='hits'>0</td>
                        <td class='source'>    with(</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>90</td>
                        <td class='hits'>8</td>
                        <td class='source'>      module &lt;- EmbersHelpers.get_api_module(),</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>91</td>
                        <td class='hits'>8</td>
                        <td class='source'>      false &lt;- is_nil(reservation),</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>92</td>
                        <td class='hits'>8</td>
                        <td class='source'>      true &lt;- reservation.reservation_status_id == ReservationStatusEnum.in_park(),</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>93</td>
                        <td class='hits'>8</td>
                        <td class='source'>      {:ok, result} &lt;- module.payment1(reservation.barcode),</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>94</td>
                        <td class='hits'>8</td>
                        <td class='source'>      content_token &lt;- Map.get(result, &quot;context_token&quot;),</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>95</td>
                        <td class='hits'>8</td>
                        <td class='source'>      amount &lt;- Map.get(result, &quot;outstanding_amount&quot;),</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>96</td>
                        <td class='hits'>8</td>
                        <td class='source'>      {:ok, reservation} &lt;-</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>97</td>
                        <td class='hits'></td>
                        <td class='source'>        ReservationsContext.move_to_payment1_state(reservation, content_token, amount)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>98</td>
                        <td class='hits'></td>
                        <td class='source'>    ) do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>99</td>
                        <td class='hits'></td>
                        <td class='source'>      {:ok, reservation}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>100</td>
                        <td class='hits'></td>
                        <td class='source'>    else</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>101</td>
                        <td class='hits'></td>
                        <td class='source'>      {:error, changeset} -&gt;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>102</td>
                        <td class='hits'></td>
                        <td class='source'>        # What to do here?</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>103</td>
                        <td class='hits'></td>
                        <td class='source'>        {:error, changeset}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>104</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>105</td>
                        <td class='hits'></td>
                        <td class='source'>      _other -&gt;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>106</td>
                        <td class='hits'></td>
                        <td class='source'>        # What to do here?</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>107</td>
                        <td class='hits'></td>
                        <td class='source'>        nil</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>108</td>
                        <td class='hits'></td>
                        <td class='source'>    end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>109</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>110</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>111</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>112</td>
                        <td class='hits'></td>
                        <td class='source'>    Handles the external_payment api request + database state transition</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>113</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>114</td>
                        <td class='hits'></td>
                        <td class='source'>  @spec external_payment(Reservation, String, String) :: {:ok, Map} | {:error, Changeset} | nil</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>115</td>
                        <td class='hits'></td>
                        <td class='source'>  defp external_payment(reservation, device_id, phone_number) do</td>
                      </tr>
                  
                
                  
                      <tr class='miss'>
                        <td class='line'>116</td>
                        <td class='hits'>0</td>
                        <td class='source'>    with(</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>117</td>
                        <td class='hits'>9</td>
                        <td class='source'>      false &lt;- is_nil(reservation),</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>118</td>
                        <td class='hits'>9</td>
                        <td class='source'>      true &lt;- reservation.reservation_status_id == ReservationStatusEnum.payment1(),</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>119</td>
                        <td class='hits'>9</td>
                        <td class='source'>      module &lt;- MBWayHelpers.get_api_module(),</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>120</td>
                        <td class='hits'>9</td>
                        <td class='source'>      {:ok, _result} &lt;- module.request_payment(device_id, phone_number, reservation.amount),</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>121</td>
                        <td class='hits'>9</td>
                        <td class='source'>      {:ok, reservation} &lt;- ReservationsContext.move_to_external_payment_state(reservation)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>122</td>
                        <td class='hits'></td>
                        <td class='source'>    ) do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>123</td>
                        <td class='hits'></td>
                        <td class='source'>      {:ok, reservation}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>124</td>
                        <td class='hits'></td>
                        <td class='source'>    else</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>125</td>
                        <td class='hits'></td>
                        <td class='source'>      {:error, changeset} -&gt;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>126</td>
                        <td class='hits'></td>
                        <td class='source'>        # What to do here?</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>127</td>
                        <td class='hits'></td>
                        <td class='source'>        {:error, changeset}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>128</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>129</td>
                        <td class='hits'></td>
                        <td class='source'>      _other -&gt;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>130</td>
                        <td class='hits'></td>
                        <td class='source'>        # What to do here?</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>131</td>
                        <td class='hits'></td>
                        <td class='source'>        nil</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>132</td>
                        <td class='hits'></td>
                        <td class='source'>    end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>133</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>134</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>135</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>136</td>
                        <td class='hits'></td>
                        <td class='source'>    Handles the last steps of the payment workflow after the external payment is successfull</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>137</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>138</td>
                        <td class='hits'></td>
                        <td class='source'>  @spec complete_payment_procedure(String, Map) :: {:ok, Map} | {:error, Changeset} | nil</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>139</td>
                        <td class='hits'></td>
                        <td class='source'>  def complete_payment_procedure(device_id, webhook_payload) do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>140</td>
                        <td class='hits'>1</td>
                        <td class='source'>    with(</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>141</td>
                        <td class='hits'>6</td>
                        <td class='source'>      module &lt;- EmbersHelpers.get_api_module(),</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>142</td>
                        <td class='hits'>6</td>
                        <td class='source'>      reservation &lt;- ReservationsContext.get_current_reservation(device_id),</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>143</td>
                        <td class='hits'>6</td>
                        <td class='source'>      false &lt;- is_nil(reservation),</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>144</td>
                        <td class='hits'>5</td>
                        <td class='source'>      true &lt;- reservation.reservation_status_id == ReservationStatusEnum.external_payment(),</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>145</td>
                        <td class='hits'>5</td>
                        <td class='source'>      params &lt;- Map.get(webhook_payload, &quot;result&quot;, %{}) |&gt; Map.get(&quot;description&quot;),</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>146</td>
                        <td class='hits'>5</td>
                        <td class='source'>      :ok &lt;- module.payment2(reservation.context_token),</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>147</td>
                        <td class='hits'>5</td>
                        <td class='source'>      {:ok, reservation} &lt;- ReservationsContext.move_to_payment2_state(reservation, params)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>148</td>
                        <td class='hits'></td>
                        <td class='source'>    ) do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>149</td>
                        <td class='hits'></td>
                        <td class='source'>      {:ok, reservation}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>150</td>
                        <td class='hits'></td>
                        <td class='source'>    else</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>151</td>
                        <td class='hits'></td>
                        <td class='source'>      {:error, changeset} -&gt;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>152</td>
                        <td class='hits'></td>
                        <td class='source'>        # What to do here?</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>153</td>
                        <td class='hits'></td>
                        <td class='source'>        {:error, changeset}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>154</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>155</td>
                        <td class='hits'></td>
                        <td class='source'>      _error -&gt;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>156</td>
                        <td class='hits'></td>
                        <td class='source'>        nil</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>157</td>
                        <td class='hits'></td>
                        <td class='source'>    end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>158</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>159</td>
                        <td class='hits'></td>
                        <td class='source'>end</td>
                      </tr>
                  
                
              </tbody>
            </table>
          </div>
        
          <div class='file'>
            <h2 id='lib/parkapp_web/api_integration/embers/api.ex'>lib/parkapp_web/api_integration/embers/api.ex</h1>
            <div id='stats' class='high'>
              <div class='percentage'>75</div>
              <div class='sloc'>24</div>
              <div class='hits'>81</div>
              <div class='misses'>6</div>
            </div>
            <table id='source'>
              <thead>
                <tr>
                  <th>Line</th>
                  <th>Hits</th>
                  <th>Source</th>
                </tr>
              <tbody>
                
                  
                      <tr>
                        <td class='line'>0</td>
                        <td class='hits'></td>
                        <td class='source'>defmodule ParkappWeb.ApiIntegration.Embers.API do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>1</td>
                        <td class='hits'></td>
                        <td class='source'>  @moduledoc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>2</td>
                        <td class='hits'></td>
                        <td class='source'>    Main implementation of the Embers API.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>3</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>4</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>5</td>
                        <td class='hits'></td>
                        <td class='source'>  @behaviour ParkappWeb.ApiIntegration.Embers.Behaviour</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>6</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>7</td>
                        <td class='hits'></td>
                        <td class='source'>  import ParkappWeb.ApiIntegration.Embers.Helpers</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>8</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>9</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>10</td>
                        <td class='hits'></td>
                        <td class='source'>    Uses the Embers&#39;s Routing API to calculate the route between from and to geo_points</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>11</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>12</td>
                        <td class='hits'></td>
                        <td class='source'>  def get_route(from, to, mode) do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>13</td>
                        <td class='hits'>6</td>
                        <td class='source'>    {domain, api_key, max_walk_distance, timezone} = get_config(:routing)</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>14</td>
                        <td class='hits'>6</td>
                        <td class='source'>    {date, time} = now_date_time_tuple_with_format(timezone)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>15</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>16</td>
                        <td class='hits'>6</td>
                        <td class='source'>    url =</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>17</td>
                        <td class='hits'>6</td>
                        <td class='source'>      &quot;#{domain}/routing/?fromPlace=#{from}&amp;toPlace=#{to}&amp;mode=#{mode}&amp;maxWalkDistance=#{</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>18</td>
                        <td class='hits'></td>
                        <td class='source'>        max_walk_distance</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>19</td>
                        <td class='hits'>6</td>
                        <td class='source'>      }&amp;date=#{date}&amp;time=#{time}&quot;</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>20</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>21</td>
                        <td class='hits'></td>
                        <td class='source'>    get(url, api_key)</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>22</td>
                        <td class='hits'>6</td>
                        <td class='source'>    |&gt; handle_http_response()</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>23</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>24</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>25</td>
                        <td class='hits'></td>
                        <td class='source'>  #https://api.embers.city/offstreet-parking/parking-areas/85/</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>26</td>
                        <td class='hits'></td>
                        <td class='source'>  #https://api.embers.city/offstreet-parking/occupancy-reports/?ordering=timestamp&amp;parking_area=85&amp;timestamp__gte=2018-09-19T09%3A03%3A19.616240Z</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>27</td>
                        <td class='hits'></td>
                        <td class='source'>  # {</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>28</td>
                        <td class='hits'></td>
                        <td class='source'>  #   &quot;id&quot;: 85,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>29</td>
                        <td class='hits'></td>
                        <td class='source'>  #   &quot;sources&quot;: [</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>30</td>
                        <td class='hits'></td>
                        <td class='source'>  #     {</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>31</td>
                        <td class='hits'></td>
                        <td class='source'>  #       &quot;id&quot;: 2,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>32</td>
                        <td class='hits'></td>
                        <td class='source'>  #       &quot;name&quot;: &quot;Porto parking data (TEST)&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>33</td>
                        <td class='hits'></td>
                        <td class='source'>  #       &quot;location_name&quot;: &quot;Porto&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>34</td>
                        <td class='hits'></td>
                        <td class='source'>  #       &quot;type&quot;: &quot;parking&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>35</td>
                        <td class='hits'></td>
                        <td class='source'>  #       &quot;organization&quot;: 10</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>36</td>
                        <td class='hits'></td>
                        <td class='source'>  #     }</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>37</td>
                        <td class='hits'></td>
                        <td class='source'>  #   ],</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>38</td>
                        <td class='hits'></td>
                        <td class='source'>  #   &quot;occupied_spots&quot;: 51,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>39</td>
                        <td class='hits'></td>
                        <td class='source'>  #   &quot;free_spots&quot;: 449,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>40</td>
                        <td class='hits'></td>
                        <td class='source'>  #   &quot;free_spots_display&quot;: null,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>41</td>
                        <td class='hits'></td>
                        <td class='source'>  #   &quot;assets&quot;: [],</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>42</td>
                        <td class='hits'></td>
                        <td class='source'>  #   &quot;name&quot;: &quot;1&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>43</td>
                        <td class='hits'></td>
                        <td class='source'>  #   &quot;location&quot;: {</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>44</td>
                        <td class='hits'></td>
                        <td class='source'>  #     &quot;type&quot;: &quot;Point&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>45</td>
                        <td class='hits'></td>
                        <td class='source'>  #     &quot;coordinates&quot;: [</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>46</td>
                        <td class='hits'></td>
                        <td class='source'>  #       -8.609497,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>47</td>
                        <td class='hits'></td>
                        <td class='source'>  #       41.150922</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>48</td>
                        <td class='hits'></td>
                        <td class='source'>  #     ]</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>49</td>
                        <td class='hits'></td>
                        <td class='source'>  #   },</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>50</td>
                        <td class='hits'></td>
                        <td class='source'>  #   &quot;total_capacity&quot;: 500,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>51</td>
                        <td class='hits'></td>
                        <td class='source'>  #   &quot;spots_margin&quot;: 0,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>52</td>
                        <td class='hits'></td>
                        <td class='source'>  #   &quot;reserved_spots&quot;: 0,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>53</td>
                        <td class='hits'></td>
                        <td class='source'>  #   &quot;management_type&quot;: &quot;w&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>54</td>
                        <td class='hits'></td>
                        <td class='source'>  #   &quot;webservice_url&quot;: null,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>55</td>
                        <td class='hits'></td>
                        <td class='source'>  #   &quot;display_name&quot;: &quot;Rotación&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>56</td>
                        <td class='hits'></td>
                        <td class='source'>  #   &quot;external_id&quot;: &quot;1&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>57</td>
                        <td class='hits'></td>
                        <td class='source'>  #   &quot;description&quot;: &quot;Rotación&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>58</td>
                        <td class='hits'></td>
                        <td class='source'>  #   &quot;city&quot;: &quot;Porto&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>59</td>
                        <td class='hits'></td>
                        <td class='source'>  #   &quot;vehicle_type&quot;: &quot;c&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>60</td>
                        <td class='hits'></td>
                        <td class='source'>  #   &quot;charge_type&quot;: null,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>61</td>
                        <td class='hits'></td>
                        <td class='source'>  #   &quot;additional_fields&quot;: null,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>62</td>
                        <td class='hits'></td>
                        <td class='source'>  #   &quot;is_emulated&quot;: false,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>63</td>
                        <td class='hits'></td>
                        <td class='source'>  #   &quot;copying_from&quot;: null</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>64</td>
                        <td class='hits'></td>
                        <td class='source'>  # }</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>65</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>66</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>67</td>
                        <td class='hits'></td>
                        <td class='source'>    Uses the Embers&#39;s API to get updated information of the given reservation</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>68</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>69</td>
                        <td class='hits'></td>
                        <td class='source'>  def get_reservation(locator) do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>70</td>
                        <td class='hits'>3</td>
                        <td class='source'>    {domain, api_key, _timezone} = get_config(:trindade_park)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>71</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>72</td>
                        <td class='hits'>3</td>
                        <td class='source'>    url = &quot;#{domain}/porto-parking/reservations/?locator=#{locator}&quot;</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>73</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>74</td>
                        <td class='hits'></td>
                        <td class='source'>    get(url, api_key)</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>75</td>
                        <td class='hits'>3</td>
                        <td class='source'>    |&gt; handle_http_response()</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>76</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>77</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>78</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>79</td>
                        <td class='hits'></td>
                        <td class='source'>    Creates a new reservation by posting Embers&#39;s API</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>80</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>81</td>
                        <td class='hits'></td>
                        <td class='source'>  def make_reservation(product_type) do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>82</td>
                        <td class='hits'>6</td>
                        <td class='source'>    {domain, api_key, timezone} = get_config(:trindade_park)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>83</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>84</td>
                        <td class='hits'>6</td>
                        <td class='source'>    url = &quot;#{domain}/porto-parking/reservations&quot;</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>85</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>86</td>
                        <td class='hits'></td>
                        <td class='source'>    post(url, api_key, %{</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>87</td>
                        <td class='hits'></td>
                        <td class='source'>      activation: Timex.now(timezone) |&gt; format_date_time(),</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>88</td>
                        <td class='hits'></td>
                        <td class='source'>      expiry:</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>89</td>
                        <td class='hits'></td>
                        <td class='source'>        Timex.now(timezone) |&gt; Timex.add(Timex.Duration.from_minutes(30)) |&gt; format_date_time(),</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>90</td>
                        <td class='hits'></td>
                        <td class='source'>      product_type: product_type</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>91</td>
                        <td class='hits'></td>
                        <td class='source'>    })</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>92</td>
                        <td class='hits'>6</td>
                        <td class='source'>    |&gt; handle_http_response()</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>93</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>94</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>95</td>
                        <td class='hits'></td>
                        <td class='source'>  # {</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>96</td>
                        <td class='hits'></td>
                        <td class='source'>  #   &quot;product_type&quot;: &quot;1&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>97</td>
                        <td class='hits'></td>
                        <td class='source'>  #   &quot;activation&quot;: &quot;2018-10-06T13:13:38&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>98</td>
                        <td class='hits'></td>
                        <td class='source'>  #   &quot;expiry&quot;: &quot;2018-10-06T14:13:38&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>99</td>
                        <td class='hits'></td>
                        <td class='source'>  # }</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>100</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>101</td>
                        <td class='hits'></td>
                        <td class='source'>  #   {</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>102</td>
                        <td class='hits'></td>
                        <td class='source'>  #   &quot;locator&quot;: &quot;AP9E60356&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>103</td>
                        <td class='hits'></td>
                        <td class='source'>  #   &quot;product&quot;: {</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>104</td>
                        <td class='hits'></td>
                        <td class='source'>  #     &quot;media_type&quot;: 65,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>105</td>
                        <td class='hits'></td>
                        <td class='source'>  #     &quot;id&quot;: &quot;0111000000317&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>106</td>
                        <td class='hits'></td>
                        <td class='source'>  #     &quot;description&quot;: &quot;Reserva WEB (rotación)&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>107</td>
                        <td class='hits'></td>
                        <td class='source'>  #     &quot;number&quot;: &quot;11000000317&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>108</td>
                        <td class='hits'></td>
                        <td class='source'>  #     &quot;barcode&quot;: &quot;Q7015788547098903631470248212265410&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>109</td>
                        <td class='hits'></td>
                        <td class='source'>  #     &quot;barcode_type&quot;: &quot;QR&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>110</td>
                        <td class='hits'></td>
                        <td class='source'>  #     &quot;door_pinpad_key&quot;: &quot;30586&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>111</td>
                        <td class='hits'></td>
                        <td class='source'>  #   }</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>112</td>
                        <td class='hits'></td>
                        <td class='source'>  # }</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>113</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>114</td>
                        <td class='hits'></td>
                        <td class='source'>  # {</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>115</td>
                        <td class='hits'></td>
                        <td class='source'>  #   &quot;locator&quot;: &quot;WR9E60358&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>116</td>
                        <td class='hits'></td>
                        <td class='source'>  #   &quot;product&quot;: {</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>117</td>
                        <td class='hits'></td>
                        <td class='source'>  #     &quot;media_type&quot;: 65,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>118</td>
                        <td class='hits'></td>
                        <td class='source'>  #     &quot;id&quot;: &quot;0111000000319&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>119</td>
                        <td class='hits'></td>
                        <td class='source'>  #     &quot;description&quot;: &quot;Reserva WEB (rotación)&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>120</td>
                        <td class='hits'></td>
                        <td class='source'>  #     &quot;number&quot;: &quot;11000000319&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>121</td>
                        <td class='hits'></td>
                        <td class='source'>  #     &quot;barcode&quot;: &quot;Q9291346215529323111607540968582522&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>122</td>
                        <td class='hits'></td>
                        <td class='source'>  #     &quot;barcode_type&quot;: &quot;QR&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>123</td>
                        <td class='hits'></td>
                        <td class='source'>  #     &quot;door_pinpad_key&quot;: &quot;36382&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>124</td>
                        <td class='hits'></td>
                        <td class='source'>  #   }</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>125</td>
                        <td class='hits'></td>
                        <td class='source'>  # }</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>126</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>127</td>
                        <td class='hits'></td>
                        <td class='source'>  # {</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>128</td>
                        <td class='hits'></td>
                        <td class='source'>  #   &quot;locator&quot;: &quot;AP9E60356&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>129</td>
                        <td class='hits'></td>
                        <td class='source'>  #   &quot;created&quot;: &quot;2018-09-11T19:04:19.540&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>130</td>
                        <td class='hits'></td>
                        <td class='source'>  #   &quot;license_plate&quot;: &quot;DDD&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>131</td>
                        <td class='hits'></td>
                        <td class='source'>  #   &quot;product_type&quot;: &quot;1&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>132</td>
                        <td class='hits'></td>
                        <td class='source'>  #   &quot;activation&quot;: &quot;2018-10-06T13:13:38.000&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>133</td>
                        <td class='hits'></td>
                        <td class='source'>  #   &quot;expiry&quot;: &quot;2018-10-06T14:13:38.997&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>134</td>
                        <td class='hits'></td>
                        <td class='source'>  #   &quot;holder_name&quot;: &quot;&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>135</td>
                        <td class='hits'></td>
                        <td class='source'>  #   &quot;phone_number&quot;: &quot;&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>136</td>
                        <td class='hits'></td>
                        <td class='source'>  #   &quot;email&quot;: &quot;&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>137</td>
                        <td class='hits'></td>
                        <td class='source'>  #   &quot;remarks&quot;: &quot;Localizador: AP9E60356&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>138</td>
                        <td class='hits'></td>
                        <td class='source'>  #   &quot;reference_id&quot;: &quot;&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>139</td>
                        <td class='hits'></td>
                        <td class='source'>  #   &quot;amount_paid&quot;: 0,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>140</td>
                        <td class='hits'></td>
                        <td class='source'>  #   &quot;automatic_use_by_license_plate&quot;: true,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>141</td>
                        <td class='hits'></td>
                        <td class='source'>  #   &quot;available_balance&quot;: 0,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>142</td>
                        <td class='hits'></td>
                        <td class='source'>  #   &quot;attached_product_group&quot;: &quot;&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>143</td>
                        <td class='hits'></td>
                        <td class='source'>  #   &quot;cancelled&quot;: false,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>144</td>
                        <td class='hits'></td>
                        <td class='source'>  #   &quot;product&quot;: {</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>145</td>
                        <td class='hits'></td>
                        <td class='source'>  #     &quot;media_type&quot;: 65,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>146</td>
                        <td class='hits'></td>
                        <td class='source'>  #     &quot;id&quot;: &quot;0111000000317&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>147</td>
                        <td class='hits'></td>
                        <td class='source'>  #     &quot;description&quot;: &quot;Reserva WEB (rotación)&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>148</td>
                        <td class='hits'></td>
                        <td class='source'>  #     &quot;number&quot;: &quot;11000000317&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>149</td>
                        <td class='hits'></td>
                        <td class='source'>  #     &quot;barcode&quot;: &quot;Q0398038902272573011109219257420611&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>150</td>
                        <td class='hits'></td>
                        <td class='source'>  #     &quot;door_pinpad_key&quot;: &quot;30586&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>151</td>
                        <td class='hits'></td>
                        <td class='source'>  #     &quot;first_use&quot;: null,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>152</td>
                        <td class='hits'></td>
                        <td class='source'>  #     &quot;last_use&quot;: null,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>153</td>
                        <td class='hits'></td>
                        <td class='source'>  #     &quot;status&quot;: {</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>154</td>
                        <td class='hits'></td>
                        <td class='source'>  #       &quot;presence_status&quot;: 1</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>155</td>
                        <td class='hits'></td>
                        <td class='source'>  #     }</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>156</td>
                        <td class='hits'></td>
                        <td class='source'>  #   }</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>157</td>
                        <td class='hits'></td>
                        <td class='source'>  # }</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>158</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>159</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>160</td>
                        <td class='hits'></td>
                        <td class='source'>  Cancels an existing reservation by puting Embers&#39;s API</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>161</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>162</td>
                        <td class='hits'></td>
                        <td class='source'>  def cancel_reservation(locator) do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>163</td>
                        <td class='hits'>3</td>
                        <td class='source'>    {domain, api_key, timezone} = get_config(:trindade_park)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>164</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>165</td>
                        <td class='hits'>3</td>
                        <td class='source'>    url = &quot;#{domain}/porto-parking/reservations/#{locator}&quot;</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>166</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>167</td>
                        <td class='hits'></td>
                        <td class='source'>    put(url, api_key, %{</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>168</td>
                        <td class='hits'></td>
                        <td class='source'>      cancelled: true,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>169</td>
                        <td class='hits'></td>
                        <td class='source'>      expiry:</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>170</td>
                        <td class='hits'></td>
                        <td class='source'>        Timex.now(timezone) |&gt; Timex.add(Timex.Duration.from_minutes(1)) |&gt; format_date_time()</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>171</td>
                        <td class='hits'></td>
                        <td class='source'>    })</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>172</td>
                        <td class='hits'>3</td>
                        <td class='source'>    |&gt; handle_http_response()</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>173</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>174</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>175</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>176</td>
                        <td class='hits'></td>
                        <td class='source'>  Deletes an existing reservation from Embers&#39;s API</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>177</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>178</td>
                        <td class='hits'></td>
                        <td class='source'>  def delete_reservation(locator) do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>179</td>
                        <td class='hits'>3</td>
                        <td class='source'>    {domain, api_key, _timezone} = get_config(:trindade_park)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>180</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>181</td>
                        <td class='hits'>3</td>
                        <td class='source'>    url = &quot;#{domain}/porto-parking/reservations/#{locator}&quot;</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>182</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>183</td>
                        <td class='hits'></td>
                        <td class='source'>    delete(url, api_key)</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>184</td>
                        <td class='hits'>3</td>
                        <td class='source'>    |&gt; handle_http_response()</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>185</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>186</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>187</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>188</td>
                        <td class='hits'></td>
                        <td class='source'>  Makes the first step in the payment workflow by posting Embers&#39;s API</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>189</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>190</td>
                        <td class='hits'></td>
                        <td class='source'>  def payment1(barcode) do</td>
                      </tr>
                  
                
                  
                      <tr class='miss'>
                        <td class='line'>191</td>
                        <td class='hits'>0</td>
                        <td class='source'>    {domain, api_key, timezone} = get_config(:trindade_park)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>192</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr class='miss'>
                        <td class='line'>193</td>
                        <td class='hits'>0</td>
                        <td class='source'>    url = &quot;#{domain}/porto-parking/payment1&quot;</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>194</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>195</td>
                        <td class='hits'></td>
                        <td class='source'>    post(url, api_key, %{</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>196</td>
                        <td class='hits'></td>
                        <td class='source'>      barcode: barcode,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>197</td>
                        <td class='hits'></td>
                        <td class='source'>      now: Timex.now(timezone) |&gt; format_date_time(),</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>198</td>
                        <td class='hits'></td>
                        <td class='source'>      discounts: &quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>199</td>
                        <td class='hits'></td>
                        <td class='source'>    })</td>
                      </tr>
                  
                
                  
                      <tr class='miss'>
                        <td class='line'>200</td>
                        <td class='hits'>0</td>
                        <td class='source'>    |&gt; handle_http_response()</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>201</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>202</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>203</td>
                        <td class='hits'></td>
                        <td class='source'>  # {</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>204</td>
                        <td class='hits'></td>
                        <td class='source'>  #   &quot;barcode&quot;: &quot;string&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>205</td>
                        <td class='hits'></td>
                        <td class='source'>  #   &quot;discounts&quot;: &quot;string&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>206</td>
                        <td class='hits'></td>
                        <td class='source'>  #   &quot;now&quot;: &quot;string&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>207</td>
                        <td class='hits'></td>
                        <td class='source'>  # }</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>208</td>
                        <td class='hits'></td>
                        <td class='source'>  # {</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>209</td>
                        <td class='hits'></td>
                        <td class='source'>  #   &quot;product_no&quot;: &quot;SAGA product number (Ticket number)&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>210</td>
                        <td class='hits'></td>
                        <td class='source'>  #   &quot;parking_start_time&quot;: &quot;Parking start datetime (ISO8601 format, yyyy-mm-ddThh:nn:ss)&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>211</td>
                        <td class='hits'></td>
                        <td class='source'>  #   &quot;parking_payment_time&quot;: &quot;Parking payment datetime (ISO8601 format, yyyy-mm-ddThh:nn:ss)&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>212</td>
                        <td class='hits'></td>
                        <td class='source'>  #   &quot;stay_time&quot;: &quot;Stay time, in minutes&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>213</td>
                        <td class='hits'></td>
                        <td class='source'>  #   &quot;parking_rate&quot;: &quot;Parking rate code&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>214</td>
                        <td class='hits'></td>
                        <td class='source'>  #   &quot;total_amount&quot;: &quot;Total amount to pay&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>215</td>
                        <td class='hits'></td>
                        <td class='source'>  #   &quot;discounts_amount&quot;: &quot;Discounts amount&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>216</td>
                        <td class='hits'></td>
                        <td class='source'>  #   &quot;outstanding_amount&quot;: &quot;Amount to pay after applying discounts&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>217</td>
                        <td class='hits'></td>
                        <td class='source'>  #   &quot;context_token&quot;: &quot;Context token to use in payment2 request&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>218</td>
                        <td class='hits'></td>
                        <td class='source'>  # }</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>219</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>220</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>221</td>
                        <td class='hits'></td>
                        <td class='source'>  Makes the second and final step in the payment workflow by posting Embers&#39;s API</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>222</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>223</td>
                        <td class='hits'></td>
                        <td class='source'>  def payment2(context_token) do</td>
                      </tr>
                  
                
                  
                      <tr class='miss'>
                        <td class='line'>224</td>
                        <td class='hits'>0</td>
                        <td class='source'>    {domain, api_key, _} = get_config(:trindade_park)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>225</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr class='miss'>
                        <td class='line'>226</td>
                        <td class='hits'>0</td>
                        <td class='source'>    url = &quot;#{domain}/porto-parking/payment2&quot;</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>227</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>228</td>
                        <td class='hits'></td>
                        <td class='source'>    post(url, api_key, %{</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>229</td>
                        <td class='hits'></td>
                        <td class='source'>      context_token: context_token,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>230</td>
                        <td class='hits'></td>
                        <td class='source'>      customer_name: &quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>231</td>
                        <td class='hits'></td>
                        <td class='source'>    })</td>
                      </tr>
                  
                
                  
                      <tr class='miss'>
                        <td class='line'>232</td>
                        <td class='hits'>0</td>
                        <td class='source'>    |&gt; handle_http_response()</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>233</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>234</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>235</td>
                        <td class='hits'></td>
                        <td class='source'>  # {</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>236</td>
                        <td class='hits'></td>
                        <td class='source'>  #   &quot;context_token&quot;: &quot;string&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>237</td>
                        <td class='hits'></td>
                        <td class='source'>  #   &quot;customer_name&quot;: &quot;string&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>238</td>
                        <td class='hits'></td>
                        <td class='source'>  #   &quot;truncated_pan&quot;: &quot;string&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>239</td>
                        <td class='hits'></td>
                        <td class='source'>  #   &quot;bank_auth_no&quot;: &quot;string&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>240</td>
                        <td class='hits'></td>
                        <td class='source'>  # }</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>241</td>
                        <td class='hits'></td>
                        <td class='source'>  #</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>242</td>
                        <td class='hits'></td>
                        <td class='source'>  # {</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>243</td>
                        <td class='hits'></td>
                        <td class='source'>  #   &quot;product_no&quot;: &quot;SAGA product number (Ticket number)&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>244</td>
                        <td class='hits'></td>
                        <td class='source'>  #   &quot;parking_start_time&quot;: &quot;Parking start datetime (ISO8601 format, yyyy-mm-ddThh:nn:ss)&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>245</td>
                        <td class='hits'></td>
                        <td class='source'>  #   &quot;parking_payment_time&quot;: &quot;Parking payment datetime (ISO8601 format, yyyy-mm-ddThh:nn:ss)&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>246</td>
                        <td class='hits'></td>
                        <td class='source'>  #   &quot;stay_time&quot;: &quot;Stay time, in minutes&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>247</td>
                        <td class='hits'></td>
                        <td class='source'>  #   &quot;parking_rate&quot;: &quot;Parking rate code&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>248</td>
                        <td class='hits'></td>
                        <td class='source'>  #   &quot;total_amount&quot;: &quot;Total amount to pay&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>249</td>
                        <td class='hits'></td>
                        <td class='source'>  #   &quot;discounts_amount&quot;: &quot;Discounts amount&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>250</td>
                        <td class='hits'></td>
                        <td class='source'>  #   &quot;amount_paid&quot;: &quot;Payed amount&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>251</td>
                        <td class='hits'></td>
                        <td class='source'>  #   &quot;receipt_no&quot;: &quot;Receipt number&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>252</td>
                        <td class='hits'></td>
                        <td class='source'>  #   &quot;shift_no&quot;: &quot;Recorded shift number&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>253</td>
                        <td class='hits'></td>
                        <td class='source'>  #   &quot;receipt_text&quot;: &quot;Payment receipt&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>254</td>
                        <td class='hits'></td>
                        <td class='source'>  # }</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>255</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>256</td>
                        <td class='hits'></td>
                        <td class='source'>  # {</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>257</td>
                        <td class='hits'></td>
                        <td class='source'>  #       &quot;parking_code&quot;: 1,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>258</td>
                        <td class='hits'></td>
                        <td class='source'>  #       &quot;payment_id&quot;: &quot;0175744591791&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>259</td>
                        <td class='hits'></td>
                        <td class='source'>  #       &quot;payment_time&quot;: &quot;2018-09-11T12:45:17.930&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>260</td>
                        <td class='hits'></td>
                        <td class='source'>  #       &quot;payment_time_dst&quot;: true,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>261</td>
                        <td class='hits'></td>
                        <td class='source'>  #       &quot;machine_payment_sequence_number&quot;: 1,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>262</td>
                        <td class='hits'></td>
                        <td class='source'>  #       &quot;machine_type&quot;: 1,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>263</td>
                        <td class='hits'></td>
                        <td class='source'>  #       &quot;machine_number&quot;: 1,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>264</td>
                        <td class='hits'></td>
                        <td class='source'>  #       &quot;shift_code&quot;: &quot;T18/101/0001&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>265</td>
                        <td class='hits'></td>
                        <td class='source'>  #       &quot;total_amount&quot;: 300,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>266</td>
                        <td class='hits'></td>
                        <td class='source'>  #       &quot;tax_rate&quot;: 21,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>267</td>
                        <td class='hits'></td>
                        <td class='source'>  #       &quot;tax_rate2&quot;: 0,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>268</td>
                        <td class='hits'></td>
                        <td class='source'>  #       &quot;tax_rate3&quot;: 0,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>269</td>
                        <td class='hits'></td>
                        <td class='source'>  #       &quot;payment_method&quot;: 0,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>270</td>
                        <td class='hits'></td>
                        <td class='source'>  #       &quot;paid_on_account&quot;: 300,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>271</td>
                        <td class='hits'></td>
                        <td class='source'>  #       &quot;remarks&quot;: &quot;Emisión de factura simplificada (Origen: 00118/402000011)&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>272</td>
                        <td class='hits'></td>
                        <td class='source'>  #       &quot;receipt_copy_requested&quot;: true,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>273</td>
                        <td class='hits'></td>
                        <td class='source'>  #       &quot;customer_parking_code&quot;: 1,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>274</td>
                        <td class='hits'></td>
                        <td class='source'>  #       &quot;customer_code&quot;: 7,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>275</td>
                        <td class='hits'></td>
                        <td class='source'>  #       &quot;teller_user_id&quot;: 6,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>276</td>
                        <td class='hits'></td>
                        <td class='source'>  #       &quot;paid_on_foot&quot;: false,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>277</td>
                        <td class='hits'></td>
                        <td class='source'>  #       &quot;receipts_remittance_number&quot;: &quot;&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>278</td>
                        <td class='hits'></td>
                        <td class='source'>  #       &quot;associated_cash_transaction_id&quot;: &quot;&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>279</td>
                        <td class='hits'></td>
                        <td class='source'>  #       &quot;business_name&quot;: &quot;JC Rubio&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>280</td>
                        <td class='hits'></td>
                        <td class='source'>  #       &quot;tin&quot;: &quot;02259730A&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>281</td>
                        <td class='hits'></td>
                        <td class='source'>  #       &quot;business_address&quot;: &quot;direccion&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>282</td>
                        <td class='hits'></td>
                        <td class='source'>  #       &quot;credit_card_last_digits&quot;: &quot;&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>283</td>
                        <td class='hits'></td>
                        <td class='source'>  #       &quot;credit_transaction_number&quot;: 0,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>284</td>
                        <td class='hits'></td>
                        <td class='source'>  #       &quot;credit_tansaction_authorization&quot;: &quot;&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>285</td>
                        <td class='hits'></td>
                        <td class='source'>  #       &quot;invoice_id&quot;: &quot;00118/101000001&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>286</td>
                        <td class='hits'></td>
                        <td class='source'>  #       &quot;receipt&quot;: &quot;========================================\r\n           Expo. Primavera 14           \r\n          EQUINSA Parking S.L.          \r\n            C/ Primavera, 14            \r\n         28850 Torrejón de Ardoz        \r\n             CIF: B-95786432            \r\n========================================\r\n 11/09/2018 12:45          T18/101/0001 \r\n Caja: 101             Cód. Operador: 6 \r\n        Núm Factura simplificada:       \r\n             00118/101000001            \r\n\r\n    Nombre: JC Rubio                    \r\n   CIF/NIF: 02259730A                   \r\n Domicilio: direccion\r\n - - - - - - - - - - - - - - - - - - - -\r\n                    1 x Artículo Manual\r\n         ** Cambio de ruedas **        \r\n      Importe:                 300,00 €\r\n----------------------------------------\r\n    Base Imp.:                 247,93 €\r\n  I.V.A.(21%):                  52,07 €\r\n                         ---------------\r\n    T O T A L:                 300,00 €\r\n========================================\r\n          Gracias por su visita         \r\n     Fecha emisión: 11/09/2018 12:45    \r\n========================================\r\n&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>287</td>
                        <td class='hits'></td>
                        <td class='source'>  #       &quot;emv_receipt&quot;: &quot;&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>288</td>
                        <td class='hits'></td>
                        <td class='source'>  #       &quot;receipt_series&quot;: &quot;&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>289</td>
                        <td class='hits'></td>
                        <td class='source'>  #       &quot;payment_hash&quot;: &quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>290</td>
                        <td class='hits'></td>
                        <td class='source'>  #     }</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>291</td>
                        <td class='hits'></td>
                        <td class='source'>end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>292</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>293</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>294</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>295</td>
                        <td class='hits'></td>
                        <td class='source'># {</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>296</td>
                        <td class='hits'></td>
                        <td class='source'>#  &quot;early_transaction_id&quot;: &quot;001180216113134102020002269&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>297</td>
                        <td class='hits'></td>
                        <td class='source'>#  &quot;product_no&quot;: &quot;02020002269&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>298</td>
                        <td class='hits'></td>
                        <td class='source'>#  &quot;license_plate&quot;: &quot;&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>299</td>
                        <td class='hits'></td>
                        <td class='source'>#  &quot;parking_start_time&quot;: &quot;2018-02-06T12:30:33.200&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>300</td>
                        <td class='hits'></td>
                        <td class='source'>#  &quot;parking_payment_time&quot;: &quot;2018-02-16T11:31:34.317&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>301</td>
                        <td class='hits'></td>
                        <td class='source'>#  &quot;stay_time&quot;: 14341,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>302</td>
                        <td class='hits'></td>
                        <td class='source'>#  &quot;parking_rate_code&quot;: 1,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>303</td>
                        <td class='hits'></td>
                        <td class='source'>#  &quot;parking_rate_description&quot;: &quot;Normal&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>304</td>
                        <td class='hits'></td>
                        <td class='source'>#  &quot;total_amount&quot;: 100,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>305</td>
                        <td class='hits'></td>
                        <td class='source'>#  &quot;discounts_amount&quot;: 0,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>306</td>
                        <td class='hits'></td>
                        <td class='source'>#  &quot;outstanding_amount&quot;: 100,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>307</td>
                        <td class='hits'></td>
                        <td class='source'>#  &quot;grace_period_minutes&quot;: 15,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>308</td>
                        <td class='hits'></td>
                        <td class='source'>#  &quot;current_product_QR_code&quot;: &quot;10202000226936893000&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>309</td>
                        <td class='hits'></td>
                        <td class='source'>#  &quot;paid_product_QR_code&quot;: &quot;10202000226936992765&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>310</td>
                        <td class='hits'></td>
                        <td class='source'>#  &quot;courtesy_minutes_to_pay&quot;: 5,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>311</td>
                        <td class='hits'></td>
                        <td class='source'>#  &quot;context_token&quot;: &quot;eJx1U9tunDAQ\/ZUVT620iWxzWYjES\/ILeUtWq1nbu7GKMbHNqhf13zvGxkVJK0CcOTPDXI75VUzwQ8vR05OV77N0\/uSVlsVDwQht7wi7o80zpQ8l3tV9yepiv2ZgzAs35+OrfR3HWQvpexowN0KNLuM++XsSwEXyN2P7qqTVYV+1hNUt69omuJBP3iXSqwkmiBjTM54GCF8L0Enbpyp+ztBMMkUaq\/S0xWxrlNHADJwCnFnzL8AzNHaCa4zDDBw694NVPFhuZWa8hcQs2TPMgxfquuWWzfBBhWq5+MYcjbbw05nYwKguy1sYvVLm7OLkZuBmHQ2uDoa0XmVxGAcXP\/klcD6rm3xb4Akn8AZFImQ1E5NtIV00wvOCiuLH7unxH6qiIzZkReZQMW7GZEICXsm+23d1R6qGdXjXtEzrXDvBkNDFf6I2LccaDgc\/LE4hJ2vQyfAihLGmC\/RN2oX+23U2UaWAPyRg0NXOwcGCiSrjbxCOaHnY14wyeqg71qRVJ9en0xt6AxvLaIjLR1nCQkjCQrmsejwH20MQsTZRYPk9qXtCTVJ3X54ed5S1T193z4p\/k34n5A6btSAgaxYEs5IfPxJS3xau+P0HEhFqHw==&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>312</td>
                        <td class='hits'></td>
                        <td class='source'>#  &quot;product_information&quot;: {</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>313</td>
                        <td class='hits'></td>
                        <td class='source'>#    &quot;media_raw_data&quot;: &quot;5B6461745D0D0A64697361736F3D33300D0A636F646261723D31303230323030303232363933363839333030300D0A&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>314</td>
                        <td class='hits'></td>
                        <td class='source'>#    &quot;media_type&quot;: 7,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>315</td>
                        <td class='hits'></td>
                        <td class='source'>#    &quot;id&quot;: &quot;102020002269&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>316</td>
                        <td class='hits'></td>
                        <td class='source'>#    &quot;number&quot;: &quot;02020002269&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>317</td>
                        <td class='hits'></td>
                        <td class='source'>#    &quot;truncated_parking_code&quot;: 1,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>318</td>
                        <td class='hits'></td>
                        <td class='source'>#    &quot;parking_code&quot;: 1,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>319</td>
                        <td class='hits'></td>
                        <td class='source'>#    &quot;product_group_code&quot;: 2,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>320</td>
                        <td class='hits'></td>
                        <td class='source'>#    &quot;product_group_code_description&quot;: &quot;(CB 128C) Ticket de entrada&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>321</td>
                        <td class='hits'></td>
                        <td class='source'>#    &quot;product_type&quot;: 1,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>322</td>
                        <td class='hits'></td>
                        <td class='source'>#    &quot;producer_machine_number&quot;: 2,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>323</td>
                        <td class='hits'></td>
                        <td class='source'>#    &quot;ordinal&quot;: 2269,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>324</td>
                        <td class='hits'></td>
                        <td class='source'>#    &quot;product_version&quot;: 1,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>325</td>
                        <td class='hits'></td>
                        <td class='source'>#    &quot;presence_status&quot;: 3,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>326</td>
                        <td class='hits'></td>
                        <td class='source'>#    &quot;last_movement&quot;: &quot;2018-02-06T12:30:33.200&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>327</td>
                        <td class='hits'></td>
                        <td class='source'>#    &quot;last_movement_dst&quot;: false,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>328</td>
                        <td class='hits'></td>
                        <td class='source'>#    &quot;paid&quot;: false,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>329</td>
                        <td class='hits'></td>
                        <td class='source'>#    &quot;media_attached_product_groups&quot;: &quot;&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>330</td>
                        <td class='hits'></td>
                        <td class='source'>#    &quot;available_balance&quot;: 0,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>331</td>
                        <td class='hits'></td>
                        <td class='source'>#    &quot;balance_readed_from_media&quot;: false,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>332</td>
                        <td class='hits'></td>
                        <td class='source'>#    &quot;cancelled_mark&quot;: false,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>333</td>
                        <td class='hits'></td>
                        <td class='source'>#    &quot;today_uses&quot;: 0,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>334</td>
                        <td class='hits'></td>
                        <td class='source'>#    &quot;total_uses&quot;: 0,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>335</td>
                        <td class='hits'></td>
                        <td class='source'>#    &quot;locked&quot;: false,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>336</td>
                        <td class='hits'></td>
                        <td class='source'>#    &quot;antipassback&quot;: true,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>337</td>
                        <td class='hits'></td>
                        <td class='source'>#    &quot;license_plate&quot;: &quot;&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>338</td>
                        <td class='hits'></td>
                        <td class='source'>#    &quot;creation_date&quot;: &quot;2018-02-06T12:30:33.593&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>339</td>
                        <td class='hits'></td>
                        <td class='source'>#    &quot;force_rate_code&quot;: 0,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>340</td>
                        <td class='hits'></td>
                        <td class='source'>#    &quot;renewals_payment_control&quot;: false,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>341</td>
                        <td class='hits'></td>
                        <td class='source'>#    &quot;customer_parking_code&quot;: 0,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>342</td>
                        <td class='hits'></td>
                        <td class='source'>#    &quot;customer_code&quot;: 0,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>343</td>
                        <td class='hits'></td>
                        <td class='source'>#    &quot;last_media_write&quot;: &quot;2018-02-06T12:30:35.797&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>344</td>
                        <td class='hits'></td>
                        <td class='source'>#    &quot;media_write_counter&quot;: 1,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>345</td>
                        <td class='hits'></td>
                        <td class='source'>#    &quot;automatic_use_by_license_plate&quot;: false,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>346</td>
                        <td class='hits'></td>
                        <td class='source'>#    &quot;old_subscriber_id&quot;: &quot;&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>347</td>
                        <td class='hits'></td>
                        <td class='source'>#    &quot;last_movement_license_plate&quot;: &quot;&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>348</td>
                        <td class='hits'></td>
                        <td class='source'>#    &quot;license_plate_image_path&quot;: &quot;\\\\192.168.70.53\\Matriculas\\180206\\E2,180206123027500,180206,123027,---.JPG&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>349</td>
                        <td class='hits'></td>
                        <td class='source'>#    &quot;skip_entry_license_plate_verification&quot;: false,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>350</td>
                        <td class='hits'></td>
                        <td class='source'>#    &quot;skip_exit_license_plate_verification&quot;: false,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>351</td>
                        <td class='hits'></td>
                        <td class='source'>#    &quot;holder_first_name&quot;: &quot;&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>352</td>
                        <td class='hits'></td>
                        <td class='source'>#    &quot;holder_last_name&quot;: &quot;&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>353</td>
                        <td class='hits'></td>
                        <td class='source'>#    &quot;holder_id_card&quot;: &quot;&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>354</td>
                        <td class='hits'></td>
                        <td class='source'>#    &quot;holder_title&quot;: &quot;&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>355</td>
                        <td class='hits'></td>
                        <td class='source'>#    &quot;place_number&quot;: &quot;&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>356</td>
                        <td class='hits'></td>
                        <td class='source'>#    &quot;remarks&quot;: &quot;&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>357</td>
                        <td class='hits'></td>
                        <td class='source'>#    &quot;last_movement_parking_code&quot;: 1,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>358</td>
                        <td class='hits'></td>
                        <td class='source'>#    &quot;last_movement_machine_type&quot;: 5,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>359</td>
                        <td class='hits'></td>
                        <td class='source'>#    &quot;last_movement_machine_number&quot;: 2,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>360</td>
                        <td class='hits'></td>
                        <td class='source'>#    &quot;additional_data&quot;: &quot;5B6461746164695D0D0A636F6467727570726F76696E3D340D0A666563686F7261637467727570726F76696E3D34333134372C343638363333313934340D0A&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>361</td>
                        <td class='hits'></td>
                        <td class='source'>#    &quot;database_completed&quot;: true,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>362</td>
                        <td class='hits'></td>
                        <td class='source'>#    &quot;in_use&quot;: true,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>363</td>
                        <td class='hits'></td>
                        <td class='source'>#    &quot;courtesy_time_override&quot;: false</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>364</td>
                        <td class='hits'></td>
                        <td class='source'>#  }</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>365</td>
                        <td class='hits'></td>
                        <td class='source'># }</td>
                      </tr>
                  
                
              </tbody>
            </table>
          </div>
        
          <div class='file'>
            <h2 id='lib/parkapp_web/api_integration/embers/behaviour.ex'>lib/parkapp_web/api_integration/embers/behaviour.ex</h1>
            <div id='stats' class='terrible'>
              <div class='percentage'>0</div>
              <div class='sloc'>0</div>
              <div class='hits'>0</div>
              <div class='misses'>0</div>
            </div>
            <table id='source'>
              <thead>
                <tr>
                  <th>Line</th>
                  <th>Hits</th>
                  <th>Source</th>
                </tr>
              <tbody>
                
                  
                      <tr>
                        <td class='line'>0</td>
                        <td class='hits'></td>
                        <td class='source'>defmodule ParkappWeb.ApiIntegration.Embers.Behaviour do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>1</td>
                        <td class='hits'></td>
                        <td class='source'>  @moduledoc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>2</td>
                        <td class='hits'></td>
                        <td class='source'>    Defines the interface for every implementation of Embers API</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>3</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>4</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>5</td>
                        <td class='hits'></td>
                        <td class='source'>  @callback get_route(String, String, String) :: {:ok, Map} | {:error, Map} | nil</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>6</td>
                        <td class='hits'></td>
                        <td class='source'>  @callback get_reservation(String) :: {:ok, Map} | {:error, Map} | nil</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>7</td>
                        <td class='hits'></td>
                        <td class='source'>  @callback make_reservation(String) :: {:ok, Map} | {:error, Map} | nil</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>8</td>
                        <td class='hits'></td>
                        <td class='source'>  @callback cancel_reservation(String) :: {:ok, Map} | {:error, Map} | nil</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>9</td>
                        <td class='hits'></td>
                        <td class='source'>  @callback delete_reservation(String) :: {:ok, nil} | {:error, Map} | nil</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>10</td>
                        <td class='hits'></td>
                        <td class='source'>  @callback payment1(String) :: {:ok, Map} | {:error, Map} | nil</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>11</td>
                        <td class='hits'></td>
                        <td class='source'>  @callback payment2(String) :: {:ok, Map} | {:error, Map} | nil</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>12</td>
                        <td class='hits'></td>
                        <td class='source'>end</td>
                      </tr>
                  
                
              </tbody>
            </table>
          </div>
        
          <div class='file'>
            <h2 id='lib/parkapp_web/api_integration/embers/helpers.ex'>lib/parkapp_web/api_integration/embers/helpers.ex</h1>
            <div id='stats' class='high'>
              <div class='percentage'>93.1</div>
              <div class='sloc'>29</div>
              <div class='hits'>284</div>
              <div class='misses'>2</div>
            </div>
            <table id='source'>
              <thead>
                <tr>
                  <th>Line</th>
                  <th>Hits</th>
                  <th>Source</th>
                </tr>
              <tbody>
                
                  
                      <tr>
                        <td class='line'>0</td>
                        <td class='hits'></td>
                        <td class='source'>defmodule ParkappWeb.ApiIntegration.Embers.Helpers do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>1</td>
                        <td class='hits'></td>
                        <td class='source'>  @moduledoc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>2</td>
                        <td class='hits'></td>
                        <td class='source'>    Helpers that support the Embers API integration</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>3</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>4</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>5</td>
                        <td class='hits'></td>
                        <td class='source'>  import ParkappWeb.ApiIntegration.Helpers</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>6</td>
                        <td class='hits'></td>
                        <td class='source'>  require Logger</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>7</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>8</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>9</td>
                        <td class='hits'></td>
                        <td class='source'>    Returns the module to use for the API calls</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>10</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>11</td>
                        <td class='hits'></td>
                        <td class='source'>  def get_api_module() do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>12</td>
                        <td class='hits'></td>
                        <td class='source'>    Application.get_env(:parkapp, :embers_api, [])</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>13</td>
                        <td class='hits'></td>
                        <td class='source'>    |&gt; Enum.into(%{})</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>14</td>
                        <td class='hits'>31</td>
                        <td class='source'>    |&gt; Map.get(:module)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>15</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>16</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>17</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>18</td>
                        <td class='hits'></td>
                        <td class='source'>  Returns the configuration to call the correct API</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>19</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>20</td>
                        <td class='hits'></td>
                        <td class='source'>  def get_config(:routing) do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>21</td>
                        <td class='hits'>6</td>
                        <td class='source'>    config =</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>22</td>
                        <td class='hits'></td>
                        <td class='source'>      Application.get_env(:parkapp, :embers_api, [])</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>23</td>
                        <td class='hits'></td>
                        <td class='source'>      |&gt; Enum.into(%{})</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>24</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>25</td>
                        <td class='hits'>6</td>
                        <td class='source'>    domain = Map.get(config, :domain, &quot;&quot;)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>26</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>27</td>
                        <td class='hits'>6</td>
                        <td class='source'>    public_transportation_agencies_time_zone =</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>28</td>
                        <td class='hits'></td>
                        <td class='source'>      Map.get(config, :public_transportation_agencies_time_zone, &quot;Etc/UTC&quot;)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>29</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>30</td>
                        <td class='hits'>6</td>
                        <td class='source'>    config = Map.get(config, :routing, %{})</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>31</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>32</td>
                        <td class='hits'>6</td>
                        <td class='source'>    api_key = Map.get(config, :api_key, &quot;&quot;)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>33</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>34</td>
                        <td class='hits'>6</td>
                        <td class='source'>    max_walk_distance = Map.get(config, :max_walk_distance, &quot;&quot;)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>35</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>36</td>
                        <td class='hits'>6</td>
                        <td class='source'>    {domain, api_key, max_walk_distance, public_transportation_agencies_time_zone}</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>37</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>38</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>39</td>
                        <td class='hits'></td>
                        <td class='source'>  def get_config(:trindade_park) do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>40</td>
                        <td class='hits'>15</td>
                        <td class='source'>    config =</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>41</td>
                        <td class='hits'></td>
                        <td class='source'>      Application.get_env(:parkapp, :embers_api, [])</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>42</td>
                        <td class='hits'></td>
                        <td class='source'>      |&gt; Enum.into(%{})</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>43</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>44</td>
                        <td class='hits'>15</td>
                        <td class='source'>    domain = Map.get(config, :domain, &quot;&quot;)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>45</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>46</td>
                        <td class='hits'>15</td>
                        <td class='source'>    public_transportation_agencies_time_zone =</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>47</td>
                        <td class='hits'></td>
                        <td class='source'>      Map.get(config, :public_transportation_agencies_time_zone, &quot;Etc/UTC&quot;)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>48</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>49</td>
                        <td class='hits'>15</td>
                        <td class='source'>    api_key =</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>50</td>
                        <td class='hits'></td>
                        <td class='source'>      config</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>51</td>
                        <td class='hits'></td>
                        <td class='source'>      |&gt; Map.get(:trindade_park, %{})</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>52</td>
                        <td class='hits'></td>
                        <td class='source'>      |&gt; Map.get(:api_key, &quot;&quot;)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>53</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>54</td>
                        <td class='hits'>15</td>
                        <td class='source'>    {domain, api_key, public_transportation_agencies_time_zone}</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>55</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>56</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>57</td>
                        <td class='hits'></td>
                        <td class='source'>  def get_config(_id), do: :error</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>58</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>59</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>60</td>
                        <td class='hits'></td>
                        <td class='source'>  Returns utc_now date and time with the format supported by the Embers&#39;s API</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>61</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>62</td>
                        <td class='hits'></td>
                        <td class='source'>  def now_date_time_tuple_with_format(timezone) do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>63</td>
                        <td class='hits'>6</td>
                        <td class='source'>    now = Timex.now(timezone)</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>64</td>
                        <td class='hits'>6</td>
                        <td class='source'>    date = Timex.format!(now, &quot;%Y-%m-%d&quot;, :strftime)</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>65</td>
                        <td class='hits'>6</td>
                        <td class='source'>    time = Timex.format!(now, &quot;%H:%M&quot;, :strftime)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>66</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>67</td>
                        <td class='hits'></td>
                        <td class='source'>    {date, time}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>68</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>69</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>70</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>71</td>
                        <td class='hits'></td>
                        <td class='source'>    Given a datetime, a string representation of it is returned with the API&#39;s supported format</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>72</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>73</td>
                        <td class='hits'></td>
                        <td class='source'>  def format_date_time(datetime) do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>74</td>
                        <td class='hits'>15</td>
                        <td class='source'>    date = Timex.format!(datetime, &quot;%Y-%m-%d&quot;, :strftime)</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>75</td>
                        <td class='hits'>15</td>
                        <td class='source'>    time = Timex.format!(datetime, &quot;%H:%M:%S&quot;, :strftime)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>76</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>77</td>
                        <td class='hits'>15</td>
                        <td class='source'>    &quot;#{date}T#{time}&quot;</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>78</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>79</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>80</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>81</td>
                        <td class='hits'></td>
                        <td class='source'>    Generic handler for HTTP requests</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>82</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>83</td>
                        <td class='hits'></td>
                        <td class='source'>  def handle_http_response(response, default \\ nil) do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>84</td>
                        <td class='hits'>21</td>
                        <td class='source'>    IO.inspect(response, label: &quot;kasdgb&quot;)</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>85</td>
                        <td class='hits'>21</td>
                        <td class='source'>    case response do</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>86</td>
                        <td class='hits'></td>
                        <td class='source'>      {:ok, %HTTPoison.Response{status_code: status_code, body: body}}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>87</td>
                        <td class='hits'></td>
                        <td class='source'>      when status_code in [200, 204] -&gt;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>88</td>
                        <td class='hits'></td>
                        <td class='source'>        {:ok, get_json(body, default)}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>89</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>90</td>
                        <td class='hits'></td>
                        <td class='source'>      {:ok, %HTTPoison.Response{status_code: status_code, body: body}}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>91</td>
                        <td class='hits'></td>
                        <td class='source'>      when status_code in [400, 403] -&gt;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>92</td>
                        <td class='hits'></td>
                        <td class='source'>        {:error, get_json(body, default)}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>93</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>94</td>
                        <td class='hits'></td>
                        <td class='source'>      {:ok, %HTTPoison.Response{status_code: status_code}} -&gt;</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>95</td>
                        <td class='hits'>5</td>
                        <td class='source'>        Logger.warn(status_code)</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>96</td>
                        <td class='hits'>5</td>
                        <td class='source'>        default</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>97</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>98</td>
                        <td class='hits'></td>
                        <td class='source'>      {:error, %HTTPoison.Error{reason: reason}} -&gt;</td>
                      </tr>
                  
                
                  
                      <tr class='miss'>
                        <td class='line'>99</td>
                        <td class='hits'>0</td>
                        <td class='source'>        Logger.error(reason)</td>
                      </tr>
                    
                
                  
                      <tr class='miss'>
                        <td class='line'>100</td>
                        <td class='hits'>0</td>
                        <td class='source'>        default</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>101</td>
                        <td class='hits'></td>
                        <td class='source'>    end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>102</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>103</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>104</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>105</td>
                        <td class='hits'></td>
                        <td class='source'>  Generic HTTP GET request for Embers&#39;s API</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>106</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>107</td>
                        <td class='hits'></td>
                        <td class='source'>  def get(url, api_key) do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>108</td>
                        <td class='hits'>9</td>
                        <td class='source'>    HTTPoison.get(</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>109</td>
                        <td class='hits'></td>
                        <td class='source'>      url,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>110</td>
                        <td class='hits'></td>
                        <td class='source'>      &quot;X-Gravitee-Api-Key&quot;: api_key</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>111</td>
                        <td class='hits'></td>
                        <td class='source'>    )</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>112</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>113</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>114</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>115</td>
                        <td class='hits'></td>
                        <td class='source'>  Generic HTTP DELETE request for Embers&#39;s API</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>116</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>117</td>
                        <td class='hits'></td>
                        <td class='source'>  def delete(url, api_key) do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>118</td>
                        <td class='hits'>3</td>
                        <td class='source'>    HTTPoison.delete(</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>119</td>
                        <td class='hits'></td>
                        <td class='source'>      url,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>120</td>
                        <td class='hits'></td>
                        <td class='source'>      &quot;X-Gravitee-Api-Key&quot;: api_key</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>121</td>
                        <td class='hits'></td>
                        <td class='source'>    )</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>122</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>123</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>124</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>125</td>
                        <td class='hits'></td>
                        <td class='source'>  Generic HTTP POST request for Embers&#39;s API</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>126</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>127</td>
                        <td class='hits'></td>
                        <td class='source'>  def post(url, api_key, data) do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>128</td>
                        <td class='hits'>6</td>
                        <td class='source'>    HTTPoison.post(</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>129</td>
                        <td class='hits'></td>
                        <td class='source'>      url,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>130</td>
                        <td class='hits'></td>
                        <td class='source'>      Poison.encode!(data),</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>131</td>
                        <td class='hits'></td>
                        <td class='source'>      &quot;Content-Type&quot;: &quot;application/json&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>132</td>
                        <td class='hits'></td>
                        <td class='source'>      &quot;X-Gravitee-Api-Key&quot;: api_key,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>133</td>
                        <td class='hits'></td>
                        <td class='source'>      accept: &quot;application/json&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>134</td>
                        <td class='hits'></td>
                        <td class='source'>    )</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>135</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>136</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>137</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>138</td>
                        <td class='hits'></td>
                        <td class='source'>  Generic HTTP PUT request for Embers&#39;s API</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>139</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>140</td>
                        <td class='hits'></td>
                        <td class='source'>  def put(url, api_key, data) do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>141</td>
                        <td class='hits'>3</td>
                        <td class='source'>    HTTPoison.put(</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>142</td>
                        <td class='hits'></td>
                        <td class='source'>      url,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>143</td>
                        <td class='hits'></td>
                        <td class='source'>      Poison.encode!(data),</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>144</td>
                        <td class='hits'></td>
                        <td class='source'>      &quot;Content-Type&quot;: &quot;application/json&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>145</td>
                        <td class='hits'></td>
                        <td class='source'>      &quot;X-Gravitee-Api-Key&quot;: api_key,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>146</td>
                        <td class='hits'></td>
                        <td class='source'>      accept: &quot;application/json&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>147</td>
                        <td class='hits'></td>
                        <td class='source'>    )</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>148</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>149</td>
                        <td class='hits'></td>
                        <td class='source'>end</td>
                      </tr>
                  
                
              </tbody>
            </table>
          </div>
        
          <div class='file'>
            <h2 id='lib/parkapp_web/api_integration/embers/mock.ex'>lib/parkapp_web/api_integration/embers/mock.ex</h1>
            <div id='stats' class='terrible'>
              <div class='percentage'>0</div>
              <div class='sloc'>0</div>
              <div class='hits'>0</div>
              <div class='misses'>0</div>
            </div>
            <table id='source'>
              <thead>
                <tr>
                  <th>Line</th>
                  <th>Hits</th>
                  <th>Source</th>
                </tr>
              <tbody>
                
                  
                      <tr>
                        <td class='line'>0</td>
                        <td class='hits'></td>
                        <td class='source'>defmodule ParkappWeb.ApiIntegration.Embers.Mock do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>1</td>
                        <td class='hits'></td>
                        <td class='source'>  @moduledoc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>2</td>
                        <td class='hits'></td>
                        <td class='source'>    Mock implementation of the Embers API. Used for testing.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>3</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>4</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>5</td>
                        <td class='hits'></td>
                        <td class='source'>  @behaviour ParkappWeb.ApiIntegration.Embers.Behaviour</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>6</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>7</td>
                        <td class='hits'></td>
                        <td class='source'>  def get_route(_from, _to, _mode) do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>8</td>
                        <td class='hits'></td>
                        <td class='source'>    {</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>9</td>
                        <td class='hits'></td>
                        <td class='source'>      :ok,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>10</td>
                        <td class='hits'></td>
                        <td class='source'>      %{</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>11</td>
                        <td class='hits'></td>
                        <td class='source'>        &quot;plan&quot; =&gt; %{</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>12</td>
                        <td class='hits'></td>
                        <td class='source'>          &quot;date&quot; =&gt; 1_536_656_665_000,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>13</td>
                        <td class='hits'></td>
                        <td class='source'>          &quot;fromPlace&quot; =&gt; %{</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>14</td>
                        <td class='hits'></td>
                        <td class='source'>            &quot;lat&quot; =&gt; &quot;50.93633658100821&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>15</td>
                        <td class='hits'></td>
                        <td class='source'>            &quot;lon&quot; =&gt; &quot;6.976017951965332&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>16</td>
                        <td class='hits'></td>
                        <td class='source'>            &quot;name&quot; =&gt; &quot;&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>17</td>
                        <td class='hits'></td>
                        <td class='source'>            &quot;orig&quot; =&gt; &quot;&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>18</td>
                        <td class='hits'></td>
                        <td class='source'>            &quot;vertexType&quot; =&gt; &quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>19</td>
                        <td class='hits'></td>
                        <td class='source'>          },</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>20</td>
                        <td class='hits'></td>
                        <td class='source'>          &quot;itineraries&quot; =&gt; [</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>21</td>
                        <td class='hits'></td>
                        <td class='source'>            %{</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>22</td>
                        <td class='hits'></td>
                        <td class='source'>              &quot;legs&quot; =&gt; [</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>23</td>
                        <td class='hits'></td>
                        <td class='source'>                %{</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>24</td>
                        <td class='hits'></td>
                        <td class='source'>                  &quot;distance&quot; =&gt; 4714.9,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>25</td>
                        <td class='hits'></td>
                        <td class='source'>                  &quot;instructions&quot; =&gt; [</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>26</td>
                        <td class='hits'></td>
                        <td class='source'>                    &quot;Head northeast on Reischplatz&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>27</td>
                        <td class='hits'></td>
                        <td class='source'>                    &quot;Turn right onto Deutzer Freiheit&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>28</td>
                        <td class='hits'></td>
                        <td class='source'>                    &quot;Turn left onto Graf-Geßler-Straße&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>29</td>
                        <td class='hits'></td>
                        <td class='source'>                    &quot;Make a sharp left onto Kasemattenstraße&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>30</td>
                        <td class='hits'></td>
                        <td class='source'>                    &quot;Turn right onto Neuhöfferstraße&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>31</td>
                        <td class='hits'></td>
                        <td class='source'>                    &quot;Turn left onto Siegesstraße&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>32</td>
                        <td class='hits'></td>
                        <td class='source'>                    &quot;Turn right onto Mindener Straße (L 111)&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>33</td>
                        <td class='hits'></td>
                        <td class='source'>                    &quot;Make a U-turn towards Zentrum&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>34</td>
                        <td class='hits'></td>
                        <td class='source'>                    &quot;Continue straight onto Deutzer Brücke (L 111)&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>35</td>
                        <td class='hits'></td>
                        <td class='source'>                    &quot;Continue straight towards Dom/Hbf&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>36</td>
                        <td class='hits'></td>
                        <td class='source'>                    &quot;Continue straight onto Augustinerstraße (L 111)&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>37</td>
                        <td class='hits'></td>
                        <td class='source'>                    &quot;Continue straight onto Pipinstraße (L 111)&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>38</td>
                        <td class='hits'></td>
                        <td class='source'>                    &quot;Continue straight onto Cäcilienstraße (L 111)&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>39</td>
                        <td class='hits'></td>
                        <td class='source'>                    &quot;Turn right onto Nord-Süd-Fahrt&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>40</td>
                        <td class='hits'></td>
                        <td class='source'>                    &quot;Continue straight onto Offenbachplatz&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>41</td>
                        <td class='hits'></td>
                        <td class='source'>                    &quot;Continue straight onto Tunisstraße&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>42</td>
                        <td class='hits'></td>
                        <td class='source'>                    &quot;Continue slightly left onto Tunisstraße&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>43</td>
                        <td class='hits'></td>
                        <td class='source'>                    &quot;Go straight onto Komödienstraße&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>44</td>
                        <td class='hits'></td>
                        <td class='source'>                    &quot;Continue straight onto Zeughausstraße&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>45</td>
                        <td class='hits'></td>
                        <td class='source'>                    &quot;Continue straight onto Magnusstraße&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>46</td>
                        <td class='hits'></td>
                        <td class='source'>                    &quot;Continue straight onto Friesenplatz (B 59)&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>47</td>
                        <td class='hits'></td>
                        <td class='source'>                    &quot;Continue straight onto Venloer Straße (B 59)&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>48</td>
                        <td class='hits'></td>
                        <td class='source'>                    &quot;Turn right onto Spichernstraße&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>49</td>
                        <td class='hits'></td>
                        <td class='source'>                    &quot;You have arrived at your destination&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>50</td>
                        <td class='hits'></td>
                        <td class='source'>                  ],</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>51</td>
                        <td class='hits'></td>
                        <td class='source'>                  &quot;mode&quot; =&gt; &quot;CAR&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>52</td>
                        <td class='hits'></td>
                        <td class='source'>                  &quot;route&quot; =&gt;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>53</td>
                        <td class='hits'></td>
                        <td class='source'>                    &quot;ao{uHeoqi@k@mAIOk@?MECi@gFi@FNBXATGRKLCFe@nAo@pAy@dBI@\\|ETtC@RD\\BXF~@NxAAXCJCDADMTQCOGOIMEMIKIWWUUUa@Y?CBEBEJ?HBPPXl@v@j@d@f@Vf@LRD\\D`DT`@HZJXRLLNNLTHTJXJj@D|@DbA@v@B|@H~Ez@|\\B|@@N?XDjAB`@B\\D`@PtANdAJj@FZ@JHn@@\\FzABn@DZHj@f@dDDTBRLl@Fj@Dp@Bb@?TB`@@VDh@Dj@BR@HBTD\\Dx@@h@@~@A|@?`@C`@Ef@Eh@MlAQX[f@}B`AmANm@LcAAk@GSEWGKEq@QaA]MGMEIAIEC?ECmAWGAOAO?E@q@DyAPA?oAJKKi@DwANa@DIBC?]JEDIDIRGLELERIZ?|@BzCBnB?t@Bj@FnABf@@LHdBFdBFt@Dn@Dp@J\\D\\?FD`@?XANAF?DAPA\\?R@^@VBXDTHZBJHZJXf@dATf@P^LZHXBJLv@Lz@VtBBb@@V@d@?bAGvA?LIv@Kt@WnAMl@Kj@Mn@KdAAd@AP?RALGzAAp@UdBEb@Kj@ANGTG^EHi@dAeAxBq@tA}AvDo@cA{@oAaDsEe@q@IM??s@oAyAoC&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>54</td>
                        <td class='hits'></td>
                        <td class='source'>                }</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>55</td>
                        <td class='hits'></td>
                        <td class='source'>              ]</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>56</td>
                        <td class='hits'></td>
                        <td class='source'>            }</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>57</td>
                        <td class='hits'></td>
                        <td class='source'>          ],</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>58</td>
                        <td class='hits'></td>
                        <td class='source'>          &quot;toPlace&quot; =&gt; %{</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>59</td>
                        <td class='hits'></td>
                        <td class='source'>            &quot;lat&quot; =&gt; &quot;50.944557395196654&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>60</td>
                        <td class='hits'></td>
                        <td class='source'>            &quot;lon&quot; =&gt; &quot;6.938767433166504&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>61</td>
                        <td class='hits'></td>
                        <td class='source'>            &quot;name&quot; =&gt; &quot;&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>62</td>
                        <td class='hits'></td>
                        <td class='source'>            &quot;orig&quot; =&gt; &quot;&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>63</td>
                        <td class='hits'></td>
                        <td class='source'>            &quot;vertexType&quot; =&gt; &quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>64</td>
                        <td class='hits'></td>
                        <td class='source'>          }</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>65</td>
                        <td class='hits'></td>
                        <td class='source'>        },</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>66</td>
                        <td class='hits'></td>
                        <td class='source'>        &quot;requestParameters&quot; =&gt; %{</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>67</td>
                        <td class='hits'></td>
                        <td class='source'>          &quot;arriveBy&quot; =&gt; false,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>68</td>
                        <td class='hits'></td>
                        <td class='source'>          &quot;fromPlace&quot; =&gt; &quot;50.93633658100821,6.976017951965332&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>69</td>
                        <td class='hits'></td>
                        <td class='source'>          &quot;maxWalkDistance&quot; =&gt; &quot;500&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>70</td>
                        <td class='hits'></td>
                        <td class='source'>          &quot;mode&quot; =&gt; &quot;CAR&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>71</td>
                        <td class='hits'></td>
                        <td class='source'>          &quot;time&quot; =&gt; &quot;11:04&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>72</td>
                        <td class='hits'></td>
                        <td class='source'>          &quot;toPlace&quot; =&gt; &quot;50.944557395196654,6.938767433166504&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>73</td>
                        <td class='hits'></td>
                        <td class='source'>          &quot;wheelchair&quot; =&gt; false</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>74</td>
                        <td class='hits'></td>
                        <td class='source'>        }</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>75</td>
                        <td class='hits'></td>
                        <td class='source'>      }</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>76</td>
                        <td class='hits'></td>
                        <td class='source'>    }</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>77</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>78</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>79</td>
                        <td class='hits'></td>
                        <td class='source'>  def get_reservation(_locator) do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>80</td>
                        <td class='hits'></td>
                        <td class='source'>    {:ok,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>81</td>
                        <td class='hits'></td>
                        <td class='source'>     %{</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>82</td>
                        <td class='hits'></td>
                        <td class='source'>       &quot;product&quot; =&gt; %{</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>83</td>
                        <td class='hits'></td>
                        <td class='source'>         &quot;barcode&quot; =&gt; &quot;some barcode&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>84</td>
                        <td class='hits'></td>
                        <td class='source'>         &quot;status&quot; =&gt; %{</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>85</td>
                        <td class='hits'></td>
                        <td class='source'>           &quot;presence_status&quot; =&gt; 1</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>86</td>
                        <td class='hits'></td>
                        <td class='source'>         }</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>87</td>
                        <td class='hits'></td>
                        <td class='source'>       },</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>88</td>
                        <td class='hits'></td>
                        <td class='source'>       &quot;locator&quot; =&gt; &quot;some locator&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>89</td>
                        <td class='hits'></td>
                        <td class='source'>     }}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>90</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>91</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>92</td>
                        <td class='hits'></td>
                        <td class='source'>  def make_reservation(_product_type) do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>93</td>
                        <td class='hits'></td>
                        <td class='source'>    {:ok,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>94</td>
                        <td class='hits'></td>
                        <td class='source'>     %{</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>95</td>
                        <td class='hits'></td>
                        <td class='source'>       &quot;product&quot; =&gt; %{</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>96</td>
                        <td class='hits'></td>
                        <td class='source'>         &quot;barcode&quot; =&gt; &quot;some barcode&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>97</td>
                        <td class='hits'></td>
                        <td class='source'>       },</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>98</td>
                        <td class='hits'></td>
                        <td class='source'>       &quot;locator&quot; =&gt; &quot;some locator&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>99</td>
                        <td class='hits'></td>
                        <td class='source'>     }}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>100</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>101</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>102</td>
                        <td class='hits'></td>
                        <td class='source'>  def cancel_reservation(_locator) do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>103</td>
                        <td class='hits'></td>
                        <td class='source'>    {:ok,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>104</td>
                        <td class='hits'></td>
                        <td class='source'>     %{</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>105</td>
                        <td class='hits'></td>
                        <td class='source'>       &quot;activation&quot; =&gt; &quot;2018-09-18T11:11:26.000&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>106</td>
                        <td class='hits'></td>
                        <td class='source'>       &quot;amount_paid&quot; =&gt; 0,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>107</td>
                        <td class='hits'></td>
                        <td class='source'>       &quot;attached_product_group&quot; =&gt; &quot;0&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>108</td>
                        <td class='hits'></td>
                        <td class='source'>       &quot;automatic_use_by_license_plate&quot; =&gt; true,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>109</td>
                        <td class='hits'></td>
                        <td class='source'>       &quot;available_balance&quot; =&gt; 0,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>110</td>
                        <td class='hits'></td>
                        <td class='source'>       &quot;cancelled&quot; =&gt; true,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>111</td>
                        <td class='hits'></td>
                        <td class='source'>       &quot;created&quot; =&gt; &quot;2018-09-18T11:11:26.833&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>112</td>
                        <td class='hits'></td>
                        <td class='source'>       &quot;email&quot; =&gt; &quot;&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>113</td>
                        <td class='hits'></td>
                        <td class='source'>       &quot;expiry&quot; =&gt; &quot;2018-09-18T11:12:26.000&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>114</td>
                        <td class='hits'></td>
                        <td class='source'>       &quot;holder_name&quot; =&gt; &quot;&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>115</td>
                        <td class='hits'></td>
                        <td class='source'>       &quot;license_plate&quot; =&gt; &quot;&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>116</td>
                        <td class='hits'></td>
                        <td class='source'>       &quot;locator&quot; =&gt; &quot;WW9E60449&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>117</td>
                        <td class='hits'></td>
                        <td class='source'>       &quot;phone_number&quot; =&gt; &quot;&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>118</td>
                        <td class='hits'></td>
                        <td class='source'>       &quot;product&quot; =&gt; %{</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>119</td>
                        <td class='hits'></td>
                        <td class='source'>         &quot;barcode&quot; =&gt; &quot;Q1730463835940490021679061827538105&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>120</td>
                        <td class='hits'></td>
                        <td class='source'>         &quot;description&quot; =&gt; &quot;&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>121</td>
                        <td class='hits'></td>
                        <td class='source'>         &quot;door_pinpad_key&quot; =&gt; &quot;47133&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>122</td>
                        <td class='hits'></td>
                        <td class='source'>         &quot;first_use&quot; =&gt; nil,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>123</td>
                        <td class='hits'></td>
                        <td class='source'>         &quot;id&quot; =&gt; &quot;0111000000409&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>124</td>
                        <td class='hits'></td>
                        <td class='source'>         &quot;last_use&quot; =&gt; nil,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>125</td>
                        <td class='hits'></td>
                        <td class='source'>         &quot;media_type&quot; =&gt; 65,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>126</td>
                        <td class='hits'></td>
                        <td class='source'>         &quot;number&quot; =&gt; &quot;11000000409&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>127</td>
                        <td class='hits'></td>
                        <td class='source'>         &quot;status&quot; =&gt; %{&quot;presence_status&quot; =&gt; nil}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>128</td>
                        <td class='hits'></td>
                        <td class='source'>       },</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>129</td>
                        <td class='hits'></td>
                        <td class='source'>       &quot;product_type&quot; =&gt; &quot;1&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>130</td>
                        <td class='hits'></td>
                        <td class='source'>       &quot;reference_id&quot; =&gt; &quot;127.0.0.1&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>131</td>
                        <td class='hits'></td>
                        <td class='source'>       &quot;remarks&quot; =&gt; &quot;Localizador: WW9E60449&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>132</td>
                        <td class='hits'></td>
                        <td class='source'>     }}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>133</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>134</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>135</td>
                        <td class='hits'></td>
                        <td class='source'>  def delete_reservation(_locator) do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>136</td>
                        <td class='hits'></td>
                        <td class='source'>    {:ok, nil}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>137</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>138</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>139</td>
                        <td class='hits'></td>
                        <td class='source'>  def payment1(_barcode) do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>140</td>
                        <td class='hits'></td>
                        <td class='source'>    {:ok,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>141</td>
                        <td class='hits'></td>
                        <td class='source'>     %{</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>142</td>
                        <td class='hits'></td>
                        <td class='source'>       &quot;context_token&quot; =&gt; &quot;some context token&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>143</td>
                        <td class='hits'></td>
                        <td class='source'>       &quot;parking_start_time&quot; =&gt; DateTime.utc_now(),</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>144</td>
                        <td class='hits'></td>
                        <td class='source'>       &quot;outstanding_amount&quot; =&gt; &quot;10.00&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>145</td>
                        <td class='hits'></td>
                        <td class='source'>     }}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>146</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>147</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>148</td>
                        <td class='hits'></td>
                        <td class='source'>  def payment2(_context_token) do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>149</td>
                        <td class='hits'></td>
                        <td class='source'>    :ok</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>150</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>151</td>
                        <td class='hits'></td>
                        <td class='source'>end</td>
                      </tr>
                  
                
              </tbody>
            </table>
          </div>
        
          <div class='file'>
            <h2 id='lib/parkapp_web/api_integration/gen_servers/reservation_state.ex'>lib/parkapp_web/api_integration/gen_servers/reservation_state.ex</h1>
            <div id='stats' class='terrible'>
              <div class='percentage'>0</div>
              <div class='sloc'>0</div>
              <div class='hits'>0</div>
              <div class='misses'>0</div>
            </div>
            <table id='source'>
              <thead>
                <tr>
                  <th>Line</th>
                  <th>Hits</th>
                  <th>Source</th>
                </tr>
              <tbody>
                
                  
                      <tr>
                        <td class='line'>0</td>
                        <td class='hits'></td>
                        <td class='source'>defmodule ParkappWeb.ApiIntegration.GenServers.ReservationState do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>1</td>
                        <td class='hits'></td>
                        <td class='source'>  defstruct reservation_id: nil,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>2</td>
                        <td class='hits'></td>
                        <td class='source'>            websocket: nil,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>3</td>
                        <td class='hits'></td>
                        <td class='source'>            schedule_interval: 1000</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>4</td>
                        <td class='hits'></td>
                        <td class='source'>end</td>
                      </tr>
                  
                
              </tbody>
            </table>
          </div>
        
          <div class='file'>
            <h2 id='lib/parkapp_web/api_integration/gen_servers/reservation_to_inpark.ex'>lib/parkapp_web/api_integration/gen_servers/reservation_to_inpark.ex</h1>
            <div id='stats' class='low'>
              <div class='percentage'>34.5</div>
              <div class='sloc'>29</div>
              <div class='hits'>12</div>
              <div class='misses'>19</div>
            </div>
            <table id='source'>
              <thead>
                <tr>
                  <th>Line</th>
                  <th>Hits</th>
                  <th>Source</th>
                </tr>
              <tbody>
                
                  
                      <tr>
                        <td class='line'>0</td>
                        <td class='hits'></td>
                        <td class='source'>defmodule ParkappWeb.ApiIntegration.GenServers.ReservationToInPark do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>1</td>
                        <td class='hits'></td>
                        <td class='source'>  @moduledoc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>2</td>
                        <td class='hits'></td>
                        <td class='source'>    This module handles the reservation state changes from Open to InPark</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>3</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>4</td>
                        <td class='hits'></td>
                        <td class='source'>  use GenServer</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>5</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>6</td>
                        <td class='hits'></td>
                        <td class='source'>  import Phoenix.Channel</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>7</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>8</td>
                        <td class='hits'></td>
                        <td class='source'>  alias ParkappWeb.ApiIntegration.GenServers.ReservationState</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>9</td>
                        <td class='hits'></td>
                        <td class='source'>  alias ParkappWeb.ApiIntegration.Embers.Helpers</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>10</td>
                        <td class='hits'></td>
                        <td class='source'>  alias Parkapp.ReservationsContext</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>11</td>
                        <td class='hits'></td>
                        <td class='source'>  alias Parkapp.Reservations.ReservationStatus.Enum, as: ReservationStatusEnum</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>12</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>13</td>
                        <td class='hits'></td>
                        <td class='source'>  @inpark 2</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>14</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>15</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>16</td>
                        <td class='hits'></td>
                        <td class='source'>    Start the gen server</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>17</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>18</td>
                        <td class='hits'></td>
                        <td class='source'>  def start_link({:name, name} = otp_opts) do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>19</td>
                        <td class='hits'>2</td>
                        <td class='source'>    IO.inspect(otp_opts, label: &quot;skajdbnsjk&quot;)</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>20</td>
                        <td class='hits'>2</td>
                        <td class='source'>    GenServer.start_link(__MODULE__, %ReservationState{}, name: name)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>21</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>22</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>23</td>
                        <td class='hits'></td>
                        <td class='source'>  def init(args) do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>24</td>
                        <td class='hits'></td>
                        <td class='source'>    {:ok, args}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>25</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>26</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>27</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>28</td>
                        <td class='hits'></td>
                        <td class='source'>  Stop the gen server</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>29</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>30</td>
                        <td class='hits'></td>
                        <td class='source'>  def stop(pid) do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>31</td>
                        <td class='hits'></td>
                        <td class='source'>    Process.whereis(pid)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>32</td>
                        <td class='hits'></td>
                        <td class='source'>    |&gt; IO.inspect(label: &quot;slkdnsljdj&quot;)</td>
                      </tr>
                  
                
                  
                      <tr class='miss'>
                        <td class='line'>33</td>
                        <td class='hits'>0</td>
                        <td class='source'>    |&gt; case do</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>34</td>
                        <td class='hits'></td>
                        <td class='source'>      nil -&gt;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>35</td>
                        <td class='hits'></td>
                        <td class='source'>        :noop</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>36</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>37</td>
                        <td class='hits'></td>
                        <td class='source'>      _pid_or_port -&gt;</td>
                      </tr>
                  
                
                  
                      <tr class='miss'>
                        <td class='line'>38</td>
                        <td class='hits'>0</td>
                        <td class='source'>        GenServer.stop(pid, {:shutdown, &quot;Stopping the ReservationToInPark&quot;})</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>39</td>
                        <td class='hits'></td>
                        <td class='source'>    end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>40</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>41</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>42</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>43</td>
                        <td class='hits'></td>
                        <td class='source'>  Starts the recurrent calls to check if a user is in park</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>44</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>45</td>
                        <td class='hits'></td>
                        <td class='source'>  def init(pid, websocket, reservation_id) do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>46</td>
                        <td class='hits'>1</td>
                        <td class='source'>    GenServer.call(pid, {:init, websocket, reservation_id})</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>47</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>48</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>49</td>
                        <td class='hits'></td>
                        <td class='source'>  def handle_call({:init, websocket, reservation_id}, _from, _state) do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>50</td>
                        <td class='hits'>1</td>
                        <td class='source'>    schedule_interval =</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>51</td>
                        <td class='hits'></td>
                        <td class='source'>      Application.get_env(:parkapp, :reservations_gen_server, [])</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>52</td>
                        <td class='hits'></td>
                        <td class='source'>      |&gt; Enum.into(%{})</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>53</td>
                        <td class='hits'></td>
                        <td class='source'>      |&gt; Map.get(:schedule_interval)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>54</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>55</td>
                        <td class='hits'></td>
                        <td class='source'>    # start the recurring function calls</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>56</td>
                        <td class='hits'>1</td>
                        <td class='source'>    schedule(schedule_interval)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>57</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>58</td>
                        <td class='hits'></td>
                        <td class='source'>    # init the state</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>59</td>
                        <td class='hits'>1</td>
                        <td class='source'>    state = %ReservationState{</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>60</td>
                        <td class='hits'></td>
                        <td class='source'>      schedule_interval: schedule_interval,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>61</td>
                        <td class='hits'></td>
                        <td class='source'>      reservation_id: reservation_id,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>62</td>
                        <td class='hits'></td>
                        <td class='source'>      websocket: websocket</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>63</td>
                        <td class='hits'></td>
                        <td class='source'>    }</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>64</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>65</td>
                        <td class='hits'>1</td>
                        <td class='source'>    {:reply, state, state}</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>66</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>67</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>68</td>
                        <td class='hits'></td>
                        <td class='source'>  def handle_info(</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>69</td>
                        <td class='hits'></td>
                        <td class='source'>        :check_in_park,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>70</td>
                        <td class='hits'></td>
                        <td class='source'>        %ReservationState{</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>71</td>
                        <td class='hits'></td>
                        <td class='source'>          reservation_id: reservation_id,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>72</td>
                        <td class='hits'></td>
                        <td class='source'>          websocket: websocket,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>73</td>
                        <td class='hits'></td>
                        <td class='source'>          schedule_interval: schedule_interval</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>74</td>
                        <td class='hits'></td>
                        <td class='source'>        } = state</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>75</td>
                        <td class='hits'></td>
                        <td class='source'>      ) do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>76</td>
                        <td class='hits'>1</td>
                        <td class='source'>    gen_server_id = String.to_atom(&quot;#{reservation_id}&quot;)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>77</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr class='miss'>
                        <td class='line'>78</td>
                        <td class='hits'>0</td>
                        <td class='source'>    with(</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>79</td>
                        <td class='hits'>1</td>
                        <td class='source'>      reservation &lt;- ReservationsContext.get_reservation!(reservation_id),</td>
                      </tr>
                    
                
                  
                      <tr class='miss'>
                        <td class='line'>80</td>
                        <td class='hits'>0</td>
                        <td class='source'>      true &lt;- reservation.reservation_status_id == ReservationStatusEnum.open()</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>81</td>
                        <td class='hits'></td>
                        <td class='source'>    ) do</td>
                      </tr>
                  
                
                  
                      <tr class='miss'>
                        <td class='line'>82</td>
                        <td class='hits'>0</td>
                        <td class='source'>      with(</td>
                      </tr>
                    
                
                  
                      <tr class='miss'>
                        <td class='line'>83</td>
                        <td class='hits'>0</td>
                        <td class='source'>        true &lt;- check_in_park(reservation),</td>
                      </tr>
                    
                
                  
                      <tr class='miss'>
                        <td class='line'>84</td>
                        <td class='hits'>0</td>
                        <td class='source'>        {:ok, %{&quot;parking_start_time&quot; =&gt; parking_start_time, &quot;outstanding_amount&quot; =&gt; amount}} =</td>
                      </tr>
                    
                
                  
                      <tr class='miss'>
                        <td class='line'>85</td>
                        <td class='hits'>0</td>
                        <td class='source'>          Helpers.get_api_module().payment1(reservation.barcode),</td>
                      </tr>
                    
                
                  
                      <tr class='miss'>
                        <td class='line'>86</td>
                        <td class='hits'>0</td>
                        <td class='source'>        {:ok, reservation} &lt;-</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>87</td>
                        <td class='hits'></td>
                        <td class='source'>          ReservationsContext.move_to_in_park_state(reservation, parking_start_time)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>88</td>
                        <td class='hits'></td>
                        <td class='source'>      ) do</td>
                      </tr>
                  
                
                  
                      <tr class='miss'>
                        <td class='line'>89</td>
                        <td class='hits'>0</td>
                        <td class='source'>        broadcast!(websocket, &quot;in_park&quot;, %{</td>
                      </tr>
                    
                
                  
                      <tr class='miss'>
                        <td class='line'>90</td>
                        <td class='hits'>0</td>
                        <td class='source'>          start_date: reservation.parking_start_date,</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>91</td>
                        <td class='hits'></td>
                        <td class='source'>          amount: amount</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>92</td>
                        <td class='hits'></td>
                        <td class='source'>        })</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>93</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr class='miss'>
                        <td class='line'>94</td>
                        <td class='hits'>0</td>
                        <td class='source'>        stop(gen_server_id)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>95</td>
                        <td class='hits'></td>
                        <td class='source'>      else</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>96</td>
                        <td class='hits'></td>
                        <td class='source'>        _ -&gt;</td>
                      </tr>
                  
                
                  
                      <tr class='miss'>
                        <td class='line'>97</td>
                        <td class='hits'>0</td>
                        <td class='source'>          schedule(schedule_interval)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>98</td>
                        <td class='hits'></td>
                        <td class='source'>      end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>99</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>100</td>
                        <td class='hits'></td>
                        <td class='source'>      {:noreply, state}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>101</td>
                        <td class='hits'></td>
                        <td class='source'>    else</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>102</td>
                        <td class='hits'></td>
                        <td class='source'>      _ -&gt;</td>
                      </tr>
                  
                
                  
                      <tr class='miss'>
                        <td class='line'>103</td>
                        <td class='hits'>0</td>
                        <td class='source'>        stop(gen_server_id)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>104</td>
                        <td class='hits'></td>
                        <td class='source'>    end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>105</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>106</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>107</td>
                        <td class='hits'></td>
                        <td class='source'>  defp schedule(schedule_interval) do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>108</td>
                        <td class='hits'>1</td>
                        <td class='source'>    Process.send_after(self(), :check_in_park, schedule_interval)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>109</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>110</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>111</td>
                        <td class='hits'></td>
                        <td class='source'>  defp check_in_park(reservation) do</td>
                      </tr>
                  
                
                  
                      <tr class='miss'>
                        <td class='line'>112</td>
                        <td class='hits'>0</td>
                        <td class='source'>    with(</td>
                      </tr>
                    
                
                  
                      <tr class='miss'>
                        <td class='line'>113</td>
                        <td class='hits'>0</td>
                        <td class='source'>      {:ok, %{&quot;reservations&quot; =&gt; reservations}} &lt;-</td>
                      </tr>
                    
                
                  
                      <tr class='miss'>
                        <td class='line'>114</td>
                        <td class='hits'>0</td>
                        <td class='source'>        Helpers.get_api_module().get_reservation(reservation.locator),</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>115</td>
                        <td class='hits'></td>
                        <td class='source'>      %{</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>116</td>
                        <td class='hits'></td>
                        <td class='source'>        &quot;product&quot; =&gt; %{</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>117</td>
                        <td class='hits'></td>
                        <td class='source'>          &quot;status&quot; =&gt; %{</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>118</td>
                        <td class='hits'></td>
                        <td class='source'>            &quot;presence_status&quot; =&gt; presence_status</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>119</td>
                        <td class='hits'></td>
                        <td class='source'>          }</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>120</td>
                        <td class='hits'></td>
                        <td class='source'>        }</td>
                      </tr>
                  
                
                  
                      <tr class='miss'>
                        <td class='line'>121</td>
                        <td class='hits'>0</td>
                        <td class='source'>      } &lt;- List.first(reservations),</td>
                      </tr>
                    
                
                  
                      <tr class='miss'>
                        <td class='line'>122</td>
                        <td class='hits'>0</td>
                        <td class='source'>      true &lt;- presence_status == @inpark</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>123</td>
                        <td class='hits'></td>
                        <td class='source'>    ) do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>124</td>
                        <td class='hits'></td>
                        <td class='source'>      true</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>125</td>
                        <td class='hits'></td>
                        <td class='source'>    else</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>126</td>
                        <td class='hits'></td>
                        <td class='source'>      _ -&gt;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>127</td>
                        <td class='hits'></td>
                        <td class='source'>        false</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>128</td>
                        <td class='hits'></td>
                        <td class='source'>    end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>129</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>130</td>
                        <td class='hits'></td>
                        <td class='source'>end</td>
                      </tr>
                  
                
              </tbody>
            </table>
          </div>
        
          <div class='file'>
            <h2 id='lib/parkapp_web/api_integration/helpers.ex'>lib/parkapp_web/api_integration/helpers.ex</h1>
            <div id='stats' class='high'>
              <div class='percentage'>100</div>
              <div class='sloc'>3</div>
              <div class='hits'>48</div>
              <div class='misses'>0</div>
            </div>
            <table id='source'>
              <thead>
                <tr>
                  <th>Line</th>
                  <th>Hits</th>
                  <th>Source</th>
                </tr>
              <tbody>
                
                  
                      <tr>
                        <td class='line'>0</td>
                        <td class='hits'></td>
                        <td class='source'>defmodule ParkappWeb.ApiIntegration.Helpers do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>1</td>
                        <td class='hits'></td>
                        <td class='source'>  @moduledoc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>2</td>
                        <td class='hits'></td>
                        <td class='source'>    Helpers that support the API integrations</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>3</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>4</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>5</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>6</td>
                        <td class='hits'></td>
                        <td class='source'>    Decodes the body from json. Returns default if something goes wrong</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>7</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>8</td>
                        <td class='hits'></td>
                        <td class='source'>  @spec get_json(String, Any) :: Map | Any</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>9</td>
                        <td class='hits'></td>
                        <td class='source'>  def get_json(body, default \\ nil) do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>10</td>
                        <td class='hits'>24</td>
                        <td class='source'>    with({:ok, result} &lt;- Poison.decode(body)) do</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>11</td>
                        <td class='hits'>23</td>
                        <td class='source'>      result</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>12</td>
                        <td class='hits'></td>
                        <td class='source'>    else</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>13</td>
                        <td class='hits'>1</td>
                        <td class='source'>      _ -&gt; default</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>14</td>
                        <td class='hits'></td>
                        <td class='source'>    end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>15</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>16</td>
                        <td class='hits'></td>
                        <td class='source'>end</td>
                      </tr>
                  
                
              </tbody>
            </table>
          </div>
        
          <div class='file'>
            <h2 id='lib/parkapp_web/api_integration/mb_way/api.ex'>lib/parkapp_web/api_integration/mb_way/api.ex</h1>
            <div id='stats' class='high'>
              <div class='percentage'>100</div>
              <div class='sloc'>3</div>
              <div class='hits'>24</div>
              <div class='misses'>0</div>
            </div>
            <table id='source'>
              <thead>
                <tr>
                  <th>Line</th>
                  <th>Hits</th>
                  <th>Source</th>
                </tr>
              <tbody>
                
                  
                      <tr>
                        <td class='line'>0</td>
                        <td class='hits'></td>
                        <td class='source'>defmodule ParkappWeb.ApiIntegration.MBWay.API do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>1</td>
                        <td class='hits'></td>
                        <td class='source'>  @moduledoc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>2</td>
                        <td class='hits'></td>
                        <td class='source'>    Main implementation of the MBWay API.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>3</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>4</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>5</td>
                        <td class='hits'></td>
                        <td class='source'>  @behaviour ParkappWeb.ApiIntegration.MBWay.Behaviour</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>6</td>
                        <td class='hits'></td>
                        <td class='source'>  import ParkappWeb.ApiIntegration.MBWay.Helpers</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>7</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>8</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>9</td>
                        <td class='hits'></td>
                        <td class='source'>    Makes a post request to the SIBS API to perform an MBWay one-shot payment</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>10</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>11</td>
                        <td class='hits'></td>
                        <td class='source'>  def request_payment(user_token, phone_number, amount) do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>12</td>
                        <td class='hits'>8</td>
                        <td class='source'>    {domain, user_id, entity_id, password, payment_brand, currency, payment_type} = get_config()</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>13</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>14</td>
                        <td class='hits'>8</td>
                        <td class='source'>    url = &quot;#{domain}/payments&quot;</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>15</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>16</td>
                        <td class='hits'></td>
                        <td class='source'>    HTTPoison.post(</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>17</td>
                        <td class='hits'></td>
                        <td class='source'>      url,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>18</td>
                        <td class='hits'></td>
                        <td class='source'>      {:form,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>19</td>
                        <td class='hits'></td>
                        <td class='source'>       [</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>20</td>
                        <td class='hits'></td>
                        <td class='source'>         &quot;authentication.userId&quot;: user_id,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>21</td>
                        <td class='hits'></td>
                        <td class='source'>         &quot;authentication.entityId&quot;: entity_id,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>22</td>
                        <td class='hits'></td>
                        <td class='source'>         &quot;authentication.password&quot;: password,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>23</td>
                        <td class='hits'></td>
                        <td class='source'>         currency: currency,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>24</td>
                        <td class='hits'></td>
                        <td class='source'>         paymentType: payment_type,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>25</td>
                        <td class='hits'></td>
                        <td class='source'>         paymentBrand: payment_brand,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>26</td>
                        <td class='hits'></td>
                        <td class='source'>         amount: amount,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>27</td>
                        <td class='hits'></td>
                        <td class='source'>         &quot;virtualAccount.accountId&quot;: phone_number,#need to validate? mbway accepts anything here because it is not used right away.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>28</td>
                        <td class='hits'></td>
                        <td class='source'>         merchantTransactionId: user_token,#Device_id or Reservation_id or locator?</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>29</td>
                        <td class='hits'></td>
                        <td class='source'>         # Merchant-provided reference number, should be unique for your transactions. Some receivers require this ID. This identifier is often used for reconciliation.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>30</td>
                        <td class='hits'></td>
                        <td class='source'>         descriptor: &quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>31</td>
                        <td class='hits'></td>
                        <td class='source'>       ]}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>32</td>
                        <td class='hits'></td>
                        <td class='source'>    )</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>33</td>
                        <td class='hits'>8</td>
                        <td class='source'>    |&gt; handle_http_response()</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>34</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>35</td>
                        <td class='hits'></td>
                        <td class='source'>end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>36</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>37</td>
                        <td class='hits'></td>
                        <td class='source'># Para poderem simular os pagamentos mbway podem usar</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>38</td>
                        <td class='hits'></td>
                        <td class='source'>#</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>39</td>
                        <td class='hits'></td>
                        <td class='source'># POST para https://test.onlinepayments.pt/v1/payments com</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>40</td>
                        <td class='hits'></td>
                        <td class='source'>#</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>41</td>
                        <td class='hits'></td>
                        <td class='source'># authentication.userId=8a8294185b674555015b7c1928e81736</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>42</td>
                        <td class='hits'></td>
                        <td class='source'># authentication.entityId=8a8294185bd901c5015be855fd5f1578</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>43</td>
                        <td class='hits'></td>
                        <td class='source'># authentication.password=Rr47eQesdW</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>44</td>
                        <td class='hits'></td>
                        <td class='source'># amount=10.00</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>45</td>
                        <td class='hits'></td>
                        <td class='source'># currency=EUR</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>46</td>
                        <td class='hits'></td>
                        <td class='source'># paymentType=DB</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>47</td>
                        <td class='hits'></td>
                        <td class='source'># paymentBrand=MBWAY</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>48</td>
                        <td class='hits'></td>
                        <td class='source'># virtualAccount.accountId=351#911222111</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>49</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>50</td>
                        <td class='hits'></td>
                        <td class='source'>#webhook should be like this:</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>51</td>
                        <td class='hits'></td>
                        <td class='source'># %{</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>52</td>
                        <td class='hits'></td>
                        <td class='source'>#   &quot;type&quot; =&gt; &quot;PAYMENT&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>53</td>
                        <td class='hits'></td>
                        <td class='source'>#   &quot;action&quot; =&gt; &quot;CREATED&quot; or &quot;UPDATED&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>54</td>
                        <td class='hits'></td>
                        <td class='source'>#   &quot;payload&quot; =&gt; %{</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>55</td>
                        <td class='hits'></td>
                        <td class='source'>#     &quot;referencedId&quot;, &quot;paymentBrand&quot;, &quot;amount&quot;, &quot;currency&quot;, &quot;descriptor&quot;, &quot;result.code&quot;, &quot;result.description&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>56</td>
                        <td class='hits'></td>
                        <td class='source'>#   }</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>57</td>
                        <td class='hits'></td>
                        <td class='source'># }</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>58</td>
                        <td class='hits'></td>
                        <td class='source'>#{&quot;encryptedBody&quot;:&quot;[(encrypted) hexadecimal string]&quot;}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>59</td>
                        <td class='hits'></td>
                        <td class='source'>#check crypto function</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>60</td>
                        <td class='hits'></td>
                        <td class='source'># {</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>61</td>
                        <td class='hits'></td>
                        <td class='source'>#    &quot;type&quot;:&quot;PAYMENT&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>62</td>
                        <td class='hits'></td>
                        <td class='source'>#    &quot;payload&quot;:{</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>63</td>
                        <td class='hits'></td>
                        <td class='source'>#       &quot;id&quot;:&quot;8a829449515d198b01517d5601df5584&quot;,#gravar nos logs</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>64</td>
                        <td class='hits'></td>
                        <td class='source'>#       &quot;paymentType&quot;:&quot;PA&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>65</td>
                        <td class='hits'></td>
                        <td class='source'>#       &quot;paymentBrand&quot;:&quot;VISA&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>66</td>
                        <td class='hits'></td>
                        <td class='source'>#       &quot;amount&quot;:&quot;92.00&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>67</td>
                        <td class='hits'></td>
                        <td class='source'>#       &quot;currency&quot;:&quot;EUR&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>68</td>
                        <td class='hits'></td>
                        <td class='source'>#       &quot;presentationAmount&quot;:&quot;92.00&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>69</td>
                        <td class='hits'></td>
                        <td class='source'>#       &quot;presentationCurrency&quot;:&quot;EUR&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>70</td>
                        <td class='hits'></td>
                        <td class='source'>#       &quot;descriptor&quot;:&quot;3017.7139.1650 OPP_Channel &quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>71</td>
                        <td class='hits'></td>
                        <td class='source'>#       &quot;result&quot;:{</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>72</td>
                        <td class='hits'></td>
                        <td class='source'>#          &quot;code&quot;:&quot;000.100.110&quot;,#que codes devemos suportar?</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>73</td>
                        <td class='hits'></td>
                        <td class='source'>#          &quot;description&quot;:&quot;Request successfully processed in &#39;Merchant in Integrator Test Mode&#39;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>74</td>
                        <td class='hits'></td>
                        <td class='source'>#       },</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>75</td>
                        <td class='hits'></td>
                        <td class='source'>#       &quot;authentication&quot;:{</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>76</td>
                        <td class='hits'></td>
                        <td class='source'>#          &quot;entityId&quot;:&quot;8a8294185282b95b01528382b4940245&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>77</td>
                        <td class='hits'></td>
                        <td class='source'>#       },</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>78</td>
                        <td class='hits'></td>
                        <td class='source'>#       &quot;card&quot;:{</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>79</td>
                        <td class='hits'></td>
                        <td class='source'>#          &quot;bin&quot;:&quot;420000&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>80</td>
                        <td class='hits'></td>
                        <td class='source'>#          &quot;last4Digits&quot;:&quot;0000&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>81</td>
                        <td class='hits'></td>
                        <td class='source'>#          &quot;holder&quot;:&quot;Jane Jones&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>82</td>
                        <td class='hits'></td>
                        <td class='source'>#          &quot;expiryMonth&quot;:&quot;05&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>83</td>
                        <td class='hits'></td>
                        <td class='source'>#          &quot;expiryYear&quot;:&quot;2018&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>84</td>
                        <td class='hits'></td>
                        <td class='source'>#       },</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>85</td>
                        <td class='hits'></td>
                        <td class='source'>#       &quot;customer&quot;:{</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>86</td>
                        <td class='hits'></td>
                        <td class='source'>#          &quot;givenName&quot;:&quot;Jones&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>87</td>
                        <td class='hits'></td>
                        <td class='source'>#          &quot;surname&quot;:&quot;Jane&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>88</td>
                        <td class='hits'></td>
                        <td class='source'>#          &quot;merchantCustomerId&quot;:&quot;jjones&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>89</td>
                        <td class='hits'></td>
                        <td class='source'>#          &quot;sex&quot;:&quot;F&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>90</td>
                        <td class='hits'></td>
                        <td class='source'>#          &quot;email&quot;:&quot;jane@jones.com&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>91</td>
                        <td class='hits'></td>
                        <td class='source'>#       },</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>92</td>
                        <td class='hits'></td>
                        <td class='source'>#       &quot;customParameters&quot;:{</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>93</td>
                        <td class='hits'></td>
                        <td class='source'>#          &quot;SHOPPER_promoCode&quot;:&quot;AT052&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>94</td>
                        <td class='hits'></td>
                        <td class='source'>#       },</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>95</td>
                        <td class='hits'></td>
                        <td class='source'>#       &quot;risk&quot;:{</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>96</td>
                        <td class='hits'></td>
                        <td class='source'>#          &quot;score&quot;:&quot;0&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>97</td>
                        <td class='hits'></td>
                        <td class='source'>#       },</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>98</td>
                        <td class='hits'></td>
                        <td class='source'>#       &quot;buildNumber&quot;:&quot;ec3c704170e54f6d7cf86c6f1969b20f6d855ce5@2015-12-01 12:20:39 +0000&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>99</td>
                        <td class='hits'></td>
                        <td class='source'>#       &quot;timestamp&quot;:&quot;2015-12-07 16:46:07+0000&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>100</td>
                        <td class='hits'></td>
                        <td class='source'>#       &quot;ndc&quot;:&quot;8a8294174b7ecb28014b9699220015ca_66b12f658442479c8ca66166c4999e78&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>101</td>
                        <td class='hits'></td>
                        <td class='source'>#    }</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>102</td>
                        <td class='hits'></td>
                        <td class='source'># }</td>
                      </tr>
                  
                
              </tbody>
            </table>
          </div>
        
          <div class='file'>
            <h2 id='lib/parkapp_web/api_integration/mb_way/behaviour.ex'>lib/parkapp_web/api_integration/mb_way/behaviour.ex</h1>
            <div id='stats' class='terrible'>
              <div class='percentage'>0</div>
              <div class='sloc'>0</div>
              <div class='hits'>0</div>
              <div class='misses'>0</div>
            </div>
            <table id='source'>
              <thead>
                <tr>
                  <th>Line</th>
                  <th>Hits</th>
                  <th>Source</th>
                </tr>
              <tbody>
                
                  
                      <tr>
                        <td class='line'>0</td>
                        <td class='hits'></td>
                        <td class='source'>defmodule ParkappWeb.ApiIntegration.MBWay.Behaviour do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>1</td>
                        <td class='hits'></td>
                        <td class='source'>  @moduledoc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>2</td>
                        <td class='hits'></td>
                        <td class='source'>    Defines the interface for every implementation of MBWay API</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>3</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>4</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>5</td>
                        <td class='hits'></td>
                        <td class='source'>  @callback request_payment(String, String, String) :: :ok | :error</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>6</td>
                        <td class='hits'></td>
                        <td class='source'>end</td>
                      </tr>
                  
                
              </tbody>
            </table>
          </div>
        
          <div class='file'>
            <h2 id='lib/parkapp_web/api_integration/mb_way/helpers.ex'>lib/parkapp_web/api_integration/mb_way/helpers.ex</h1>
            <div id='stats' class='high'>
              <div class='percentage'>80</div>
              <div class='sloc'>20</div>
              <div class='hits'>124</div>
              <div class='misses'>4</div>
            </div>
            <table id='source'>
              <thead>
                <tr>
                  <th>Line</th>
                  <th>Hits</th>
                  <th>Source</th>
                </tr>
              <tbody>
                
                  
                      <tr>
                        <td class='line'>0</td>
                        <td class='hits'></td>
                        <td class='source'>defmodule ParkappWeb.ApiIntegration.MBWay.Helpers do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>1</td>
                        <td class='hits'></td>
                        <td class='source'>  @moduledoc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>2</td>
                        <td class='hits'></td>
                        <td class='source'>    Helpers that support the MBWay API integration</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>3</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>4</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>5</td>
                        <td class='hits'></td>
                        <td class='source'>  import ParkappWeb.ApiIntegration.Helpers</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>6</td>
                        <td class='hits'></td>
                        <td class='source'>  require Logger</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>7</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>8</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>9</td>
                        <td class='hits'></td>
                        <td class='source'>    Returns the correct module to use to call the MBway API</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>10</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>11</td>
                        <td class='hits'></td>
                        <td class='source'>  def get_api_module() do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>12</td>
                        <td class='hits'></td>
                        <td class='source'>    Application.get_env(:parkapp, :mb_way_api, [])</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>13</td>
                        <td class='hits'></td>
                        <td class='source'>    |&gt; Enum.into(%{})</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>14</td>
                        <td class='hits'>9</td>
                        <td class='source'>    |&gt; Map.get(:module)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>15</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>16</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>17</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>18</td>
                        <td class='hits'></td>
                        <td class='source'>    Returns the configuration for correcly calling the MBway API</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>19</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>20</td>
                        <td class='hits'></td>
                        <td class='source'>  def get_config() do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>21</td>
                        <td class='hits'>8</td>
                        <td class='source'>    config =</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>22</td>
                        <td class='hits'></td>
                        <td class='source'>      Application.get_env(:parkapp, :mb_way_api, [])</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>23</td>
                        <td class='hits'></td>
                        <td class='source'>      |&gt; Enum.into(%{})</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>24</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>25</td>
                        <td class='hits'>8</td>
                        <td class='source'>    domain = Map.get(config, :domain, &quot;&quot;)</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>26</td>
                        <td class='hits'>8</td>
                        <td class='source'>    user_id = Map.get(config, :user_id, &quot;&quot;)</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>27</td>
                        <td class='hits'>8</td>
                        <td class='source'>    entity_id = Map.get(config, :entity_id, &quot;&quot;)</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>28</td>
                        <td class='hits'>8</td>
                        <td class='source'>    password = Map.get(config, :password, &quot;&quot;)</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>29</td>
                        <td class='hits'>8</td>
                        <td class='source'>    payment_brand = Map.get(config, :payment_brand, &quot;&quot;)</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>30</td>
                        <td class='hits'>8</td>
                        <td class='source'>    currency = Map.get(config, :currency, &quot;&quot;)</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>31</td>
                        <td class='hits'>8</td>
                        <td class='source'>    payment_type = Map.get(config, :payment_type, &quot;&quot;)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>32</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>33</td>
                        <td class='hits'>8</td>
                        <td class='source'>    {domain, user_id, entity_id, password, payment_brand, currency, payment_type}</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>34</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>35</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>36</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>37</td>
                        <td class='hits'></td>
                        <td class='source'>    Generic handler for HTTP respose</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>38</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>39</td>
                        <td class='hits'></td>
                        <td class='source'>  def handle_http_response(response, default \\ nil) do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>40</td>
                        <td class='hits'>8</td>
                        <td class='source'>    case response do</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>41</td>
                        <td class='hits'></td>
                        <td class='source'>      {:ok, %HTTPoison.Response{status_code: 200, body: body}} -&gt;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>42</td>
                        <td class='hits'></td>
                        <td class='source'>        {:ok, get_json(body, default)}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>43</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>44</td>
                        <td class='hits'></td>
                        <td class='source'>      {:ok, %HTTPoison.Response{status_code: 400, body: body}} -&gt;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>45</td>
                        <td class='hits'></td>
                        <td class='source'>        {:error, get_json(body, default)}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>46</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>47</td>
                        <td class='hits'></td>
                        <td class='source'>      {:ok, %HTTPoison.Response{status_code: status_code}} -&gt;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>48</td>
                        <td class='hits'></td>
                        <td class='source'>        # this means the config values are incorrect</td>
                      </tr>
                  
                
                  
                      <tr class='miss'>
                        <td class='line'>49</td>
                        <td class='hits'>0</td>
                        <td class='source'>        Logger.error(status_code)</td>
                      </tr>
                    
                
                  
                      <tr class='miss'>
                        <td class='line'>50</td>
                        <td class='hits'>0</td>
                        <td class='source'>        default</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>51</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>52</td>
                        <td class='hits'></td>
                        <td class='source'>      {:error, %HTTPoison.Error{reason: reason}} -&gt;</td>
                      </tr>
                  
                
                  
                      <tr class='miss'>
                        <td class='line'>53</td>
                        <td class='hits'>0</td>
                        <td class='source'>        Logger.error(reason)</td>
                      </tr>
                    
                
                  
                      <tr class='miss'>
                        <td class='line'>54</td>
                        <td class='hits'>0</td>
                        <td class='source'>        default</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>55</td>
                        <td class='hits'></td>
                        <td class='source'>    end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>56</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>57</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>58</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>59</td>
                        <td class='hits'></td>
                        <td class='source'>    Decrypts the payload from MBWay webhook</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>60</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>61</td>
                        <td class='hits'></td>
                        <td class='source'>  @spec decrypt_hexadecimal_response(String, String, String) :: String</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>62</td>
                        <td class='hits'></td>
                        <td class='source'>  def decrypt_hexadecimal_response(http_body, auth_tag_from_http_header, iv_from_http_header) do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>63</td>
                        <td class='hits'>7</td>
                        <td class='source'>    secret_from_config =</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>64</td>
                        <td class='hits'></td>
                        <td class='source'>      Application.get_env(:parkapp, :mb_way_api, [])</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>65</td>
                        <td class='hits'></td>
                        <td class='source'>      |&gt; Enum.into(%{})</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>66</td>
                        <td class='hits'></td>
                        <td class='source'>      |&gt; Map.get(:decrypt_secret, &quot;&quot;)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>67</td>
                        <td class='hits'></td>
                        <td class='source'>      |&gt; Base.decode16!(case: :lower)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>68</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>69</td>
                        <td class='hits'>7</td>
                        <td class='source'>    iv_from_http_header =</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>70</td>
                        <td class='hits'></td>
                        <td class='source'>      iv_from_http_header</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>71</td>
                        <td class='hits'></td>
                        <td class='source'>      |&gt; Base.decode16!(case: :mixed)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>72</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>73</td>
                        <td class='hits'>7</td>
                        <td class='source'>    auth_tag_from_http_header =</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>74</td>
                        <td class='hits'></td>
                        <td class='source'>      auth_tag_from_http_header</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>75</td>
                        <td class='hits'></td>
                        <td class='source'>      |&gt; Base.decode16!(case: :mixed)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>76</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>77</td>
                        <td class='hits'>7</td>
                        <td class='source'>    http_body =</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>78</td>
                        <td class='hits'></td>
                        <td class='source'>      http_body</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>79</td>
                        <td class='hits'></td>
                        <td class='source'>      |&gt; Base.decode16!(case: :mixed)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>80</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>81</td>
                        <td class='hits'>7</td>
                        <td class='source'>    :crypto.block_decrypt(</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>82</td>
                        <td class='hits'></td>
                        <td class='source'>      :aes_gcm,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>83</td>
                        <td class='hits'></td>
                        <td class='source'>      secret_from_config,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>84</td>
                        <td class='hits'></td>
                        <td class='source'>      iv_from_http_header,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>85</td>
                        <td class='hits'></td>
                        <td class='source'>      {&quot;&quot;, http_body, auth_tag_from_http_header}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>86</td>
                        <td class='hits'></td>
                        <td class='source'>    )</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>87</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>88</td>
                        <td class='hits'></td>
                        <td class='source'>end</td>
                      </tr>
                  
                
              </tbody>
            </table>
          </div>
        
          <div class='file'>
            <h2 id='lib/parkapp_web/api_integration/mb_way/mock.ex'>lib/parkapp_web/api_integration/mb_way/mock.ex</h1>
            <div id='stats' class='terrible'>
              <div class='percentage'>0</div>
              <div class='sloc'>0</div>
              <div class='hits'>0</div>
              <div class='misses'>0</div>
            </div>
            <table id='source'>
              <thead>
                <tr>
                  <th>Line</th>
                  <th>Hits</th>
                  <th>Source</th>
                </tr>
              <tbody>
                
                  
                      <tr>
                        <td class='line'>0</td>
                        <td class='hits'></td>
                        <td class='source'>defmodule ParkappWeb.ApiIntegration.MBWay.Mock do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>1</td>
                        <td class='hits'></td>
                        <td class='source'>  @moduledoc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>2</td>
                        <td class='hits'></td>
                        <td class='source'>    Mock implementation of the MBWay API. Used for testing.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>3</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>4</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>5</td>
                        <td class='hits'></td>
                        <td class='source'>  @behaviour ParkappWeb.ApiIntegration.MBWay.Behaviour</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>6</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>7</td>
                        <td class='hits'></td>
                        <td class='source'>  def request_payment(_user_token, _phone_number, _amount) do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>8</td>
                        <td class='hits'></td>
                        <td class='source'>    {:ok,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>9</td>
                        <td class='hits'></td>
                        <td class='source'>     %{</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>10</td>
                        <td class='hits'></td>
                        <td class='source'>       &quot;amount&quot; =&gt; &quot;10.00&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>11</td>
                        <td class='hits'></td>
                        <td class='source'>       &quot;buildNumber&quot; =&gt; &quot;f7c953080e1b6da8cfcf6cb8ca1a460db91503a6@2018-09-11 12:23:05 +0000&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>12</td>
                        <td class='hits'></td>
                        <td class='source'>       &quot;currency&quot; =&gt; &quot;EUR&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>13</td>
                        <td class='hits'></td>
                        <td class='source'>       &quot;descriptor&quot; =&gt; &quot;4351.8240.8354&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>14</td>
                        <td class='hits'></td>
                        <td class='source'>       &quot;id&quot; =&gt; &quot;8a82944965d7d50b0165ebee15350fe1&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>15</td>
                        <td class='hits'></td>
                        <td class='source'>       &quot;merchantTransactionId&quot; =&gt; &quot;user token&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>16</td>
                        <td class='hits'></td>
                        <td class='source'>       &quot;ndc&quot; =&gt; &quot;8a8294185bd901c5015be855fd5f1578_94ac23ff79f141a3969ae480fb6b9b91&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>17</td>
                        <td class='hits'></td>
                        <td class='source'>       &quot;paymentBrand&quot; =&gt; &quot;MBWAY&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>18</td>
                        <td class='hits'></td>
                        <td class='source'>       &quot;paymentType&quot; =&gt; &quot;DB&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>19</td>
                        <td class='hits'></td>
                        <td class='source'>       &quot;result&quot; =&gt; %{</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>20</td>
                        <td class='hits'></td>
                        <td class='source'>         &quot;code&quot; =&gt; &quot;800.400.500&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>21</td>
                        <td class='hits'></td>
                        <td class='source'>         &quot;description&quot; =&gt; &quot;Waiting for confirmation of non-instant payment. Denied for now.&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>22</td>
                        <td class='hits'></td>
                        <td class='source'>       },</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>23</td>
                        <td class='hits'></td>
                        <td class='source'>       &quot;resultDetails&quot; =&gt; %{</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>24</td>
                        <td class='hits'></td>
                        <td class='source'>         &quot;AcquirerResponse&quot; =&gt; &quot;Pending&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>25</td>
                        <td class='hits'></td>
                        <td class='source'>         &quot;ConnectorTxID1&quot; =&gt; &quot;4351.8240.8354&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>26</td>
                        <td class='hits'></td>
                        <td class='source'>         &quot;ConnectorTxID2&quot; =&gt; &quot;2018-09-18 09:06:13&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>27</td>
                        <td class='hits'></td>
                        <td class='source'>         &quot;ConnectorTxID3&quot; =&gt; &quot;S08058100624238S||351#911222111|MobilePhone|&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>28</td>
                        <td class='hits'></td>
                        <td class='source'>         &quot;Pre-authorization validity&quot; =&gt; &quot;2018-09-15T01:00:00.001+01:00&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>29</td>
                        <td class='hits'></td>
                        <td class='source'>       },</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>30</td>
                        <td class='hits'></td>
                        <td class='source'>       &quot;timestamp&quot; =&gt; &quot;2018-09-18 09:06:14+0000&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>31</td>
                        <td class='hits'></td>
                        <td class='source'>     }}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>32</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>33</td>
                        <td class='hits'></td>
                        <td class='source'>end</td>
                      </tr>
                  
                
              </tbody>
            </table>
          </div>
        
          <div class='file'>
            <h2 id='lib/parkapp_web/auth/auth.ex'>lib/parkapp_web/auth/auth.ex</h1>
            <div id='stats' class='high'>
              <div class='percentage'>91.7</div>
              <div class='sloc'>12</div>
              <div class='hits'>135</div>
              <div class='misses'>1</div>
            </div>
            <table id='source'>
              <thead>
                <tr>
                  <th>Line</th>
                  <th>Hits</th>
                  <th>Source</th>
                </tr>
              <tbody>
                
                  
                      <tr>
                        <td class='line'>0</td>
                        <td class='hits'></td>
                        <td class='source'>defmodule ParkappWeb.Auth do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>1</td>
                        <td class='hits'></td>
                        <td class='source'>  @moduledoc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>2</td>
                        <td class='hits'></td>
                        <td class='source'>  The Auth module contains the related methods to the middle layer between the Parkapp.Auth and the AuthenticationController.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>3</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>4</td>
                        <td class='hits'></td>
                        <td class='source'>  alias __MODULE__.{</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>5</td>
                        <td class='hits'></td>
                        <td class='source'>    Guardian,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>6</td>
                        <td class='hits'></td>
                        <td class='source'>    Secret</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>7</td>
                        <td class='hits'></td>
                        <td class='source'>  }</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>8</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>9</td>
                        <td class='hits'></td>
                        <td class='source'>  alias Parkapp.Auth.Devices</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>10</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>11</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>12</td>
                        <td class='hits'></td>
                        <td class='source'>  Generates an encrypted secret for the given device.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>13</td>
                        <td class='hits'></td>
                        <td class='source'>  The unencrypted secret is stored in the database</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>14</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>15</td>
                        <td class='hits'></td>
                        <td class='source'>  @spec generate_encrypted_secret(Device) :: String | nil</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>16</td>
                        <td class='hits'></td>
                        <td class='source'>  def generate_encrypted_secret(device) do</td>
                      </tr>
                  
                
                  
                      <tr class='miss'>
                        <td class='line'>17</td>
                        <td class='hits'>0</td>
                        <td class='source'>    with(</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>18</td>
                        <td class='hits'>1</td>
                        <td class='source'>      secret &lt;- Secret.generate_secret(),</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>19</td>
                        <td class='hits'>1</td>
                        <td class='source'>      {:ok, device} &lt;- Devices.update_device_secret(device, %{&quot;secret&quot; =&gt; secret}),</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>20</td>
                        <td class='hits'>1</td>
                        <td class='source'>      false &lt;- is_nil(device.key)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>21</td>
                        <td class='hits'></td>
                        <td class='source'>    ) do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>22</td>
                        <td class='hits'>1</td>
                        <td class='source'>      Secret.encrypt_client_secret(device.key, secret)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>23</td>
                        <td class='hits'></td>
                        <td class='source'>    else</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>24</td>
                        <td class='hits'></td>
                        <td class='source'>      _ -&gt; nil</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>25</td>
                        <td class='hits'></td>
                        <td class='source'>    end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>26</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>27</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>28</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>29</td>
                        <td class='hits'></td>
                        <td class='source'>  Generates a token for the given device.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>30</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>31</td>
                        <td class='hits'></td>
                        <td class='source'>  @spec generate_token(Plug.Conn, Device, String) :: {Plug.Conn, String} | nil</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>32</td>
                        <td class='hits'></td>
                        <td class='source'>  def generate_token(conn, device, secret) do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>33</td>
                        <td class='hits'>1</td>
                        <td class='source'>    with(</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>34</td>
                        <td class='hits'>29</td>
                        <td class='source'>      false &lt;- is_nil(device.secret),</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>35</td>
                        <td class='hits'>28</td>
                        <td class='source'>      true &lt;- device.secret == secret,</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>36</td>
                        <td class='hits'>28</td>
                        <td class='source'>      {conn, jwt} &lt;- Guardian.generate_auth_token(conn, device)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>37</td>
                        <td class='hits'></td>
                        <td class='source'>    ) do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>38</td>
                        <td class='hits'></td>
                        <td class='source'>      {conn, jwt}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>39</td>
                        <td class='hits'></td>
                        <td class='source'>    else</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>40</td>
                        <td class='hits'></td>
                        <td class='source'>      _ -&gt; nil</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>41</td>
                        <td class='hits'></td>
                        <td class='source'>    end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>42</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>43</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>44</td>
                        <td class='hits'></td>
                        <td class='source'>  @spec get_current_session_device(Plug.Conn) :: Device</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>45</td>
                        <td class='hits'></td>
                        <td class='source'>  def get_current_session_device(conn) do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>46</td>
                        <td class='hits'>33</td>
                        <td class='source'>    Guardian.Plug.current_resource(conn)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>47</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>48</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>49</td>
                        <td class='hits'></td>
                        <td class='source'>  @spec verify_token(String) :: {:ok, Device} | :error</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>50</td>
                        <td class='hits'></td>
                        <td class='source'>  def verify_token(token) do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>51</td>
                        <td class='hits'>7</td>
                        <td class='source'>    case Guardian.decode_and_verify(token) do</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>52</td>
                        <td class='hits'></td>
                        <td class='source'>      {:ok, claims} -&gt;</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>53</td>
                        <td class='hits'>5</td>
                        <td class='source'>        Guardian.resource_from_claims(claims)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>54</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>55</td>
                        <td class='hits'></td>
                        <td class='source'>      {:error, _reason} -&gt;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>56</td>
                        <td class='hits'></td>
                        <td class='source'>        :error</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>57</td>
                        <td class='hits'></td>
                        <td class='source'>    end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>58</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>59</td>
                        <td class='hits'></td>
                        <td class='source'>end</td>
                      </tr>
                  
                
              </tbody>
            </table>
          </div>
        
          <div class='file'>
            <h2 id='lib/parkapp_web/auth/guardian/error_handler.ex'>lib/parkapp_web/auth/guardian/error_handler.ex</h1>
            <div id='stats' class='high'>
              <div class='percentage'>100</div>
              <div class='sloc'>2</div>
              <div class='hits'>22</div>
              <div class='misses'>0</div>
            </div>
            <table id='source'>
              <thead>
                <tr>
                  <th>Line</th>
                  <th>Hits</th>
                  <th>Source</th>
                </tr>
              <tbody>
                
                  
                      <tr>
                        <td class='line'>0</td>
                        <td class='hits'></td>
                        <td class='source'>defmodule ParkappWeb.Auth.Guardian.ErrorHandler do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>1</td>
                        <td class='hits'></td>
                        <td class='source'>  import Plug.Conn</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>2</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>3</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>4</td>
                        <td class='hits'></td>
                        <td class='source'>    Handler when a connection is invalid (e.g. token is invalid).</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>5</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>6</td>
                        <td class='hits'></td>
                        <td class='source'>  def auth_error(conn, {type, _reason}, _opts) do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>7</td>
                        <td class='hits'>11</td>
                        <td class='source'>    body = Poison.encode!(%{error: to_string(type)})</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>8</td>
                        <td class='hits'>11</td>
                        <td class='source'>    send_resp(conn, :unauthorized, body)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>9</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>10</td>
                        <td class='hits'></td>
                        <td class='source'>end</td>
                      </tr>
                  
                
              </tbody>
            </table>
          </div>
        
          <div class='file'>
            <h2 id='lib/parkapp_web/auth/guardian/guardian.ex'>lib/parkapp_web/auth/guardian/guardian.ex</h1>
            <div id='stats' class='high'>
              <div class='percentage'>100</div>
              <div class='sloc'>5</div>
              <div class='hits'>204</div>
              <div class='misses'>0</div>
            </div>
            <table id='source'>
              <thead>
                <tr>
                  <th>Line</th>
                  <th>Hits</th>
                  <th>Source</th>
                </tr>
              <tbody>
                
                  
                      <tr>
                        <td class='line'>0</td>
                        <td class='hits'></td>
                        <td class='source'>defmodule ParkappWeb.Auth.Guardian do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>1</td>
                        <td class='hits'></td>
                        <td class='source'>  use Guardian, otp_app: :parkapp</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>2</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>3</td>
                        <td class='hits'></td>
                        <td class='source'>  alias Parkapp.Auth.Devices</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>4</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>5</td>
                        <td class='hits'></td>
                        <td class='source'>  def subject_for_token(resource, _claims) do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>6</td>
                        <td class='hits'></td>
                        <td class='source'>    # You can use any value for the subject of your token but</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>7</td>
                        <td class='hits'></td>
                        <td class='source'>    # it should be useful in retrieving the resource later, see</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>8</td>
                        <td class='hits'></td>
                        <td class='source'>    # how it being used on `resource_from_claims/1` function.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>9</td>
                        <td class='hits'></td>
                        <td class='source'>    # A unique `id` is a good subject, a non-unique email address</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>10</td>
                        <td class='hits'></td>
                        <td class='source'>    # is a poor subject.</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>11</td>
                        <td class='hits'>56</td>
                        <td class='source'>    sub = to_string(resource.device_id)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>12</td>
                        <td class='hits'></td>
                        <td class='source'>    {:ok, sub}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>13</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>14</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>15</td>
                        <td class='hits'></td>
                        <td class='source'>  # def subject_for_token(_, _) do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>16</td>
                        <td class='hits'></td>
                        <td class='source'>  #   {:error, :reason_for_error}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>17</td>
                        <td class='hits'></td>
                        <td class='source'>  # end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>18</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>19</td>
                        <td class='hits'></td>
                        <td class='source'>  def resource_from_claims(claims) do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>20</td>
                        <td class='hits'></td>
                        <td class='source'>    # Here we&#39;ll look up our resource from the claims, the subject can be</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>21</td>
                        <td class='hits'></td>
                        <td class='source'>    # found in the `&quot;sub&quot;` key. In `above subject_for_token/2` we returned</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>22</td>
                        <td class='hits'></td>
                        <td class='source'>    # the resource id so here we&#39;ll rely on that to look it up.</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>23</td>
                        <td class='hits'>46</td>
                        <td class='source'>    device_id = claims[&quot;sub&quot;]</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>24</td>
                        <td class='hits'>46</td>
                        <td class='source'>    resource = Devices.get_device!(device_id)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>25</td>
                        <td class='hits'></td>
                        <td class='source'>    {:ok, resource}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>26</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>27</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>28</td>
                        <td class='hits'></td>
                        <td class='source'>  def generate_auth_token(conn, device) do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>29</td>
                        <td class='hits'></td>
                        <td class='source'>    # Encode a JWT token and update the conn</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>30</td>
                        <td class='hits'>28</td>
                        <td class='source'>    {:ok, jwt, _} = encode_and_sign(device, %{}, token_type: &quot;access&quot;)</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>31</td>
                        <td class='hits'>28</td>
                        <td class='source'>    auth_conn = __MODULE__.Plug.sign_in(conn, device)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>32</td>
                        <td class='hits'></td>
                        <td class='source'>    # jwt = Guardian.Plug.current_token(auth_conn)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>33</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>34</td>
                        <td class='hits'></td>
                        <td class='source'>    {auth_conn, jwt}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>35</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>36</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>37</td>
                        <td class='hits'></td>
                        <td class='source'>  # def resource_from_claims(_claims) do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>38</td>
                        <td class='hits'></td>
                        <td class='source'>  #   {:error, :reason_for_error}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>39</td>
                        <td class='hits'></td>
                        <td class='source'>  # end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>40</td>
                        <td class='hits'></td>
                        <td class='source'>end</td>
                      </tr>
                  
                
              </tbody>
            </table>
          </div>
        
          <div class='file'>
            <h2 id='lib/parkapp_web/auth/guardian/guardian_pipeline.ex'>lib/parkapp_web/auth/guardian/guardian_pipeline.ex</h1>
            <div id='stats' class='terrible'>
              <div class='percentage'>0</div>
              <div class='sloc'>0</div>
              <div class='hits'>0</div>
              <div class='misses'>0</div>
            </div>
            <table id='source'>
              <thead>
                <tr>
                  <th>Line</th>
                  <th>Hits</th>
                  <th>Source</th>
                </tr>
              <tbody>
                
                  
                      <tr>
                        <td class='line'>0</td>
                        <td class='hits'></td>
                        <td class='source'>defmodule ParkappWeb.Auth.GuardianPipeline do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>1</td>
                        <td class='hits'></td>
                        <td class='source'>  use Guardian.Plug.Pipeline,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>2</td>
                        <td class='hits'></td>
                        <td class='source'>    otp_app: :parkapp,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>3</td>
                        <td class='hits'></td>
                        <td class='source'>    module: ParkappWeb.Auth.Guardian,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>4</td>
                        <td class='hits'></td>
                        <td class='source'>    error_handler: ParkappWeb.Auth.Guardian.ErrorHandler</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>5</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>6</td>
                        <td class='hits'></td>
                        <td class='source'>  # If there is a session token, validate it</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>7</td>
                        <td class='hits'></td>
                        <td class='source'>  plug(Guardian.Plug.VerifySession, claims: %{&quot;typ&quot; =&gt; &quot;access&quot;})</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>8</td>
                        <td class='hits'></td>
                        <td class='source'>  # If there is an authorization header, validate it</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>9</td>
                        <td class='hits'></td>
                        <td class='source'>  plug(Guardian.Plug.VerifyHeader, realm: &quot;Bearer&quot;, claims: %{&quot;typ&quot; =&gt; &quot;access&quot;})</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>10</td>
                        <td class='hits'></td>
                        <td class='source'>  plug(Guardian.Plug.EnsureAuthenticated)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>11</td>
                        <td class='hits'></td>
                        <td class='source'>  # Load the user if either of the verifications worked</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>12</td>
                        <td class='hits'></td>
                        <td class='source'>  plug(Guardian.Plug.LoadResource)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>13</td>
                        <td class='hits'></td>
                        <td class='source'>end</td>
                      </tr>
                  
                
              </tbody>
            </table>
          </div>
        
          <div class='file'>
            <h2 id='lib/parkapp_web/auth/rsa/key_loader.ex'>lib/parkapp_web/auth/rsa/key_loader.ex</h1>
            <div id='stats' class='high'>
              <div class='percentage'>83.3</div>
              <div class='sloc'>12</div>
              <div class='hits'>100</div>
              <div class='misses'>2</div>
            </div>
            <table id='source'>
              <thead>
                <tr>
                  <th>Line</th>
                  <th>Hits</th>
                  <th>Source</th>
                </tr>
              <tbody>
                
                  
                      <tr>
                        <td class='line'>0</td>
                        <td class='hits'></td>
                        <td class='source'>defmodule ParkappWeb.Auth.RSA.KeyLoader do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>1</td>
                        <td class='hits'></td>
                        <td class='source'>  @moduledoc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>2</td>
                        <td class='hits'></td>
                        <td class='source'>  The RSA.KeyLoader module is responsible for loading an encoded key into a key data structure which will be used in encryption/decryption</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>3</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>4</td>
                        <td class='hits'></td>
                        <td class='source'>  def load_public_key(public_key_string) do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>5</td>
                        <td class='hits'>6</td>
                        <td class='source'>    public_key_header = &quot;-----BEGIN RSA PUBLIC KEY-----&quot;</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>6</td>
                        <td class='hits'>6</td>
                        <td class='source'>    public_key_footer = &quot;-----END RSA PUBLIC KEY-----&quot;</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>7</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>8</td>
                        <td class='hits'>6</td>
                        <td class='source'>    client_public_key_encoded =</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>9</td>
                        <td class='hits'></td>
                        <td class='source'>      Enum.join([public_key_header, public_key_string, public_key_footer], &quot;\n&quot;)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>10</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>11</td>
                        <td class='hits'>6</td>
                        <td class='source'>    client_public_key_encoded |&gt; ExPublicKey.loads!()</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>12</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>13</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>14</td>
                        <td class='hits'></td>
                        <td class='source'>  def load_private_key(private_key_string) do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>15</td>
                        <td class='hits'>4</td>
                        <td class='source'>    private_key_header = &quot;-----BEGIN RSA PRIVATE KEY-----&quot;</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>16</td>
                        <td class='hits'>4</td>
                        <td class='source'>    private_key_footer = &quot;-----END RSA PRIVATE KEY-----&quot;</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>17</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>18</td>
                        <td class='hits'>4</td>
                        <td class='source'>    client_private_key_encoded =</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>19</td>
                        <td class='hits'></td>
                        <td class='source'>      Enum.join([private_key_header, private_key_string, private_key_footer], &quot;\n&quot;)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>20</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>21</td>
                        <td class='hits'>4</td>
                        <td class='source'>    client_private_key_encoded |&gt; ExPublicKey.loads!()</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>22</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>23</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>24</td>
                        <td class='hits'></td>
                        <td class='source'>  def load_public_key_from_file(public_key_file_path) do</td>
                      </tr>
                  
                
                  
                      <tr class='miss'>
                        <td class='line'>25</td>
                        <td class='hits'>0</td>
                        <td class='source'>    {:ok, public_key_string} = File.read(public_key_file_path)</td>
                      </tr>
                    
                
                  
                      <tr class='miss'>
                        <td class='line'>26</td>
                        <td class='hits'>0</td>
                        <td class='source'>    public_key_string |&gt; ExPublicKey.loads!()</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>27</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>28</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>29</td>
                        <td class='hits'></td>
                        <td class='source'>  def load_private_key_from_file(private_key_file_path) do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>30</td>
                        <td class='hits'>30</td>
                        <td class='source'>    {:ok, private_key_string} = File.read(private_key_file_path)</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>31</td>
                        <td class='hits'>30</td>
                        <td class='source'>    private_key_string |&gt; ExPublicKey.loads!()</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>32</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>33</td>
                        <td class='hits'></td>
                        <td class='source'>end</td>
                      </tr>
                  
                
              </tbody>
            </table>
          </div>
        
          <div class='file'>
            <h2 id='lib/parkapp_web/auth/rsa/rsa_crypto.ex'>lib/parkapp_web/auth/rsa/rsa_crypto.ex</h1>
            <div id='stats' class='high'>
              <div class='percentage'>100</div>
              <div class='sloc'>19</div>
              <div class='hits'>170</div>
              <div class='misses'>0</div>
            </div>
            <table id='source'>
              <thead>
                <tr>
                  <th>Line</th>
                  <th>Hits</th>
                  <th>Source</th>
                </tr>
              <tbody>
                
                  
                      <tr>
                        <td class='line'>0</td>
                        <td class='hits'></td>
                        <td class='source'>defmodule ParkappWeb.Auth.RSA.RSACrypto do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>1</td>
                        <td class='hits'></td>
                        <td class='source'>  @moduledoc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>2</td>
                        <td class='hits'></td>
                        <td class='source'>  When decrypting, if the message was a string, but a binary is returned</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>3</td>
                        <td class='hits'></td>
                        <td class='source'>  then you are passing the wrong key to the function</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>4</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>5</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>6</td>
                        <td class='hits'></td>
                        <td class='source'>  def encrypt_message_public(public_key, message_text) do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>7</td>
                        <td class='hits'>4</td>
                        <td class='source'>    {:ok, public_seq} = ExPublicKey.RSAPublicKey.as_sequence(public_key)</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>8</td>
                        <td class='hits'>4</td>
                        <td class='source'>    {:RSAPublicKey, modulus, exponent} = public_seq</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>9</td>
                        <td class='hits'>4</td>
                        <td class='source'>    padding = :proplists.get_value(:rsa_pad, [], :rsa_no_padding)</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>10</td>
                        <td class='hits'>4</td>
                        <td class='source'>    encrypted_bytes = :crypto.public_encrypt(:rsa, message_text, [exponent, modulus], padding)</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>11</td>
                        <td class='hits'>4</td>
                        <td class='source'>    encrypted_string = Base.encode64(encrypted_bytes)</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>12</td>
                        <td class='hits'>4</td>
                        <td class='source'>    encrypted_string</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>13</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>14</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>15</td>
                        <td class='hits'></td>
                        <td class='source'>  def encrypt_message_private(private_key, message_text) do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>16</td>
                        <td class='hits'>2</td>
                        <td class='source'>    {:ok, private_seq} = ExPublicKey.RSAPrivateKey.as_sequence(private_key)</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>17</td>
                        <td class='hits'>2</td>
                        <td class='source'>    padding = :proplists.get_value(:rsa_pad, [], :rsa_no_padding)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>18</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>19</td>
                        <td class='hits'>2</td>
                        <td class='source'>    encrypted_bytes =</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>20</td>
                        <td class='hits'></td>
                        <td class='source'>      :crypto.private_encrypt(:rsa, message_text, format_rsa_private_key(private_seq), padding)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>21</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>22</td>
                        <td class='hits'>2</td>
                        <td class='source'>    encrypted_string = Base.encode64(encrypted_bytes)</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>23</td>
                        <td class='hits'>2</td>
                        <td class='source'>    encrypted_string</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>24</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>25</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>26</td>
                        <td class='hits'></td>
                        <td class='source'>  def decrypt_message_private(private_key, encrypted_string) do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>27</td>
                        <td class='hits'>32</td>
                        <td class='source'>    {:ok, encrypted_bytes} = Base.decode64(encrypted_string, ignore: :whitespace)</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>28</td>
                        <td class='hits'>32</td>
                        <td class='source'>    {:ok, private_seq} = ExPublicKey.RSAPrivateKey.as_sequence(private_key)</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>29</td>
                        <td class='hits'>32</td>
                        <td class='source'>    padding = :proplists.get_value(:rsa_pad, [], :rsa_no_padding)</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>30</td>
                        <td class='hits'>32</td>
                        <td class='source'>    :crypto.private_decrypt(:rsa, encrypted_bytes, format_rsa_private_key(private_seq), padding)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>31</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>32</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>33</td>
                        <td class='hits'></td>
                        <td class='source'>  def decrypt_message_public(public_key, encrypted_string) do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>34</td>
                        <td class='hits'>2</td>
                        <td class='source'>    {:ok, encrypted_bytes} = Base.decode64(encrypted_string, ignore: :whitespace)</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>35</td>
                        <td class='hits'>2</td>
                        <td class='source'>    {:ok, public_seq} = ExPublicKey.RSAPublicKey.as_sequence(public_key)</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>36</td>
                        <td class='hits'>2</td>
                        <td class='source'>    padding = :proplists.get_value(:rsa_pad, [], :rsa_no_padding)</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>37</td>
                        <td class='hits'>2</td>
                        <td class='source'>    :crypto.public_decrypt(:rsa, encrypted_bytes, format_rsa_public_key(public_seq), padding)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>38</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>39</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>40</td>
                        <td class='hits'></td>
                        <td class='source'>  defp format_rsa_private_key(</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>41</td>
                        <td class='hits'></td>
                        <td class='source'>         {:RSAPrivateKey, :&quot;two-prime&quot;, modulus, publicExponent, privateExponent, prime1, prime2,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>42</td>
                        <td class='hits'></td>
                        <td class='source'>          exponent1, exponent2, coefficient, :asn1_NOVALUE}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>43</td>
                        <td class='hits'></td>
                        <td class='source'>       )</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>44</td>
                        <td class='hits'></td>
                        <td class='source'>       when is_integer(modulus) and is_integer(publicExponent) and is_integer(privateExponent) and</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>45</td>
                        <td class='hits'></td>
                        <td class='source'>              is_integer(prime1) and is_integer(prime2) and is_integer(exponent1) and</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>46</td>
                        <td class='hits'></td>
                        <td class='source'>              is_integer(exponent2) and is_integer(coefficient) do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>47</td>
                        <td class='hits'></td>
                        <td class='source'>    [publicExponent, modulus, privateExponent, prime1, prime2, exponent1, exponent2, coefficient]</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>48</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>49</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>50</td>
                        <td class='hits'></td>
                        <td class='source'>  defp format_rsa_public_key({:RSAPublicKey, modulus, publicExponent})</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>51</td>
                        <td class='hits'></td>
                        <td class='source'>       when is_integer(modulus) and is_integer(publicExponent) do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>52</td>
                        <td class='hits'></td>
                        <td class='source'>    [publicExponent, modulus]</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>53</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>54</td>
                        <td class='hits'></td>
                        <td class='source'>end</td>
                      </tr>
                  
                
              </tbody>
            </table>
          </div>
        
          <div class='file'>
            <h2 id='lib/parkapp_web/auth/secret.ex'>lib/parkapp_web/auth/secret.ex</h1>
            <div id='stats' class='high'>
              <div class='percentage'>100</div>
              <div class='sloc'>3</div>
              <div class='hits'>33</div>
              <div class='misses'>0</div>
            </div>
            <table id='source'>
              <thead>
                <tr>
                  <th>Line</th>
                  <th>Hits</th>
                  <th>Source</th>
                </tr>
              <tbody>
                
                  
                      <tr>
                        <td class='line'>0</td>
                        <td class='hits'></td>
                        <td class='source'>defmodule ParkappWeb.Auth.Secret do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>1</td>
                        <td class='hits'></td>
                        <td class='source'>  @moduledoc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>2</td>
                        <td class='hits'></td>
                        <td class='source'>  The Secret module contains the secret related methods.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>3</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>4</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>5</td>
                        <td class='hits'></td>
                        <td class='source'>  alias ParkappWeb.Utils</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>6</td>
                        <td class='hits'></td>
                        <td class='source'>  alias ParkappWeb.Auth.RSA.KeyLoader</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>7</td>
                        <td class='hits'></td>
                        <td class='source'>  alias ParkappWeb.Auth.RSA.RSACrypto</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>8</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>9</td>
                        <td class='hits'></td>
                        <td class='source'>  @secret_length 256</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>10</td>
                        <td class='hits'></td>
                        <td class='source'>  @private_key_path &quot;/priv/keys/private_test_key.key&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>11</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>12</td>
                        <td class='hits'></td>
                        <td class='source'>  def generate_secret() do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>13</td>
                        <td class='hits'></td>
                        <td class='source'>    Application.get_env(:parkapp, :secret_length, @secret_length)</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>14</td>
                        <td class='hits'>1</td>
                        <td class='source'>    |&gt; Utils.random_string()</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>15</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>16</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>17</td>
                        <td class='hits'></td>
                        <td class='source'>  def decrypt_client_secret(encrypted_secret) do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>18</td>
                        <td class='hits'></td>
                        <td class='source'>    File.cwd!()</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>19</td>
                        <td class='hits'></td>
                        <td class='source'>    |&gt; Path.join(Application.get_env(:parkapp, :private_key_path, @private_key_path))</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>20</td>
                        <td class='hits'></td>
                        <td class='source'>    |&gt; KeyLoader.load_private_key_from_file()</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>21</td>
                        <td class='hits'>30</td>
                        <td class='source'>    |&gt; RSACrypto.decrypt_message_private(encrypted_secret)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>22</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>23</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>24</td>
                        <td class='hits'></td>
                        <td class='source'>  def encrypt_client_secret(device_public_key, secret) do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>25</td>
                        <td class='hits'></td>
                        <td class='source'>    KeyLoader.load_public_key(device_public_key)</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>26</td>
                        <td class='hits'>2</td>
                        <td class='source'>    |&gt; RSACrypto.encrypt_message_public(secret)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>27</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>28</td>
                        <td class='hits'></td>
                        <td class='source'>end</td>
                      </tr>
                  
                
              </tbody>
            </table>
          </div>
        
          <div class='file'>
            <h2 id='lib/parkapp_web/channels/reservation_channel.ex'>lib/parkapp_web/channels/reservation_channel.ex</h1>
            <div id='stats' class='high'>
              <div class='percentage'>78.6</div>
              <div class='sloc'>14</div>
              <div class='hits'>14</div>
              <div class='misses'>3</div>
            </div>
            <table id='source'>
              <thead>
                <tr>
                  <th>Line</th>
                  <th>Hits</th>
                  <th>Source</th>
                </tr>
              <tbody>
                
                  
                      <tr>
                        <td class='line'>0</td>
                        <td class='hits'></td>
                        <td class='source'>defmodule ParkappWeb.ReservationChannel do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>1</td>
                        <td class='hits'></td>
                        <td class='source'>  use Phoenix.Channel</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>2</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>3</td>
                        <td class='hits'></td>
                        <td class='source'>  alias ParkappWeb.Auth</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>4</td>
                        <td class='hits'></td>
                        <td class='source'>  alias ParkappWeb.ApiIntegration.GenServers.{ReservationToInPark, ReservationState}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>5</td>
                        <td class='hits'></td>
                        <td class='source'>  alias Parkapp.Reservations.ReservationStatus.Enum, as: ReservationStatusEnum</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>6</td>
                        <td class='hits'></td>
                        <td class='source'>  alias Parkapp.ReservationsContext</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>7</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>8</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>9</td>
                        <td class='hits'></td>
                        <td class='source'>    Joins the agent on a reservation channel.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>10</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>11</td>
                        <td class='hits'></td>
                        <td class='source'>  def join(&quot;reservation:&quot; &lt;&gt; _username, %{&quot;token&quot; =&gt; token}, socket) do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>12</td>
                        <td class='hits'>3</td>
                        <td class='source'>    case Auth.verify_token(token) do</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>13</td>
                        <td class='hits'></td>
                        <td class='source'>      :error -&gt;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>14</td>
                        <td class='hits'></td>
                        <td class='source'>        {:error, socket}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>15</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>16</td>
                        <td class='hits'></td>
                        <td class='source'>      {:ok, _device} -&gt;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>17</td>
                        <td class='hits'></td>
                        <td class='source'>        {:ok, socket}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>18</td>
                        <td class='hits'></td>
                        <td class='source'>    end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>19</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>20</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>21</td>
                        <td class='hits'></td>
                        <td class='source'>  def handle_in(event, %{&quot;token&quot; =&gt; token} = payload, websocket) do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>22</td>
                        <td class='hits'>2</td>
                        <td class='source'>    case Auth.verify_token(token) do</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>23</td>
                        <td class='hits'></td>
                        <td class='source'>      :error -&gt;</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>24</td>
                        <td class='hits'>1</td>
                        <td class='source'>        {:reply, {:error, %{error: &quot;unauthorized&quot;}}, websocket}</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>25</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>26</td>
                        <td class='hits'></td>
                        <td class='source'>      {:ok, device} -&gt;</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>27</td>
                        <td class='hits'>1</td>
                        <td class='source'>        handle_event(event, %{device: device, payload: payload}, websocket)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>28</td>
                        <td class='hits'></td>
                        <td class='source'>    end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>29</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>30</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>31</td>
                        <td class='hits'></td>
                        <td class='source'>  defp handle_event(&quot;START_CHECKING_INPARK&quot;, %{device: %{device_id: device_id}}, websocket) do</td>
                      </tr>
                  
                
                  
                      <tr class='miss'>
                        <td class='line'>32</td>
                        <td class='hits'>0</td>
                        <td class='source'>    with(</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>33</td>
                        <td class='hits'>1</td>
                        <td class='source'>      reservation &lt;- ReservationsContext.get_current_reservation(device_id),</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>34</td>
                        <td class='hits'>1</td>
                        <td class='source'>      false &lt;- is_nil(reservation),</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>35</td>
                        <td class='hits'>1</td>
                        <td class='source'>      true &lt;- reservation.reservation_status_id == ReservationStatusEnum.open(),</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>36</td>
                        <td class='hits'>1</td>
                        <td class='source'>      gen_server_id &lt;- String.to_atom(&quot;#{reservation.id}&quot;)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>37</td>
                        <td class='hits'></td>
                        <td class='source'>    ) do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>38</td>
                        <td class='hits'>1</td>
                        <td class='source'>      Supervisor.start_child(Parkapp.Supervisor, %{</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>39</td>
                        <td class='hits'></td>
                        <td class='source'>        id: gen_server_id,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>40</td>
                        <td class='hits'></td>
                        <td class='source'>        start: {ReservationToInPark, :start_link, [name: gen_server_id]}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>41</td>
                        <td class='hits'></td>
                        <td class='source'>        })</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>42</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>43</td>
                        <td class='hits'>1</td>
                        <td class='source'>      case ReservationToInPark.init(gen_server_id, websocket, reservation.id) do</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>44</td>
                        <td class='hits'></td>
                        <td class='source'>        nil -&gt;</td>
                      </tr>
                  
                
                  
                      <tr class='miss'>
                        <td class='line'>45</td>
                        <td class='hits'>0</td>
                        <td class='source'>          {:reply, {:error, %{error: &quot;Unable to start checking&quot;}}, websocket}</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>46</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>47</td>
                        <td class='hits'></td>
                        <td class='source'>        %ReservationState{} = _state -&gt;</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>48</td>
                        <td class='hits'>1</td>
                        <td class='source'>          {:reply, {:ok, %{}}, websocket}</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>49</td>
                        <td class='hits'></td>
                        <td class='source'>      end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>50</td>
                        <td class='hits'></td>
                        <td class='source'>    else</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>51</td>
                        <td class='hits'></td>
                        <td class='source'>      _ -&gt;</td>
                      </tr>
                  
                
                  
                      <tr class='miss'>
                        <td class='line'>52</td>
                        <td class='hits'>0</td>
                        <td class='source'>        {:reply, {:error, %{error: &quot;Unable to start checking&quot;}}, websocket}</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>53</td>
                        <td class='hits'></td>
                        <td class='source'>    end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>54</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>55</td>
                        <td class='hits'></td>
                        <td class='source'>end</td>
                      </tr>
                  
                
              </tbody>
            </table>
          </div>
        
          <div class='file'>
            <h2 id='lib/parkapp_web/channels/user_socket.ex'>lib/parkapp_web/channels/user_socket.ex</h1>
            <div id='stats' class='terrible'>
              <div class='percentage'>0</div>
              <div class='sloc'>0</div>
              <div class='hits'>0</div>
              <div class='misses'>0</div>
            </div>
            <table id='source'>
              <thead>
                <tr>
                  <th>Line</th>
                  <th>Hits</th>
                  <th>Source</th>
                </tr>
              <tbody>
                
                  
                      <tr>
                        <td class='line'>0</td>
                        <td class='hits'></td>
                        <td class='source'>defmodule ParkappWeb.UserSocket do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>1</td>
                        <td class='hits'></td>
                        <td class='source'>  use Phoenix.Socket</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>2</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>3</td>
                        <td class='hits'></td>
                        <td class='source'>  ## Channels</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>4</td>
                        <td class='hits'></td>
                        <td class='source'>  # channel &quot;room:*&quot;, ParkappWeb.RoomChannel</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>5</td>
                        <td class='hits'></td>
                        <td class='source'>  channel &quot;reservation:*&quot;, ParkappWeb.ReservationChannel</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>6</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>7</td>
                        <td class='hits'></td>
                        <td class='source'>  ## Transports</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>8</td>
                        <td class='hits'></td>
                        <td class='source'>  transport :websocket, Phoenix.Transports.WebSocket</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>9</td>
                        <td class='hits'></td>
                        <td class='source'>  # transport :longpoll, Phoenix.Transports.LongPoll</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>10</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>11</td>
                        <td class='hits'></td>
                        <td class='source'>  # Socket params are passed from the client and can</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>12</td>
                        <td class='hits'></td>
                        <td class='source'>  # be used to verify and authenticate a user. After</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>13</td>
                        <td class='hits'></td>
                        <td class='source'>  # verification, you can put default assigns into</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>14</td>
                        <td class='hits'></td>
                        <td class='source'>  # the socket that will be set for all channels, ie</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>15</td>
                        <td class='hits'></td>
                        <td class='source'>  #</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>16</td>
                        <td class='hits'></td>
                        <td class='source'>  #     {:ok, assign(socket, :user_id, verified_user_id)}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>17</td>
                        <td class='hits'></td>
                        <td class='source'>  #</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>18</td>
                        <td class='hits'></td>
                        <td class='source'>  # To deny connection, return `:error`.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>19</td>
                        <td class='hits'></td>
                        <td class='source'>  #</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>20</td>
                        <td class='hits'></td>
                        <td class='source'>  # See `Phoenix.Token` documentation for examples in</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>21</td>
                        <td class='hits'></td>
                        <td class='source'>  # performing token verification on connect.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>22</td>
                        <td class='hits'></td>
                        <td class='source'>  def connect(_params, socket) do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>23</td>
                        <td class='hits'></td>
                        <td class='source'>    {:ok, socket}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>24</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>25</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>26</td>
                        <td class='hits'></td>
                        <td class='source'>  # Socket id&#39;s are topics that allow you to identify all sockets for a given user:</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>27</td>
                        <td class='hits'></td>
                        <td class='source'>  #</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>28</td>
                        <td class='hits'></td>
                        <td class='source'>  #     def id(socket), do: &quot;user_socket:#{socket.assigns.user_id}&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>29</td>
                        <td class='hits'></td>
                        <td class='source'>  #</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>30</td>
                        <td class='hits'></td>
                        <td class='source'>  # Would allow you to broadcast a &quot;disconnect&quot; event and terminate</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>31</td>
                        <td class='hits'></td>
                        <td class='source'>  # all active sockets and channels for a given user:</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>32</td>
                        <td class='hits'></td>
                        <td class='source'>  #</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>33</td>
                        <td class='hits'></td>
                        <td class='source'>  #     ParkappWeb.Endpoint.broadcast(&quot;user_socket:#{user.id}&quot;, &quot;disconnect&quot;, %{})</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>34</td>
                        <td class='hits'></td>
                        <td class='source'>  #</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>35</td>
                        <td class='hits'></td>
                        <td class='source'>  # Returning `nil` makes this socket anonymous.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>36</td>
                        <td class='hits'></td>
                        <td class='source'>  def id(_socket), do: nil</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>37</td>
                        <td class='hits'></td>
                        <td class='source'>end</td>
                      </tr>
                  
                
              </tbody>
            </table>
          </div>
        
          <div class='file'>
            <h2 id='lib/parkapp_web/controllers/authentication_controller.ex'>lib/parkapp_web/controllers/authentication_controller.ex</h1>
            <div id='stats' class='high'>
              <div class='percentage'>100</div>
              <div class='sloc'>13</div>
              <div class='hits'>158</div>
              <div class='misses'>0</div>
            </div>
            <table id='source'>
              <thead>
                <tr>
                  <th>Line</th>
                  <th>Hits</th>
                  <th>Source</th>
                </tr>
              <tbody>
                
                  
                      <tr>
                        <td class='line'>0</td>
                        <td class='hits'></td>
                        <td class='source'>defmodule ParkappWeb.AuthenticationController do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>1</td>
                        <td class='hits'></td>
                        <td class='source'>  @moduledoc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>2</td>
                        <td class='hits'></td>
                        <td class='source'>  The AuthenticationController module takes care of the handshake process between the server and the mobile-client.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>3</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>4</td>
                        <td class='hits'></td>
                        <td class='source'>  This process is done in 2 consecutive steps: **registration** and **authentication**.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>5</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>6</td>
                        <td class='hits'></td>
                        <td class='source'>  The **registration** process envolves the mobile-client sending his **device id** and his **public key** to the server, which will be stored in the database.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>7</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>8</td>
                        <td class='hits'></td>
                        <td class='source'>  The **authentication** process is a challenge-response process, and has 2 phases.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>9</td>
                        <td class='hits'></td>
                        <td class='source'>  In the first phase, the mobile-client tells the server he wants to authenticate, and the server answers with a secret (a random string) encrypted with the</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>10</td>
                        <td class='hits'></td>
                        <td class='source'>  client&#39;s public key. The client decrypts the secret.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>11</td>
                        <td class='hits'></td>
                        <td class='source'>  In the second phase, the client encrypts the secret again, but with the server public key, and sends it to the server. The server then decrypts this secret,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>12</td>
                        <td class='hits'></td>
                        <td class='source'>  and if it matches the secret generated in the first phase, the server sends a token to the client, which he will use in all other requests to prove that he</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>13</td>
                        <td class='hits'></td>
                        <td class='source'>  can access the server&#39;s endpoints.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>14</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>15</td>
                        <td class='hits'></td>
                        <td class='source'>  use ParkappWeb, :controller</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>16</td>
                        <td class='hits'></td>
                        <td class='source'>  alias Parkapp.Auth.Devices</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>17</td>
                        <td class='hits'></td>
                        <td class='source'>  alias ParkappWeb.Auth.Secret</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>18</td>
                        <td class='hits'></td>
                        <td class='source'>  alias ParkappWeb.Auth</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>19</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>20</td>
                        <td class='hits'></td>
                        <td class='source'>  # Add an error handler controller</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>21</td>
                        <td class='hits'></td>
                        <td class='source'>  action_fallback(ParkappWeb.FallbackController)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>22</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>23</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>24</td>
                        <td class='hits'></td>
                        <td class='source'>   Registers a new device</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>25</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>26</td>
                        <td class='hits'></td>
                        <td class='source'>   If the device already exists just returns :ok</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>27</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>28</td>
                        <td class='hits'></td>
                        <td class='source'>  def register(_conn, %{&quot;device_id&quot; =&gt; &quot;null&quot;}),</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>29</td>
                        <td class='hits'></td>
                        <td class='source'>    do: {:bad_request, &quot;Device Id cannot be null&quot;}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>30</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>31</td>
                        <td class='hits'></td>
                        <td class='source'>  def register(_conn, %{&quot;public_key&quot; =&gt; &quot;null&quot;}),</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>32</td>
                        <td class='hits'></td>
                        <td class='source'>    do: {:bad_request, &quot;Device Public Key cannot be null&quot;}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>33</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>34</td>
                        <td class='hits'></td>
                        <td class='source'>  def register(_conn, %{&quot;device_id&quot; =&gt; device_id, &quot;public_key&quot; =&gt; public_key}) do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>35</td>
                        <td class='hits'>4</td>
                        <td class='source'>    case Devices.get_device(device_id) do</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>36</td>
                        <td class='hits'></td>
                        <td class='source'>      nil -&gt;</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>37</td>
                        <td class='hits'>2</td>
                        <td class='source'>        with({:ok, _} &lt;- Devices.create_device(%{device_id: device_id, key: public_key})) do</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>38</td>
                        <td class='hits'></td>
                        <td class='source'>          {:ok, %{}}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>39</td>
                        <td class='hits'></td>
                        <td class='source'>        end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>40</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>41</td>
                        <td class='hits'></td>
                        <td class='source'>      _device -&gt;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>42</td>
                        <td class='hits'></td>
                        <td class='source'>        {:bad_request, &quot;Device is already registered&quot;}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>43</td>
                        <td class='hits'></td>
                        <td class='source'>    end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>44</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>45</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>46</td>
                        <td class='hits'></td>
                        <td class='source'>  def register(_conn, _), do: {:generic_unprocessable_entity, &quot;Invalid parameters&quot;}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>47</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>48</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>49</td>
                        <td class='hits'></td>
                        <td class='source'>    First authentication phase. Associates an encrypted secret with the given device</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>50</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>51</td>
                        <td class='hits'></td>
                        <td class='source'>  def authenticate_phase1(_conn, %{&quot;device_id&quot; =&gt; &quot;null&quot;}),</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>52</td>
                        <td class='hits'></td>
                        <td class='source'>    do: {:bad_request, &quot;Device Id cannot be null&quot;}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>53</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>54</td>
                        <td class='hits'></td>
                        <td class='source'>  def authenticate_phase1(_conn, %{&quot;device_id&quot; =&gt; device_id}) do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>55</td>
                        <td class='hits'>2</td>
                        <td class='source'>    case Devices.get_device(device_id) do</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>56</td>
                        <td class='hits'></td>
                        <td class='source'>      nil -&gt;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>57</td>
                        <td class='hits'></td>
                        <td class='source'>        {:not_found, &quot;Could not find Device&quot;}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>58</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>59</td>
                        <td class='hits'></td>
                        <td class='source'>      device -&gt;</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>60</td>
                        <td class='hits'>1</td>
                        <td class='source'>        case Auth.generate_encrypted_secret(device) do</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>61</td>
                        <td class='hits'></td>
                        <td class='source'>          nil -&gt;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>62</td>
                        <td class='hits'></td>
                        <td class='source'>            {:internal_server_error, &quot;Could not generate Encrypted Secret&quot;}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>63</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>64</td>
                        <td class='hits'></td>
                        <td class='source'>          encrypted_secret -&gt;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>65</td>
                        <td class='hits'></td>
                        <td class='source'>            {:ok, %{secret: encrypted_secret}}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>66</td>
                        <td class='hits'></td>
                        <td class='source'>        end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>67</td>
                        <td class='hits'></td>
                        <td class='source'>    end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>68</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>69</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>70</td>
                        <td class='hits'></td>
                        <td class='source'>  def authenticate_phase1(_conn, _), do: {:generic_unprocessable_entity, &quot;Invalid parameters&quot;}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>71</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>72</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>73</td>
                        <td class='hits'></td>
                        <td class='source'>   Second authentication phase. Generates a JWT token for the given device.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>74</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>75</td>
                        <td class='hits'></td>
                        <td class='source'>  def authenticate_phase2(_conn, %{&quot;device_id&quot; =&gt; &quot;null&quot;}),</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>76</td>
                        <td class='hits'></td>
                        <td class='source'>    do: {:bad_request, &quot;Device Id cannot be null&quot;}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>77</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>78</td>
                        <td class='hits'></td>
                        <td class='source'>  def authenticate_phase2(_conn, %{&quot;encrypted_secret&quot; =&gt; &quot;null&quot;}),</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>79</td>
                        <td class='hits'></td>
                        <td class='source'>    do: {:bad_request, &quot;Encrypted Secret cannot be null&quot;}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>80</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>81</td>
                        <td class='hits'></td>
                        <td class='source'>  def authenticate_phase2(conn, %{</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>82</td>
                        <td class='hits'></td>
                        <td class='source'>        &quot;device_id&quot; =&gt; device_id,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>83</td>
                        <td class='hits'></td>
                        <td class='source'>        &quot;encrypted_secret&quot; =&gt; encrypted_secret</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>84</td>
                        <td class='hits'></td>
                        <td class='source'>      }) do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>85</td>
                        <td class='hits'>30</td>
                        <td class='source'>    secret = Secret.decrypt_client_secret(encrypted_secret)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>86</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>87</td>
                        <td class='hits'>30</td>
                        <td class='source'>    case Devices.get_device(device_id) do</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>88</td>
                        <td class='hits'></td>
                        <td class='source'>      nil -&gt;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>89</td>
                        <td class='hits'></td>
                        <td class='source'>        {:not_found, &quot;Could not find Device&quot;}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>90</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>91</td>
                        <td class='hits'></td>
                        <td class='source'>      device -&gt;</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>92</td>
                        <td class='hits'>29</td>
                        <td class='source'>        case Auth.generate_token(conn, device, secret) do</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>93</td>
                        <td class='hits'></td>
                        <td class='source'>          nil -&gt;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>94</td>
                        <td class='hits'></td>
                        <td class='source'>            {:internal_server_error, &quot;Could not generate Encrypted Token&quot;}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>95</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>96</td>
                        <td class='hits'></td>
                        <td class='source'>          {auth_conn, jwt} -&gt;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>97</td>
                        <td class='hits'></td>
                        <td class='source'>            auth_conn</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>98</td>
                        <td class='hits'>28</td>
                        <td class='source'>            |&gt; put_resp_header(&quot;authorization&quot;, &quot;bearer #{jwt}&quot;)</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>99</td>
                        <td class='hits'>28</td>
                        <td class='source'>            |&gt; json(%{token: jwt})</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>100</td>
                        <td class='hits'></td>
                        <td class='source'>        end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>101</td>
                        <td class='hits'></td>
                        <td class='source'>    end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>102</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>103</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>104</td>
                        <td class='hits'></td>
                        <td class='source'>  def authenticate_phase2(_conn, _), do: {:generic_unprocessable_entity, &quot;Invalid parameters&quot;}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>105</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>106</td>
                        <td class='hits'></td>
                        <td class='source'>  #</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>107</td>
                        <td class='hits'></td>
                        <td class='source'>  # For testing purposes only...</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>108</td>
                        <td class='hits'></td>
                        <td class='source'>  #</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>109</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>110</td>
                        <td class='hits'></td>
                        <td class='source'>  def logout(conn, _) do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>111</td>
                        <td class='hits'></td>
                        <td class='source'>    conn</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>112</td>
                        <td class='hits'></td>
                        <td class='source'>    |&gt; ParkappWeb.Auth.Guardian.Plug.sign_out()</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>113</td>
                        <td class='hits'></td>
                        <td class='source'>    |&gt; put_status(204)</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>114</td>
                        <td class='hits'>1</td>
                        <td class='source'>    |&gt; json(%{})</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>115</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>116</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>117</td>
                        <td class='hits'></td>
                        <td class='source'>  #</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>118</td>
                        <td class='hits'></td>
                        <td class='source'>  # END For testing purposes only...</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>119</td>
                        <td class='hits'></td>
                        <td class='source'>  #</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>120</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>121</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>122</td>
                        <td class='hits'></td>
                        <td class='source'>    Checks if the connection has a legit token associated with it.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>123</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>124</td>
                        <td class='hits'></td>
                        <td class='source'>  def verify_token(_conn, %{&quot;device_id&quot; =&gt; &quot;null&quot;}),</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>125</td>
                        <td class='hits'></td>
                        <td class='source'>    do: {:bad_request, &quot;Device Id cannot be null&quot;}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>126</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>127</td>
                        <td class='hits'></td>
                        <td class='source'>  def verify_token(conn, %{&quot;device_id&quot; =&gt; device_id}) do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>128</td>
                        <td class='hits'>1</td>
                        <td class='source'>    device = Auth.get_current_session_device(conn)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>129</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>130</td>
                        <td class='hits'>1</td>
                        <td class='source'>    cond do</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>131</td>
                        <td class='hits'>1</td>
                        <td class='source'>      device.device_id == device_id -&gt;</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>132</td>
                        <td class='hits'></td>
                        <td class='source'>        {:ok, %{}}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>133</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>134</td>
                        <td class='hits'></td>
                        <td class='source'>      true -&gt;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>135</td>
                        <td class='hits'></td>
                        <td class='source'>        {:unauthorized, &quot;Invalid token&quot;}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>136</td>
                        <td class='hits'></td>
                        <td class='source'>    end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>137</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>138</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>139</td>
                        <td class='hits'></td>
                        <td class='source'>  def verify_token(_conn, _), do: {:generic_unprocessable_entity, &quot;Invalid parameters&quot;}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>140</td>
                        <td class='hits'></td>
                        <td class='source'>end</td>
                      </tr>
                  
                
              </tbody>
            </table>
          </div>
        
          <div class='file'>
            <h2 id='lib/parkapp_web/controllers/fallback_controller.ex'>lib/parkapp_web/controllers/fallback_controller.ex</h1>
            <div id='stats' class='medium'>
              <div class='percentage'>71.4</div>
              <div class='sloc'>7</div>
              <div class='hits'>94</div>
              <div class='misses'>2</div>
            </div>
            <table id='source'>
              <thead>
                <tr>
                  <th>Line</th>
                  <th>Hits</th>
                  <th>Source</th>
                </tr>
              <tbody>
                
                  
                      <tr>
                        <td class='line'>0</td>
                        <td class='hits'></td>
                        <td class='source'>defmodule ParkappWeb.FallbackController do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>1</td>
                        <td class='hits'></td>
                        <td class='source'>  @moduledoc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>2</td>
                        <td class='hits'></td>
                        <td class='source'>  Translates controller action results into valid `Plug.Conn` responses.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>3</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>4</td>
                        <td class='hits'></td>
                        <td class='source'>  See `Phoenix.Controller.action_fallback/1` for more details.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>5</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>6</td>
                        <td class='hits'></td>
                        <td class='source'>  use ParkappWeb, :controller</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>7</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>8</td>
                        <td class='hits'></td>
                        <td class='source'>  def call(conn, {:ok, response_map}) do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>9</td>
                        <td class='hits'></td>
                        <td class='source'>    conn</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>10</td>
                        <td class='hits'>33</td>
                        <td class='source'>    |&gt; response(:ok, response_map)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>11</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>12</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>13</td>
                        <td class='hits'></td>
                        <td class='source'>  def call(conn, {:error, %Ecto.Changeset{} = changeset}) do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>14</td>
                        <td class='hits'></td>
                        <td class='source'>    conn</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>15</td>
                        <td class='hits'></td>
                        <td class='source'>    |&gt; put_status(:unprocessable_entity)</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>16</td>
                        <td class='hits'>1</td>
                        <td class='source'>    |&gt; render(</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>17</td>
                        <td class='hits'></td>
                        <td class='source'>      ParkappWeb.ChangesetView,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>18</td>
                        <td class='hits'></td>
                        <td class='source'>      &quot;error.json&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>19</td>
                        <td class='hits'></td>
                        <td class='source'>      changeset: changeset</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>20</td>
                        <td class='hits'></td>
                        <td class='source'>    )</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>21</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>22</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>23</td>
                        <td class='hits'></td>
                        <td class='source'>  def call(conn, :invalid_file_path) do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>24</td>
                        <td class='hits'></td>
                        <td class='source'>    conn</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>25</td>
                        <td class='hits'></td>
                        <td class='source'>    |&gt; put_status(:unprocessable_entity)</td>
                      </tr>
                  
                
                  
                      <tr class='miss'>
                        <td class='line'>26</td>
                        <td class='hits'>0</td>
                        <td class='source'>    |&gt; render(</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>27</td>
                        <td class='hits'></td>
                        <td class='source'>      ParkappWeb.ErrorView,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>28</td>
                        <td class='hits'></td>
                        <td class='source'>      &quot;error.json&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>29</td>
                        <td class='hits'></td>
                        <td class='source'>      message: &quot;Invalid file path&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>30</td>
                        <td class='hits'></td>
                        <td class='source'>    )</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>31</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>32</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>33</td>
                        <td class='hits'></td>
                        <td class='source'>  def call(conn, {:generic_unprocessable_entity, message}) do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>34</td>
                        <td class='hits'></td>
                        <td class='source'>    conn</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>35</td>
                        <td class='hits'></td>
                        <td class='source'>    |&gt; put_status(:unprocessable_entity)</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>36</td>
                        <td class='hits'>5</td>
                        <td class='source'>    |&gt; render(</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>37</td>
                        <td class='hits'></td>
                        <td class='source'>      ParkappWeb.ErrorView,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>38</td>
                        <td class='hits'></td>
                        <td class='source'>      &quot;error.json&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>39</td>
                        <td class='hits'></td>
                        <td class='source'>      message: message</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>40</td>
                        <td class='hits'></td>
                        <td class='source'>    )</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>41</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>42</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>43</td>
                        <td class='hits'></td>
                        <td class='source'>  def call(conn, {status_code, message}) do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>44</td>
                        <td class='hits'></td>
                        <td class='source'>    conn</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>45</td>
                        <td class='hits'></td>
                        <td class='source'>    |&gt; put_status(status_code)</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>46</td>
                        <td class='hits'>22</td>
                        <td class='source'>    |&gt; render(</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>47</td>
                        <td class='hits'></td>
                        <td class='source'>      ParkappWeb.ErrorView,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>48</td>
                        <td class='hits'></td>
                        <td class='source'>      &quot;error.json&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>49</td>
                        <td class='hits'></td>
                        <td class='source'>      message: message</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>50</td>
                        <td class='hits'></td>
                        <td class='source'>    )</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>51</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>52</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>53</td>
                        <td class='hits'></td>
                        <td class='source'>  def call(conn, _xpto) do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>54</td>
                        <td class='hits'></td>
                        <td class='source'>    conn</td>
                      </tr>
                  
                
                  
                      <tr class='miss'>
                        <td class='line'>55</td>
                        <td class='hits'>0</td>
                        <td class='source'>    |&gt; response(:bad_request, %{})</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>56</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>57</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>58</td>
                        <td class='hits'></td>
                        <td class='source'>  defp response(conn, status_code, map) do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>59</td>
                        <td class='hits'></td>
                        <td class='source'>    conn</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>60</td>
                        <td class='hits'></td>
                        <td class='source'>    |&gt; put_status(status_code)</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>61</td>
                        <td class='hits'>33</td>
                        <td class='source'>    |&gt; json(map)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>62</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>63</td>
                        <td class='hits'></td>
                        <td class='source'>end</td>
                      </tr>
                  
                
              </tbody>
            </table>
          </div>
        
          <div class='file'>
            <h2 id='lib/parkapp_web/controllers/reservation_controller.ex'>lib/parkapp_web/controllers/reservation_controller.ex</h1>
            <div id='stats' class='high'>
              <div class='percentage'>88</div>
              <div class='sloc'>50</div>
              <div class='hits'>272</div>
              <div class='misses'>6</div>
            </div>
            <table id='source'>
              <thead>
                <tr>
                  <th>Line</th>
                  <th>Hits</th>
                  <th>Source</th>
                </tr>
              <tbody>
                
                  
                      <tr>
                        <td class='line'>0</td>
                        <td class='hits'></td>
                        <td class='source'>defmodule ParkappWeb.ReservationController do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>1</td>
                        <td class='hits'></td>
                        <td class='source'>  @moduledoc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>2</td>
                        <td class='hits'></td>
                        <td class='source'>    The ReservationController handles the reservation related requests.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>3</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>4</td>
                        <td class='hits'></td>
                        <td class='source'>  use ParkappWeb, :controller</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>5</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>6</td>
                        <td class='hits'></td>
                        <td class='source'>  alias ParkappWeb.Auth</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>7</td>
                        <td class='hits'></td>
                        <td class='source'>  alias ParkappWeb.ApiIntegration</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>8</td>
                        <td class='hits'></td>
                        <td class='source'>  alias Parkapp.ReservationsContext</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>9</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>10</td>
                        <td class='hits'></td>
                        <td class='source'>  # Add an error handler controller</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>11</td>
                        <td class='hits'></td>
                        <td class='source'>  action_fallback(ParkappWeb.FallbackController)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>12</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>13</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>14</td>
                        <td class='hits'></td>
                        <td class='source'>    Returns the information relative to the current active reservation.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>15</td>
                        <td class='hits'></td>
                        <td class='source'>    Returns 404 if there none is found.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>16</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>17</td>
                        <td class='hits'></td>
                        <td class='source'>  def get_current_reservation(conn, _params) do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>18</td>
                        <td class='hits'>2</td>
                        <td class='source'>    render_reservation(conn, &quot;reservation.json&quot;)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>19</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>20</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>21</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>22</td>
                        <td class='hits'></td>
                        <td class='source'>    Returns the payment information relative to the current active reservation.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>23</td>
                        <td class='hits'></td>
                        <td class='source'>    Returns 404 if there none is found.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>24</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>25</td>
                        <td class='hits'></td>
                        <td class='source'>  def get_current_reservation_payment(conn, _params) do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>26</td>
                        <td class='hits'>2</td>
                        <td class='source'>    render_reservation(conn, &quot;reservation_payment.json&quot;)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>27</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>28</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>29</td>
                        <td class='hits'></td>
                        <td class='source'>  defp render_reservation(conn, json) do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>30</td>
                        <td class='hits'>2</td>
                        <td class='source'>    with(</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>31</td>
                        <td class='hits'>4</td>
                        <td class='source'>      device &lt;- Auth.get_current_session_device(conn),</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>32</td>
                        <td class='hits'>4</td>
                        <td class='source'>      reservation &lt;- ReservationsContext.get_current_reservation(device.device_id),</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>33</td>
                        <td class='hits'>4</td>
                        <td class='source'>      false &lt;- is_nil(reservation)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>34</td>
                        <td class='hits'></td>
                        <td class='source'>    ) do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>35</td>
                        <td class='hits'>2</td>
                        <td class='source'>      render(conn, ParkappWeb.ReservationView, json, reservation: reservation)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>36</td>
                        <td class='hits'></td>
                        <td class='source'>    else</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>37</td>
                        <td class='hits'></td>
                        <td class='source'>      _ -&gt;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>38</td>
                        <td class='hits'></td>
                        <td class='source'>        {:not_found, &quot;No active reservation for the given device&quot;}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>39</td>
                        <td class='hits'></td>
                        <td class='source'>    end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>40</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>41</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>42</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>43</td>
                        <td class='hits'></td>
                        <td class='source'>    Action that performs the reservation</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>44</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>45</td>
                        <td class='hits'></td>
                        <td class='source'>  def reserve(conn, _params) do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>46</td>
                        <td class='hits'>9</td>
                        <td class='source'>    device = Auth.get_current_session_device(conn)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>47</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>48</td>
                        <td class='hits'>9</td>
                        <td class='source'>    case ApiIntegration.reserve_single_use(device.device_id) do</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>49</td>
                        <td class='hits'></td>
                        <td class='source'>      nil -&gt;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>50</td>
                        <td class='hits'></td>
                        <td class='source'>        {:bad_request, &quot;Something went wrong&quot;}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>51</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>52</td>
                        <td class='hits'></td>
                        <td class='source'>      {:error, result} -&gt;</td>
                      </tr>
                  
                
                  
                      <tr class='miss'>
                        <td class='line'>53</td>
                        <td class='hits'>0</td>
                        <td class='source'>        Logger.warn(Poison.encode!(result))</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>54</td>
                        <td class='hits'></td>
                        <td class='source'>        {:bad_request, &quot;Invalid parameters&quot;}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>55</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>56</td>
                        <td class='hits'></td>
                        <td class='source'>      {:ok, result} -&gt;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>57</td>
                        <td class='hits'></td>
                        <td class='source'>        {:ok,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>58</td>
                        <td class='hits'></td>
                        <td class='source'>         %{</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>59</td>
                        <td class='hits'>9</td>
                        <td class='source'>           barcode: result.barcode</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>60</td>
                        <td class='hits'></td>
                        <td class='source'>         }}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>61</td>
                        <td class='hits'></td>
                        <td class='source'>    end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>62</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>63</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>64</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>65</td>
                        <td class='hits'></td>
                        <td class='source'>    Action that informs the server that the user entered the park</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>66</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>67</td>
                        <td class='hits'></td>
                        <td class='source'>  def in_park(conn, _params) do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>68</td>
                        <td class='hits'>1</td>
                        <td class='source'>    with(</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>69</td>
                        <td class='hits'>8</td>
                        <td class='source'>      device &lt;- Auth.get_current_session_device(conn),</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>70</td>
                        <td class='hits'>8</td>
                        <td class='source'>      reservation &lt;- ReservationsContext.get_current_reservation(device.device_id),</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>71</td>
                        <td class='hits'>8</td>
                        <td class='source'>      false &lt;- is_nil(reservation),</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>72</td>
                        <td class='hits'>7</td>
                        <td class='source'>      {:ok, _reservation} &lt;- ReservationsContext.move_to_in_park_state(reservation, DateTime.utc_now)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>73</td>
                        <td class='hits'></td>
                        <td class='source'>    ) do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>74</td>
                        <td class='hits'></td>
                        <td class='source'>      {:ok, %{}}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>75</td>
                        <td class='hits'></td>
                        <td class='source'>    else</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>76</td>
                        <td class='hits'></td>
                        <td class='source'>      {:error, result} -&gt;</td>
                      </tr>
                  
                
                  
                      <tr class='miss'>
                        <td class='line'>77</td>
                        <td class='hits'>0</td>
                        <td class='source'>        Logger.warn(Poison.encode!(result))</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>78</td>
                        <td class='hits'></td>
                        <td class='source'>        {:bad_request, &quot;Invalid parameters&quot;}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>79</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>80</td>
                        <td class='hits'></td>
                        <td class='source'>      _error -&gt;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>81</td>
                        <td class='hits'></td>
                        <td class='source'>        {:bad_request, &quot;Something went wrong&quot;}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>82</td>
                        <td class='hits'></td>
                        <td class='source'>    end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>83</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>84</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>85</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>86</td>
                        <td class='hits'></td>
                        <td class='source'>    Action that performs the first step in the payment workflow</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>87</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>88</td>
                        <td class='hits'></td>
                        <td class='source'>  def pay(_conn, %{&quot;phone_number&quot; =&gt; &quot;null&quot;}) do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>89</td>
                        <td class='hits'></td>
                        <td class='source'>    {:bad_request, &quot;Phone number cannot be null&quot;}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>90</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>91</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>92</td>
                        <td class='hits'></td>
                        <td class='source'>  def pay(conn, %{&quot;phone_number&quot; =&gt; phone_number}) do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>93</td>
                        <td class='hits'>7</td>
                        <td class='source'>    device = Auth.get_current_session_device(conn)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>94</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>95</td>
                        <td class='hits'>7</td>
                        <td class='source'>    case ApiIntegration.pay(device.device_id, phone_number) do</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>96</td>
                        <td class='hits'></td>
                        <td class='source'>      nil -&gt;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>97</td>
                        <td class='hits'></td>
                        <td class='source'>        {:bad_request, &quot;Something went wrong&quot;}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>98</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>99</td>
                        <td class='hits'></td>
                        <td class='source'>      {:error, result} -&gt;</td>
                      </tr>
                  
                
                  
                      <tr class='miss'>
                        <td class='line'>100</td>
                        <td class='hits'>0</td>
                        <td class='source'>        Logger.warn(Poison.encode!(result))</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>101</td>
                        <td class='hits'></td>
                        <td class='source'>        {:bad_request, &quot;Invalid parameters&quot;}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>102</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>103</td>
                        <td class='hits'></td>
                        <td class='source'>      {:ok, result} -&gt;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>104</td>
                        <td class='hits'></td>
                        <td class='source'>        {:ok,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>105</td>
                        <td class='hits'></td>
                        <td class='source'>         %{</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>106</td>
                        <td class='hits'>6</td>
                        <td class='source'>           amount: result.amount</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>107</td>
                        <td class='hits'></td>
                        <td class='source'>         }}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>108</td>
                        <td class='hits'></td>
                        <td class='source'>    end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>109</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>110</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>111</td>
                        <td class='hits'></td>
                        <td class='source'>  def pay(_conn, _params) do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>112</td>
                        <td class='hits'></td>
                        <td class='source'>    {:generic_unprocessable_entity, &quot;Invalid parameters&quot;}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>113</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>114</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>115</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>116</td>
                        <td class='hits'></td>
                        <td class='source'>    Webhook for MBway callback. Finalizes the payment workflow.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>117</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>118</td>
                        <td class='hits'></td>
                        <td class='source'>  def complete_payment(_conn, %{&quot;encryptedBody&quot; =&gt; &quot;null&quot;}) do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>119</td>
                        <td class='hits'></td>
                        <td class='source'>    {:bad_request, &quot;Params cannot be null&quot;}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>120</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>121</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>122</td>
                        <td class='hits'></td>
                        <td class='source'>  def complete_payment(conn, %{&quot;encryptedBody&quot; =&gt; encrypted_body}) do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>123</td>
                        <td class='hits'>5</td>
                        <td class='source'>    Logger.info(encrypted_body)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>124</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>125</td>
                        <td class='hits'>1</td>
                        <td class='source'>    with(</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>126</td>
                        <td class='hits'>5</td>
                        <td class='source'>      iv_from_http_header &lt;- get_req_header(conn, &quot;x-initialization-vector&quot;) |&gt; List.first(),</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>127</td>
                        <td class='hits'>5</td>
                        <td class='source'>      auth_tag_from_http_header &lt;- get_req_header(conn, &quot;x-authentication-tag&quot;) |&gt; List.first(),</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>128</td>
                        <td class='hits'>5</td>
                        <td class='source'>      Logger.info(iv_from_http_header),</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>129</td>
                        <td class='hits'>5</td>
                        <td class='source'>      Logger.info(auth_tag_from_http_header),</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>130</td>
                        <td class='hits'>5</td>
                        <td class='source'>      {:ok, body} &lt;-</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>131</td>
                        <td class='hits'></td>
                        <td class='source'>        ApiIntegration.MBWay.Helpers.decrypt_hexadecimal_response(</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>132</td>
                        <td class='hits'></td>
                        <td class='source'>          encrypted_body,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>133</td>
                        <td class='hits'></td>
                        <td class='source'>          auth_tag_from_http_header,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>134</td>
                        <td class='hits'></td>
                        <td class='source'>          iv_from_http_header</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>135</td>
                        <td class='hits'></td>
                        <td class='source'>        )</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>136</td>
                        <td class='hits'></td>
                        <td class='source'>        |&gt; Poison.decode(),</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>137</td>
                        <td class='hits'>5</td>
                        <td class='source'>      true &lt;- is_body_valid(body),</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>138</td>
                        <td class='hits'>5</td>
                        <td class='source'>      Logger.info(&quot;body is valid&quot;),</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>139</td>
                        <td class='hits'>5</td>
                        <td class='source'>      payload &lt;- Map.get(body, &quot;payload&quot;, %{}),</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>140</td>
                        <td class='hits'>5</td>
                        <td class='source'>      device_id &lt;-</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>141</td>
                        <td class='hits'></td>
                        <td class='source'>        Map.get(payload, &quot;customParameters&quot;, %{})</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>142</td>
                        <td class='hits'></td>
                        <td class='source'>        |&gt; Map.get(&quot;device_id&quot;),</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>143</td>
                        <td class='hits'>5</td>
                        <td class='source'>      Logger.info(device_id),</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>144</td>
                        <td class='hits'>5</td>
                        <td class='source'>      {:ok, _result} &lt;- ApiIntegration.complete_payment_procedure(device_id, payload)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>145</td>
                        <td class='hits'></td>
                        <td class='source'>    ) do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>146</td>
                        <td class='hits'></td>
                        <td class='source'>      {:ok, %{}}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>147</td>
                        <td class='hits'></td>
                        <td class='source'>    else</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>148</td>
                        <td class='hits'></td>
                        <td class='source'>      {:error, %Ecto.Changeset{} = result} -&gt;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>149</td>
                        <td class='hits'></td>
                        <td class='source'>        {:error, result}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>150</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>151</td>
                        <td class='hits'></td>
                        <td class='source'>      {:error, result} -&gt;</td>
                      </tr>
                  
                
                  
                      <tr class='miss'>
                        <td class='line'>152</td>
                        <td class='hits'>0</td>
                        <td class='source'>        Logger.error(Poison.encode!(result))</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>153</td>
                        <td class='hits'></td>
                        <td class='source'>        {:bad_request, &quot;Invalid parameters&quot;}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>154</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>155</td>
                        <td class='hits'></td>
                        <td class='source'>      error -&gt;</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>156</td>
                        <td class='hits'>1</td>
                        <td class='source'>        Logger.error(error)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>157</td>
                        <td class='hits'></td>
                        <td class='source'>        {:bad_request, &quot;Something went wrong&quot;}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>158</td>
                        <td class='hits'></td>
                        <td class='source'>    end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>159</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>160</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>161</td>
                        <td class='hits'></td>
                        <td class='source'>  def complete_payment(_conn, _params) do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>162</td>
                        <td class='hits'></td>
                        <td class='source'>    {:generic_unprocessable_entity, &quot;Invalid parameters&quot;}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>163</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>164</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>165</td>
                        <td class='hits'></td>
                        <td class='source'>  defp is_body_valid(body) do</td>
                      </tr>
                  
                
                  
                      <tr class='miss'>
                        <td class='line'>166</td>
                        <td class='hits'>0</td>
                        <td class='source'>    with(</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>167</td>
                        <td class='hits'>5</td>
                        <td class='source'>      true &lt;- Map.has_key?(body, &quot;payload&quot;),</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>168</td>
                        <td class='hits'>5</td>
                        <td class='source'>      payload &lt;- Map.get(body, &quot;payload&quot;, %{}),</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>169</td>
                        <td class='hits'>5</td>
                        <td class='source'>      true &lt;-</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>170</td>
                        <td class='hits'></td>
                        <td class='source'>        [&quot;id&quot;, &quot;amount&quot;, &quot;currency&quot;, &quot;result&quot;, &quot;customParameters&quot;, &quot;buildNumber&quot;, &quot;ndc&quot;]</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>171</td>
                        <td class='hits'></td>
                        <td class='source'>        |&gt; Enum.reduce(true, fn key, acc -&gt;</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>172</td>
                        <td class='hits'>35</td>
                        <td class='source'>          cond do</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>173</td>
                        <td class='hits'></td>
                        <td class='source'>            key in Map.keys(payload) -&gt;</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>174</td>
                        <td class='hits'>35</td>
                        <td class='source'>              acc</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>175</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>176</td>
                        <td class='hits'></td>
                        <td class='source'>            true -&gt;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>177</td>
                        <td class='hits'></td>
                        <td class='source'>              false</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>178</td>
                        <td class='hits'></td>
                        <td class='source'>          end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>179</td>
                        <td class='hits'></td>
                        <td class='source'>        end),</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>180</td>
                        <td class='hits'>5</td>
                        <td class='source'>      true &lt;- Map.get(payload, &quot;customParameters&quot;, %{}) |&gt; Map.has_key?(&quot;device_id&quot;),</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>181</td>
                        <td class='hits'>5</td>
                        <td class='source'>      true &lt;- Map.get(payload, &quot;result&quot;, %{}) |&gt; Map.has_key?(&quot;description&quot;)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>182</td>
                        <td class='hits'></td>
                        <td class='source'>    ) do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>183</td>
                        <td class='hits'></td>
                        <td class='source'>      true</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>184</td>
                        <td class='hits'></td>
                        <td class='source'>    else</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>185</td>
                        <td class='hits'></td>
                        <td class='source'>      _ -&gt;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>186</td>
                        <td class='hits'></td>
                        <td class='source'>        false</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>187</td>
                        <td class='hits'></td>
                        <td class='source'>    end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>188</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>189</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>190</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>191</td>
                        <td class='hits'></td>
                        <td class='source'>    Action that informs the server that the user left the park</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>192</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>193</td>
                        <td class='hits'></td>
                        <td class='source'>  def close(conn, _params) do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>194</td>
                        <td class='hits'>1</td>
                        <td class='source'>    with(</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>195</td>
                        <td class='hits'>4</td>
                        <td class='source'>      device &lt;- Auth.get_current_session_device(conn),</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>196</td>
                        <td class='hits'>4</td>
                        <td class='source'>      reservation &lt;- ReservationsContext.get_current_reservation(device.device_id),</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>197</td>
                        <td class='hits'>4</td>
                        <td class='source'>      false &lt;- is_nil(reservation),</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>198</td>
                        <td class='hits'>3</td>
                        <td class='source'>      {:ok, _reservation} &lt;- ReservationsContext.move_to_closed_state(reservation)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>199</td>
                        <td class='hits'></td>
                        <td class='source'>    ) do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>200</td>
                        <td class='hits'></td>
                        <td class='source'>      {:ok, %{}}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>201</td>
                        <td class='hits'></td>
                        <td class='source'>    else</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>202</td>
                        <td class='hits'></td>
                        <td class='source'>      {:error, result} -&gt;</td>
                      </tr>
                  
                
                  
                      <tr class='miss'>
                        <td class='line'>203</td>
                        <td class='hits'>0</td>
                        <td class='source'>        Logger.warn(Poison.encode!(result))</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>204</td>
                        <td class='hits'></td>
                        <td class='source'>        {:bad_request, &quot;Invalid parameters&quot;}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>205</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>206</td>
                        <td class='hits'></td>
                        <td class='source'>      _error -&gt;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>207</td>
                        <td class='hits'></td>
                        <td class='source'>        {:bad_request, &quot;Something went wrong&quot;}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>208</td>
                        <td class='hits'></td>
                        <td class='source'>    end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>209</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>210</td>
                        <td class='hits'></td>
                        <td class='source'>end</td>
                      </tr>
                  
                
              </tbody>
            </table>
          </div>
        
          <div class='file'>
            <h2 id='lib/parkapp_web/controllers/routing_controller.ex'>lib/parkapp_web/controllers/routing_controller.ex</h1>
            <div id='stats' class='high'>
              <div class='percentage'>90</div>
              <div class='sloc'>10</div>
              <div class='hits'>1156</div>
              <div class='misses'>1</div>
            </div>
            <table id='source'>
              <thead>
                <tr>
                  <th>Line</th>
                  <th>Hits</th>
                  <th>Source</th>
                </tr>
              <tbody>
                
                  
                      <tr>
                        <td class='line'>0</td>
                        <td class='hits'></td>
                        <td class='source'>defmodule ParkappWeb.RoutingController do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>1</td>
                        <td class='hits'></td>
                        <td class='source'>  @moduledoc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>2</td>
                        <td class='hits'></td>
                        <td class='source'>    The RoutingController handles the routing related requests.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>3</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>4</td>
                        <td class='hits'></td>
                        <td class='source'>  use ParkappWeb, :controller</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>5</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>6</td>
                        <td class='hits'></td>
                        <td class='source'>  alias ParkappWeb.Utils</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>7</td>
                        <td class='hits'></td>
                        <td class='source'>  alias ParkappWeb.ApiIntegration.Embers.Helpers</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>8</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>9</td>
                        <td class='hits'></td>
                        <td class='source'>  # Add an error handler controller</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>10</td>
                        <td class='hits'></td>
                        <td class='source'>  action_fallback(ParkappWeb.FallbackController)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>11</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>12</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>13</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>14</td>
                        <td class='hits'></td>
                        <td class='source'>    Returns the itinerary between the from and to geo_points.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>15</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>16</td>
                        <td class='hits'></td>
                        <td class='source'>  def route(_conn, %{&quot;from&quot; =&gt; &quot;null&quot;}) do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>17</td>
                        <td class='hits'></td>
                        <td class='source'>    {:bad_request, &quot;From cannot be null&quot;}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>18</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>19</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>20</td>
                        <td class='hits'></td>
                        <td class='source'>  def route(_conn, %{&quot;to&quot; =&gt; &quot;null&quot;}) do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>21</td>
                        <td class='hits'></td>
                        <td class='source'>    {:bad_request, &quot;To cannot be null&quot;}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>22</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>23</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>24</td>
                        <td class='hits'></td>
                        <td class='source'>  def route(_conn, %{&quot;mode&quot; =&gt; &quot;null&quot;}) do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>25</td>
                        <td class='hits'></td>
                        <td class='source'>    {:bad_request, &quot;Mode cannot be null&quot;}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>26</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>27</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>28</td>
                        <td class='hits'></td>
                        <td class='source'>  def route(_conn, %{&quot;from&quot; =&gt; from, &quot;to&quot; =&gt; to, &quot;mode&quot; =&gt; mode}) do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>29</td>
                        <td class='hits'>1</td>
                        <td class='source'>    module = Helpers.get_api_module()</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>30</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>31</td>
                        <td class='hits'>1</td>
                        <td class='source'>    case module.get_route(</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>32</td>
                        <td class='hits'></td>
                        <td class='source'>           from,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>33</td>
                        <td class='hits'></td>
                        <td class='source'>           to,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>34</td>
                        <td class='hits'></td>
                        <td class='source'>           mode</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>35</td>
                        <td class='hits'></td>
                        <td class='source'>         ) do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>36</td>
                        <td class='hits'></td>
                        <td class='source'>      nil -&gt;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>37</td>
                        <td class='hits'></td>
                        <td class='source'>        {:bad_request, &quot;Something went wrong&quot;}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>38</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>39</td>
                        <td class='hits'></td>
                        <td class='source'>      {:error, result} -&gt;</td>
                      </tr>
                  
                
                  
                      <tr class='miss'>
                        <td class='line'>40</td>
                        <td class='hits'>0</td>
                        <td class='source'>        Logger.warn(Poison.encode!(result))</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>41</td>
                        <td class='hits'></td>
                        <td class='source'>        {:bad_request, &quot;Invalid parameters&quot;}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>42</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>43</td>
                        <td class='hits'></td>
                        <td class='source'>      {:ok, result} -&gt;</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>44</td>
                        <td class='hits'>1</td>
                        <td class='source'>        result =</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>45</td>
                        <td class='hits'></td>
                        <td class='source'>          Map.get(result, &quot;plan&quot;, %{})</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>46</td>
                        <td class='hits'></td>
                        <td class='source'>          |&gt; Map.get(&quot;itineraries&quot;, [])</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>47</td>
                        <td class='hits'></td>
                        <td class='source'>          |&gt; List.first()</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>48</td>
                        <td class='hits'></td>
                        <td class='source'>          |&gt; get_route_legs()</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>49</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>50</td>
                        <td class='hits'></td>
                        <td class='source'>        {:ok, %{itinerary: result}}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>51</td>
                        <td class='hits'></td>
                        <td class='source'>    end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>52</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>53</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>54</td>
                        <td class='hits'></td>
                        <td class='source'>  def route(_conn, _params) do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>55</td>
                        <td class='hits'></td>
                        <td class='source'>    {:generic_unprocessable_entity, &quot;Invalid parameters&quot;}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>56</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>57</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>58</td>
                        <td class='hits'></td>
                        <td class='source'>  defp get_route_legs(nil) do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>59</td>
                        <td class='hits'></td>
                        <td class='source'>    []</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>60</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>61</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>62</td>
                        <td class='hits'></td>
                        <td class='source'>  defp get_route_legs(itinerary) do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>63</td>
                        <td class='hits'></td>
                        <td class='source'>    Map.get(itinerary, &quot;legs&quot;, [])</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>64</td>
                        <td class='hits'>1</td>
                        <td class='source'>    |&gt; Enum.map(fn leg -&gt;</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>65</td>
                        <td class='hits'>1</td>
                        <td class='source'>      route =</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>66</td>
                        <td class='hits'></td>
                        <td class='source'>        Map.get(leg, &quot;route&quot;, &quot;&quot;)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>67</td>
                        <td class='hits'></td>
                        <td class='source'>        |&gt; Polyline.decode()</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>68</td>
                        <td class='hits'></td>
                        <td class='source'>        |&gt; Enum.map(fn {long, lat} -&gt;</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>69</td>
                        <td class='hits'>230</td>
                        <td class='source'>          %{</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>70</td>
                        <td class='hits'></td>
                        <td class='source'>            lat: format_geo_point_value(lat),</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>71</td>
                        <td class='hits'></td>
                        <td class='source'>            long: format_geo_point_value(long)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>72</td>
                        <td class='hits'></td>
                        <td class='source'>          }</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>73</td>
                        <td class='hits'></td>
                        <td class='source'>        end)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>74</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>75</td>
                        <td class='hits'>1</td>
                        <td class='source'>      Map.put(leg, &quot;route&quot;, route)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>76</td>
                        <td class='hits'></td>
                        <td class='source'>    end)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>77</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>78</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>79</td>
                        <td class='hits'></td>
                        <td class='source'>  defp format_geo_point_value(value) do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>80</td>
                        <td class='hits'>460</td>
                        <td class='source'>    Utils.parse_string_to_float(&quot;#{value}&quot;)</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>81</td>
                        <td class='hits'>460</td>
                        <td class='source'>    |&gt; Utils.format_float_decimal_places(5)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>82</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>83</td>
                        <td class='hits'></td>
                        <td class='source'>end</td>
                      </tr>
                  
                
              </tbody>
            </table>
          </div>
        
          <div class='file'>
            <h2 id='lib/parkapp_web/endpoint.ex'>lib/parkapp_web/endpoint.ex</h1>
            <div id='stats' class='medium'>
              <div class='percentage'>50</div>
              <div class='sloc'>2</div>
              <div class='hits'>1</div>
              <div class='misses'>1</div>
            </div>
            <table id='source'>
              <thead>
                <tr>
                  <th>Line</th>
                  <th>Hits</th>
                  <th>Source</th>
                </tr>
              <tbody>
                
                  
                      <tr>
                        <td class='line'>0</td>
                        <td class='hits'></td>
                        <td class='source'>defmodule ParkappWeb.Endpoint do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>1</td>
                        <td class='hits'></td>
                        <td class='source'>  use Phoenix.Endpoint, otp_app: :parkapp</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>2</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>3</td>
                        <td class='hits'></td>
                        <td class='source'>  socket &quot;/socket&quot;, ParkappWeb.UserSocket</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>4</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>5</td>
                        <td class='hits'></td>
                        <td class='source'>  # Serve at &quot;/&quot; the static files from &quot;priv/static&quot; directory.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>6</td>
                        <td class='hits'></td>
                        <td class='source'>  #</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>7</td>
                        <td class='hits'></td>
                        <td class='source'>  # You should set gzip to true if you are running phoenix.digest</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>8</td>
                        <td class='hits'></td>
                        <td class='source'>  # when deploying your static files in production.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>9</td>
                        <td class='hits'></td>
                        <td class='source'>  plug Plug.Static,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>10</td>
                        <td class='hits'></td>
                        <td class='source'>    at: &quot;/&quot;, from: :parkapp, gzip: false,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>11</td>
                        <td class='hits'></td>
                        <td class='source'>    only: ~w(css fonts images js favicon.ico robots.txt)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>12</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>13</td>
                        <td class='hits'></td>
                        <td class='source'>  # Code reloading can be explicitly enabled under the</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>14</td>
                        <td class='hits'></td>
                        <td class='source'>  # :code_reloader configuration of your endpoint.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>15</td>
                        <td class='hits'></td>
                        <td class='source'>  if code_reloading? do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>16</td>
                        <td class='hits'></td>
                        <td class='source'>    socket &quot;/phoenix/live_reload/socket&quot;, Phoenix.LiveReloader.Socket</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>17</td>
                        <td class='hits'></td>
                        <td class='source'>    plug Phoenix.LiveReloader</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>18</td>
                        <td class='hits'></td>
                        <td class='source'>    plug Phoenix.CodeReloader</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>19</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>20</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>21</td>
                        <td class='hits'></td>
                        <td class='source'>  plug Plug.Logger</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>22</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>23</td>
                        <td class='hits'></td>
                        <td class='source'>  plug Plug.Parsers,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>24</td>
                        <td class='hits'></td>
                        <td class='source'>    parsers: [:urlencoded, :multipart, :json],</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>25</td>
                        <td class='hits'></td>
                        <td class='source'>    pass: [&quot;*/*&quot;],</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>26</td>
                        <td class='hits'></td>
                        <td class='source'>    json_decoder: Poison</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>27</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>28</td>
                        <td class='hits'></td>
                        <td class='source'>  plug Plug.MethodOverride</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>29</td>
                        <td class='hits'></td>
                        <td class='source'>  plug Plug.Head</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>30</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>31</td>
                        <td class='hits'></td>
                        <td class='source'>  # The session will be stored in the cookie and signed,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>32</td>
                        <td class='hits'></td>
                        <td class='source'>  # this means its contents can be read but not tampered with.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>33</td>
                        <td class='hits'></td>
                        <td class='source'>  # Set :encryption_salt if you would also like to encrypt it.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>34</td>
                        <td class='hits'></td>
                        <td class='source'>  plug Plug.Session,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>35</td>
                        <td class='hits'></td>
                        <td class='source'>    store: :cookie,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>36</td>
                        <td class='hits'></td>
                        <td class='source'>    key: &quot;_parkapp_key&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>37</td>
                        <td class='hits'></td>
                        <td class='source'>    signing_salt: &quot;GVPcroun&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>38</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>39</td>
                        <td class='hits'></td>
                        <td class='source'>  plug ParkappWeb.Router</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>40</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>41</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>42</td>
                        <td class='hits'></td>
                        <td class='source'>  Callback invoked for dynamically configuring the endpoint.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>43</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>44</td>
                        <td class='hits'></td>
                        <td class='source'>  It receives the endpoint configuration and checks if</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>45</td>
                        <td class='hits'></td>
                        <td class='source'>  configuration should be loaded from the system environment.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>46</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>47</td>
                        <td class='hits'></td>
                        <td class='source'>  def init(_key, config) do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>48</td>
                        <td class='hits'>1</td>
                        <td class='source'>    if config[:load_from_system_env] do</td>
                      </tr>
                    
                
                  
                      <tr class='miss'>
                        <td class='line'>49</td>
                        <td class='hits'>0</td>
                        <td class='source'>      port = System.get_env(&quot;PORT&quot;) || raise &quot;expected the PORT environment variable to be set&quot;</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>50</td>
                        <td class='hits'></td>
                        <td class='source'>      {:ok, Keyword.put(config, :http, [:inet6, port: port])}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>51</td>
                        <td class='hits'></td>
                        <td class='source'>    else</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>52</td>
                        <td class='hits'></td>
                        <td class='source'>      {:ok, config}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>53</td>
                        <td class='hits'></td>
                        <td class='source'>    end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>54</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>55</td>
                        <td class='hits'></td>
                        <td class='source'>end</td>
                      </tr>
                  
                
              </tbody>
            </table>
          </div>
        
          <div class='file'>
            <h2 id='lib/parkapp_web/gettext.ex'>lib/parkapp_web/gettext.ex</h1>
            <div id='stats' class='terrible'>
              <div class='percentage'>0</div>
              <div class='sloc'>0</div>
              <div class='hits'>0</div>
              <div class='misses'>0</div>
            </div>
            <table id='source'>
              <thead>
                <tr>
                  <th>Line</th>
                  <th>Hits</th>
                  <th>Source</th>
                </tr>
              <tbody>
                
                  
                      <tr>
                        <td class='line'>0</td>
                        <td class='hits'></td>
                        <td class='source'>defmodule ParkappWeb.Gettext do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>1</td>
                        <td class='hits'></td>
                        <td class='source'>  @moduledoc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>2</td>
                        <td class='hits'></td>
                        <td class='source'>  A module providing Internationalization with a gettext-based API.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>3</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>4</td>
                        <td class='hits'></td>
                        <td class='source'>  By using [Gettext](https://hexdocs.pm/gettext),</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>5</td>
                        <td class='hits'></td>
                        <td class='source'>  your module gains a set of macros for translations, for example:</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>6</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>7</td>
                        <td class='hits'></td>
                        <td class='source'>      import ParkappWeb.Gettext</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>8</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>9</td>
                        <td class='hits'></td>
                        <td class='source'>      # Simple translation</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>10</td>
                        <td class='hits'></td>
                        <td class='source'>      gettext &quot;Here is the string to translate&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>11</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>12</td>
                        <td class='hits'></td>
                        <td class='source'>      # Plural translation</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>13</td>
                        <td class='hits'></td>
                        <td class='source'>      ngettext &quot;Here is the string to translate&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>14</td>
                        <td class='hits'></td>
                        <td class='source'>               &quot;Here are the strings to translate&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>15</td>
                        <td class='hits'></td>
                        <td class='source'>               3</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>16</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>17</td>
                        <td class='hits'></td>
                        <td class='source'>      # Domain-based translation</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>18</td>
                        <td class='hits'></td>
                        <td class='source'>      dgettext &quot;errors&quot;, &quot;Here is the error message to translate&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>19</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>20</td>
                        <td class='hits'></td>
                        <td class='source'>  See the [Gettext Docs](https://hexdocs.pm/gettext) for detailed usage.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>21</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>22</td>
                        <td class='hits'></td>
                        <td class='source'>  use Gettext, otp_app: :parkapp</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>23</td>
                        <td class='hits'></td>
                        <td class='source'>end</td>
                      </tr>
                  
                
              </tbody>
            </table>
          </div>
        
          <div class='file'>
            <h2 id='lib/parkapp_web/router.ex'>lib/parkapp_web/router.ex</h1>
            <div id='stats' class='high'>
              <div class='percentage'>94.1</div>
              <div class='sloc'>17</div>
              <div class='hits'>309</div>
              <div class='misses'>1</div>
            </div>
            <table id='source'>
              <thead>
                <tr>
                  <th>Line</th>
                  <th>Hits</th>
                  <th>Source</th>
                </tr>
              <tbody>
                
                  
                      <tr>
                        <td class='line'>0</td>
                        <td class='hits'></td>
                        <td class='source'>defmodule ParkappWeb.Router do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>1</td>
                        <td class='hits'></td>
                        <td class='source'>  use ParkappWeb, :router</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>2</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr class='miss'>
                        <td class='line'>3</td>
                        <td class='hits'>0</td>
                        <td class='source'>  pipeline :browser do</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>4</td>
                        <td class='hits'></td>
                        <td class='source'>    plug :accepts, [&quot;html&quot;]</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>5</td>
                        <td class='hits'></td>
                        <td class='source'>    plug :fetch_session</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>6</td>
                        <td class='hits'></td>
                        <td class='source'>    plug :fetch_flash</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>7</td>
                        <td class='hits'></td>
                        <td class='source'>    plug :protect_from_forgery</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>8</td>
                        <td class='hits'></td>
                        <td class='source'>    plug :put_secure_browser_headers</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>9</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>10</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>11</td>
                        <td class='hits'>103</td>
                        <td class='source'>  pipeline :api do</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>12</td>
                        <td class='hits'></td>
                        <td class='source'>    plug :accepts, [&quot;json&quot;]</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>13</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>14</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>15</td>
                        <td class='hits'>51</td>
                        <td class='source'>  pipeline :unauthorized do</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>16</td>
                        <td class='hits'></td>
                        <td class='source'>    plug :fetch_session</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>17</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>18</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>19</td>
                        <td class='hits'>52</td>
                        <td class='source'>  pipeline :authorized do</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>20</td>
                        <td class='hits'></td>
                        <td class='source'>    plug ParkappWeb.Auth.GuardianPipeline</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>21</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>22</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>23</td>
                        <td class='hits'></td>
                        <td class='source'>  # New scope we will be using</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>24</td>
                        <td class='hits'></td>
                        <td class='source'>  scope &quot;/api/v1&quot;, ParkappWeb do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>25</td>
                        <td class='hits'></td>
                        <td class='source'>    pipe_through :api</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>26</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>27</td>
                        <td class='hits'></td>
                        <td class='source'>    scope &quot;/account&quot; do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>28</td>
                        <td class='hits'></td>
                        <td class='source'>      scope &quot;/&quot; do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>29</td>
                        <td class='hits'></td>
                        <td class='source'>        pipe_through :unauthorized</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>30</td>
                        <td class='hits'>7</td>
                        <td class='source'>        put &quot;/register&quot;, AuthenticationController, :register</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>31</td>
                        <td class='hits'>4</td>
                        <td class='source'>        post &quot;/authenticate_phase1&quot;, AuthenticationController, :authenticate_phase1</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>32</td>
                        <td class='hits'>33</td>
                        <td class='source'>        post &quot;/authenticate_phase2&quot;, AuthenticationController, :authenticate_phase2</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>33</td>
                        <td class='hits'></td>
                        <td class='source'>      end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>34</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>35</td>
                        <td class='hits'></td>
                        <td class='source'>      scope &quot;/&quot; do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>36</td>
                        <td class='hits'></td>
                        <td class='source'>        pipe_through :authorized</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>37</td>
                        <td class='hits'>2</td>
                        <td class='source'>        post &quot;/logout&quot;, AuthenticationController, :logout</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>38</td>
                        <td class='hits'>4</td>
                        <td class='source'>        get &quot;/verify_token&quot;, AuthenticationController, :verify_token</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>39</td>
                        <td class='hits'></td>
                        <td class='source'>      end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>40</td>
                        <td class='hits'></td>
                        <td class='source'>    end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>41</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>42</td>
                        <td class='hits'></td>
                        <td class='source'>    scope &quot;/routing&quot; do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>43</td>
                        <td class='hits'></td>
                        <td class='source'>      pipe_through :authorized</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>44</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>45</td>
                        <td class='hits'>5</td>
                        <td class='source'>      get &quot;/route&quot;, RoutingController, :route</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>46</td>
                        <td class='hits'></td>
                        <td class='source'>    end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>47</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>48</td>
                        <td class='hits'></td>
                        <td class='source'>    scope &quot;/reservation&quot; do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>49</td>
                        <td class='hits'></td>
                        <td class='source'>      pipe_through :authorized</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>50</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>51</td>
                        <td class='hits'>3</td>
                        <td class='source'>      get &quot;/current&quot;, ReservationController, :get_current_reservation</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>52</td>
                        <td class='hits'>3</td>
                        <td class='source'>      get &quot;/current/payment&quot;, ReservationController, :get_current_reservation_payment</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>53</td>
                        <td class='hits'>10</td>
                        <td class='source'>      post &quot;/reserve&quot;, ReservationController, :reserve</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>54</td>
                        <td class='hits'>9</td>
                        <td class='source'>      put &quot;/in_park&quot;, ReservationController, :in_park</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>55</td>
                        <td class='hits'>10</td>
                        <td class='source'>      post &quot;/pay&quot;, ReservationController, :pay</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>56</td>
                        <td class='hits'>6</td>
                        <td class='source'>      put &quot;/close&quot;, ReservationController, :close</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>57</td>
                        <td class='hits'></td>
                        <td class='source'>    end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>58</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>59</td>
                        <td class='hits'></td>
                        <td class='source'>    scope &quot;/webhooks&quot; do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>60</td>
                        <td class='hits'></td>
                        <td class='source'>      pipe_through :unauthorized</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>61</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>62</td>
                        <td class='hits'>7</td>
                        <td class='source'>      post &quot;/mbway&quot;, ReservationController, :complete_payment</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>63</td>
                        <td class='hits'></td>
                        <td class='source'>    end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>64</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>65</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>66</td>
                        <td class='hits'></td>
                        <td class='source'>  # Other scopes may use custom stacks.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>67</td>
                        <td class='hits'></td>
                        <td class='source'>  # scope &quot;/api&quot;, ParkappWeb do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>68</td>
                        <td class='hits'></td>
                        <td class='source'>  #   pipe_through :api</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>69</td>
                        <td class='hits'></td>
                        <td class='source'>  # end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>70</td>
                        <td class='hits'></td>
                        <td class='source'>end</td>
                      </tr>
                  
                
              </tbody>
            </table>
          </div>
        
          <div class='file'>
            <h2 id='lib/parkapp_web/utils.ex'>lib/parkapp_web/utils.ex</h1>
            <div id='stats' class='high'>
              <div class='percentage'>100</div>
              <div class='sloc'>5</div>
              <div class='hits'>2369</div>
              <div class='misses'>0</div>
            </div>
            <table id='source'>
              <thead>
                <tr>
                  <th>Line</th>
                  <th>Hits</th>
                  <th>Source</th>
                </tr>
              <tbody>
                
                  
                      <tr>
                        <td class='line'>0</td>
                        <td class='hits'></td>
                        <td class='source'>defmodule ParkappWeb.Utils do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>1</td>
                        <td class='hits'></td>
                        <td class='source'>  @moduledoc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>2</td>
                        <td class='hits'></td>
                        <td class='source'>    The Utils module contains generic methods to be used from the ParkappWeb</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>3</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>4</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>5</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>6</td>
                        <td class='hits'></td>
                        <td class='source'>    Generates a random string of the given length</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>7</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>8</td>
                        <td class='hits'></td>
                        <td class='source'>  @spec random_string(Integer) :: String</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>9</td>
                        <td class='hits'></td>
                        <td class='source'>  def random_string(length) do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>10</td>
                        <td class='hits'></td>
                        <td class='source'>    :crypto.strong_rand_bytes(length)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>11</td>
                        <td class='hits'></td>
                        <td class='source'>    |&gt; Base.url_encode64()</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>12</td>
                        <td class='hits'>52</td>
                        <td class='source'>    |&gt; binary_part(0, length)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>13</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>14</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>15</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>16</td>
                        <td class='hits'></td>
                        <td class='source'>  Formats a flot with the given number of decimal places.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>17</td>
                        <td class='hits'></td>
                        <td class='source'>  If the value is not a flot, it is returned as a string.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>18</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>19</td>
                        <td class='hits'></td>
                        <td class='source'>  @spec format_float_decimal_places(Float, Integer) :: String</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>20</td>
                        <td class='hits'></td>
                        <td class='source'>  def format_float_decimal_places(float, num_decimal_places)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>21</td>
                        <td class='hits'></td>
                        <td class='source'>      when is_float(float) and is_integer(num_decimal_places) do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>22</td>
                        <td class='hits'></td>
                        <td class='source'>    :erlang.float_to_binary(float, decimals: num_decimal_places)</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>23</td>
                        <td class='hits'>463</td>
                        <td class='source'>    |&gt; parse_string_to_float()</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>24</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>25</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>26</td>
                        <td class='hits'>3</td>
                        <td class='source'>  def format_float_decimal_places(value, _num_decimal_places), do: &quot;#{value}&quot;</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>27</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>28</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>29</td>
                        <td class='hits'></td>
                        <td class='source'>    Parses the given string to float. It is not a string, nil is returned</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>30</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>31</td>
                        <td class='hits'></td>
                        <td class='source'>  @spec parse_string_to_float(String) :: Float | nil</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>32</td>
                        <td class='hits'></td>
                        <td class='source'>  def parse_string_to_float(value) when is_bitstring(value) do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>33</td>
                        <td class='hits'>926</td>
                        <td class='source'>    case Float.parse(value) do</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>34</td>
                        <td class='hits'></td>
                        <td class='source'>      :error -&gt;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>35</td>
                        <td class='hits'></td>
                        <td class='source'>        nil</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>36</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>37</td>
                        <td class='hits'></td>
                        <td class='source'>      {float, _rest} -&gt;</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>38</td>
                        <td class='hits'>925</td>
                        <td class='source'>        float</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>39</td>
                        <td class='hits'></td>
                        <td class='source'>    end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>40</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>41</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>42</td>
                        <td class='hits'></td>
                        <td class='source'>  def parse_string_to_float(_value), do: nil</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>43</td>
                        <td class='hits'></td>
                        <td class='source'>end</td>
                      </tr>
                  
                
              </tbody>
            </table>
          </div>
        
          <div class='file'>
            <h2 id='lib/parkapp_web/views/changeset_view.ex'>lib/parkapp_web/views/changeset_view.ex</h1>
            <div id='stats' class='high'>
              <div class='percentage'>100</div>
              <div class='sloc'>3</div>
              <div class='hits'>4</div>
              <div class='misses'>0</div>
            </div>
            <table id='source'>
              <thead>
                <tr>
                  <th>Line</th>
                  <th>Hits</th>
                  <th>Source</th>
                </tr>
              <tbody>
                
                  
                      <tr>
                        <td class='line'>0</td>
                        <td class='hits'></td>
                        <td class='source'>defmodule ParkappWeb.ChangesetView do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>1</td>
                        <td class='hits'></td>
                        <td class='source'>  use ParkappWeb, :view</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>2</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>3</td>
                        <td class='hits'></td>
                        <td class='source'>  require Logger</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>4</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>5</td>
                        <td class='hits'></td>
                        <td class='source'>  def render(&quot;error.json&quot;, %{changeset: changeset}) do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>6</td>
                        <td class='hits'></td>
                        <td class='source'>    # When encoded, the changeset returns its errors</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>7</td>
                        <td class='hits'></td>
                        <td class='source'>    # as a JSON object. So we just pass it forward.</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>8</td>
                        <td class='hits'>1</td>
                        <td class='source'>    Logger.error(Poison.encode!(%{error: translate_errors(changeset)}))</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>9</td>
                        <td class='hits'>1</td>
                        <td class='source'>    %{error: translate_errors(changeset)}</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>10</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>11</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>12</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>13</td>
                        <td class='hits'></td>
                        <td class='source'>  Traverses and translates changeset errors.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>14</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>15</td>
                        <td class='hits'></td>
                        <td class='source'>  See `Ecto.Changeset.traverse_errors/2` and</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>16</td>
                        <td class='hits'></td>
                        <td class='source'>  `ParkappWeb.ErrorHelpers.translate_error/1` for more details.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>17</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>18</td>
                        <td class='hits'></td>
                        <td class='source'>  defp translate_errors(changeset) do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>19</td>
                        <td class='hits'>2</td>
                        <td class='source'>    Ecto.Changeset.traverse_errors(</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>20</td>
                        <td class='hits'></td>
                        <td class='source'>      changeset,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>21</td>
                        <td class='hits'></td>
                        <td class='source'>      &amp;translate_error/1</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>22</td>
                        <td class='hits'></td>
                        <td class='source'>    )</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>23</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>24</td>
                        <td class='hits'></td>
                        <td class='source'>end</td>
                      </tr>
                  
                
              </tbody>
            </table>
          </div>
        
          <div class='file'>
            <h2 id='lib/parkapp_web/views/error_helpers.ex'>lib/parkapp_web/views/error_helpers.ex</h1>
            <div id='stats' class='low'>
              <div class='percentage'>40</div>
              <div class='sloc'>5</div>
              <div class='hits'>4</div>
              <div class='misses'>3</div>
            </div>
            <table id='source'>
              <thead>
                <tr>
                  <th>Line</th>
                  <th>Hits</th>
                  <th>Source</th>
                </tr>
              <tbody>
                
                  
                      <tr>
                        <td class='line'>0</td>
                        <td class='hits'></td>
                        <td class='source'>defmodule ParkappWeb.ErrorHelpers do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>1</td>
                        <td class='hits'></td>
                        <td class='source'>  @moduledoc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>2</td>
                        <td class='hits'></td>
                        <td class='source'>  Conveniences for translating and building error messages.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>3</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>4</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>5</td>
                        <td class='hits'></td>
                        <td class='source'>  use Phoenix.HTML</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>6</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>7</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>8</td>
                        <td class='hits'></td>
                        <td class='source'>  Generates tag for inlined form input errors.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>9</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>10</td>
                        <td class='hits'></td>
                        <td class='source'>  def error_tag(form, field) do</td>
                      </tr>
                  
                
                  
                      <tr class='miss'>
                        <td class='line'>11</td>
                        <td class='hits'>0</td>
                        <td class='source'>    Enum.map(Keyword.get_values(form.errors, field), fn (error) -&gt;</td>
                      </tr>
                    
                
                  
                      <tr class='miss'>
                        <td class='line'>12</td>
                        <td class='hits'>0</td>
                        <td class='source'>      content_tag :span, translate_error(error), class: &quot;help-block&quot;</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>13</td>
                        <td class='hits'></td>
                        <td class='source'>    end)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>14</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>15</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>16</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>17</td>
                        <td class='hits'></td>
                        <td class='source'>  Translates an error message using gettext.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>18</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>19</td>
                        <td class='hits'></td>
                        <td class='source'>  def translate_error({msg, opts}) do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>20</td>
                        <td class='hits'></td>
                        <td class='source'>    # When using gettext, we typically pass the strings we want</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>21</td>
                        <td class='hits'></td>
                        <td class='source'>    # to translate as a static argument:</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>22</td>
                        <td class='hits'></td>
                        <td class='source'>    #</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>23</td>
                        <td class='hits'></td>
                        <td class='source'>    #     # Translate &quot;is invalid&quot; in the &quot;errors&quot; domain</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>24</td>
                        <td class='hits'></td>
                        <td class='source'>    #     dgettext &quot;errors&quot;, &quot;is invalid&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>25</td>
                        <td class='hits'></td>
                        <td class='source'>    #</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>26</td>
                        <td class='hits'></td>
                        <td class='source'>    #     # Translate the number of files with plural rules</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>27</td>
                        <td class='hits'></td>
                        <td class='source'>    #     dngettext &quot;errors&quot;, &quot;1 file&quot;, &quot;%{count} files&quot;, count</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>28</td>
                        <td class='hits'></td>
                        <td class='source'>    #</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>29</td>
                        <td class='hits'></td>
                        <td class='source'>    # Because the error messages we show in our forms and APIs</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>30</td>
                        <td class='hits'></td>
                        <td class='source'>    # are defined inside Ecto, we need to translate them dynamically.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>31</td>
                        <td class='hits'></td>
                        <td class='source'>    # This requires us to call the Gettext module passing our gettext</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>32</td>
                        <td class='hits'></td>
                        <td class='source'>    # backend as first argument.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>33</td>
                        <td class='hits'></td>
                        <td class='source'>    #</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>34</td>
                        <td class='hits'></td>
                        <td class='source'>    # Note we use the &quot;errors&quot; domain, which means translations</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>35</td>
                        <td class='hits'></td>
                        <td class='source'>    # should be written to the errors.po file. The :count option is</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>36</td>
                        <td class='hits'></td>
                        <td class='source'>    # set by Ecto and indicates we should also apply plural rules.</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>37</td>
                        <td class='hits'>2</td>
                        <td class='source'>    if count = opts[:count] do</td>
                      </tr>
                    
                
                  
                      <tr class='miss'>
                        <td class='line'>38</td>
                        <td class='hits'>0</td>
                        <td class='source'>      Gettext.dngettext(ParkappWeb.Gettext, &quot;errors&quot;, msg, msg, count, opts)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>39</td>
                        <td class='hits'></td>
                        <td class='source'>    else</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>40</td>
                        <td class='hits'>2</td>
                        <td class='source'>      Gettext.dgettext(ParkappWeb.Gettext, &quot;errors&quot;, msg, opts)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>41</td>
                        <td class='hits'></td>
                        <td class='source'>    end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>42</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>43</td>
                        <td class='hits'></td>
                        <td class='source'>end</td>
                      </tr>
                  
                
              </tbody>
            </table>
          </div>
        
          <div class='file'>
            <h2 id='lib/parkapp_web/views/error_view.ex'>lib/parkapp_web/views/error_view.ex</h1>
            <div id='stats' class='high'>
              <div class='percentage'>100</div>
              <div class='sloc'>2</div>
              <div class='hits'>30</div>
              <div class='misses'>0</div>
            </div>
            <table id='source'>
              <thead>
                <tr>
                  <th>Line</th>
                  <th>Hits</th>
                  <th>Source</th>
                </tr>
              <tbody>
                
                  
                      <tr>
                        <td class='line'>0</td>
                        <td class='hits'></td>
                        <td class='source'>defmodule ParkappWeb.ErrorView do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>1</td>
                        <td class='hits'></td>
                        <td class='source'>  use ParkappWeb, :view</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>2</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>3</td>
                        <td class='hits'></td>
                        <td class='source'>  def render(&quot;error.json&quot;, %{message: message}) do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>4</td>
                        <td class='hits'>28</td>
                        <td class='source'>    %{error: message}</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>5</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>6</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>7</td>
                        <td class='hits'></td>
                        <td class='source'>  # By default, Phoenix returns the status message from</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>8</td>
                        <td class='hits'></td>
                        <td class='source'>  # the template name. For example, &quot;404.html&quot; becomes</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>9</td>
                        <td class='hits'></td>
                        <td class='source'>  # &quot;Not Found&quot;.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>10</td>
                        <td class='hits'></td>
                        <td class='source'>  def template_not_found(template, _assigns) do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>11</td>
                        <td class='hits'>2</td>
                        <td class='source'>    Phoenix.Controller.status_message_from_template(template)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>12</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>13</td>
                        <td class='hits'></td>
                        <td class='source'>end</td>
                      </tr>
                  
                
              </tbody>
            </table>
          </div>
        
          <div class='file'>
            <h2 id='lib/parkapp_web/views/layout_view.ex'>lib/parkapp_web/views/layout_view.ex</h1>
            <div id='stats' class='terrible'>
              <div class='percentage'>0</div>
              <div class='sloc'>0</div>
              <div class='hits'>0</div>
              <div class='misses'>0</div>
            </div>
            <table id='source'>
              <thead>
                <tr>
                  <th>Line</th>
                  <th>Hits</th>
                  <th>Source</th>
                </tr>
              <tbody>
                
                  
                      <tr>
                        <td class='line'>0</td>
                        <td class='hits'></td>
                        <td class='source'>defmodule ParkappWeb.LayoutView do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>1</td>
                        <td class='hits'></td>
                        <td class='source'>  use ParkappWeb, :view</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>2</td>
                        <td class='hits'></td>
                        <td class='source'>end</td>
                      </tr>
                  
                
              </tbody>
            </table>
          </div>
        
          <div class='file'>
            <h2 id='lib/parkapp_web/views/reservation_view.ex'>lib/parkapp_web/views/reservation_view.ex</h1>
            <div id='stats' class='high'>
              <div class='percentage'>100</div>
              <div class='sloc'>11</div>
              <div class='hits'>11</div>
              <div class='misses'>0</div>
            </div>
            <table id='source'>
              <thead>
                <tr>
                  <th>Line</th>
                  <th>Hits</th>
                  <th>Source</th>
                </tr>
              <tbody>
                
                  
                      <tr>
                        <td class='line'>0</td>
                        <td class='hits'></td>
                        <td class='source'>defmodule ParkappWeb.ReservationView do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>1</td>
                        <td class='hits'></td>
                        <td class='source'>  use ParkappWeb, :view</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>2</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>3</td>
                        <td class='hits'></td>
                        <td class='source'>  def render(&quot;reservation.json&quot;, %{reservation: reservation}) do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>4</td>
                        <td class='hits'>1</td>
                        <td class='source'>    %{</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>5</td>
                        <td class='hits'></td>
                        <td class='source'>      reservation: %{</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>6</td>
                        <td class='hits'>1</td>
                        <td class='source'>        barcode: reservation.barcode,</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>7</td>
                        <td class='hits'>1</td>
                        <td class='source'>        status: reservation.reservation_status_id,</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>8</td>
                        <td class='hits'>1</td>
                        <td class='source'>        type: reservation.reservation_type_id</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>9</td>
                        <td class='hits'></td>
                        <td class='source'>      }</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>10</td>
                        <td class='hits'></td>
                        <td class='source'>    }</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>11</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>12</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>13</td>
                        <td class='hits'></td>
                        <td class='source'>  def render(&quot;reservation_payment.json&quot;, %{reservation: reservation}) do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>14</td>
                        <td class='hits'>1</td>
                        <td class='source'>    %{</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>15</td>
                        <td class='hits'></td>
                        <td class='source'>      reservation: %{</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>16</td>
                        <td class='hits'>1</td>
                        <td class='source'>        barcode: reservation.barcode,</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>17</td>
                        <td class='hits'>1</td>
                        <td class='source'>        status: reservation.reservation_status_id,</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>18</td>
                        <td class='hits'>1</td>
                        <td class='source'>        type: reservation.reservation_type_id,</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>19</td>
                        <td class='hits'>1</td>
                        <td class='source'>        amount: format_amount(reservation.amount),</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>20</td>
                        <td class='hits'>1</td>
                        <td class='source'>        start_date: reservation.parking_start_time</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>21</td>
                        <td class='hits'></td>
                        <td class='source'>      }</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>22</td>
                        <td class='hits'></td>
                        <td class='source'>    }</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>23</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>24</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>25</td>
                        <td class='hits'></td>
                        <td class='source'>  @spec format_amount(String) :: String</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>26</td>
                        <td class='hits'></td>
                        <td class='source'>  defp format_amount(nil), do: &quot;0&quot;</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>27</td>
                        <td class='hits'>1</td>
                        <td class='source'>  defp format_amount(amount), do: amount</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>28</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>29</td>
                        <td class='hits'></td>
                        <td class='source'>  # defp convert_datetime_to_epoch_milliseconds(datetime) do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>30</td>
                        <td class='hits'></td>
                        <td class='source'>  #   IO.inspect(datetime, label: &quot;datetime&quot;)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>31</td>
                        <td class='hits'></td>
                        <td class='source'>  #   DateTime.to_unix(datetime, :milliseconds)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>32</td>
                        <td class='hits'></td>
                        <td class='source'>  #   |&gt; IO.inspect(label: &quot;datetime&quot;)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>33</td>
                        <td class='hits'></td>
                        <td class='source'>  # end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>34</td>
                        <td class='hits'></td>
                        <td class='source'>end</td>
                      </tr>
                  
                
              </tbody>
            </table>
          </div>
        
          <div class='file'>
            <h2 id='test/support/channel_case.ex'>test/support/channel_case.ex</h1>
            <div id='stats' class='high'>
              <div class='percentage'>100</div>
              <div class='sloc'>4</div>
              <div class='hits'>10</div>
              <div class='misses'>0</div>
            </div>
            <table id='source'>
              <thead>
                <tr>
                  <th>Line</th>
                  <th>Hits</th>
                  <th>Source</th>
                </tr>
              <tbody>
                
                  
                      <tr>
                        <td class='line'>0</td>
                        <td class='hits'></td>
                        <td class='source'>defmodule ParkappWeb.ChannelCase do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>1</td>
                        <td class='hits'></td>
                        <td class='source'>  @moduledoc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>2</td>
                        <td class='hits'></td>
                        <td class='source'>  This module defines the test case to be used by</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>3</td>
                        <td class='hits'></td>
                        <td class='source'>  channel tests.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>4</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>5</td>
                        <td class='hits'></td>
                        <td class='source'>  Such tests rely on `Phoenix.ChannelTest` and also</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>6</td>
                        <td class='hits'></td>
                        <td class='source'>  import other functionality to make it easier</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>7</td>
                        <td class='hits'></td>
                        <td class='source'>  to build common datastructures and query the data layer.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>8</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>9</td>
                        <td class='hits'></td>
                        <td class='source'>  Finally, if the test case interacts with the database,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>10</td>
                        <td class='hits'></td>
                        <td class='source'>  it cannot be async. For this reason, every test runs</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>11</td>
                        <td class='hits'></td>
                        <td class='source'>  inside a transaction which is reset at the beginning</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>12</td>
                        <td class='hits'></td>
                        <td class='source'>  of the test unless the test case is marked as async.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>13</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>14</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>15</td>
                        <td class='hits'></td>
                        <td class='source'>  use ExUnit.CaseTemplate</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>16</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>17</td>
                        <td class='hits'>1</td>
                        <td class='source'>  using do</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>18</td>
                        <td class='hits'></td>
                        <td class='source'>    quote do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>19</td>
                        <td class='hits'></td>
                        <td class='source'>      # Import conveniences for testing with channels</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>20</td>
                        <td class='hits'></td>
                        <td class='source'>      use Phoenix.ChannelTest</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>21</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>22</td>
                        <td class='hits'></td>
                        <td class='source'>      # The default endpoint for testing</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>23</td>
                        <td class='hits'></td>
                        <td class='source'>      @endpoint ParkappWeb.Endpoint</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>24</td>
                        <td class='hits'></td>
                        <td class='source'>    end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>25</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>26</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>27</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>28</td>
                        <td class='hits'></td>
                        <td class='source'>  setup tags do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>29</td>
                        <td class='hits'>3</td>
                        <td class='source'>    :ok = Ecto.Adapters.SQL.Sandbox.checkout(Parkapp.Repo)</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>30</td>
                        <td class='hits'>3</td>
                        <td class='source'>    unless tags[:async] do</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>31</td>
                        <td class='hits'>3</td>
                        <td class='source'>      Ecto.Adapters.SQL.Sandbox.mode(Parkapp.Repo, {:shared, self()})</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>32</td>
                        <td class='hits'></td>
                        <td class='source'>    end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>33</td>
                        <td class='hits'></td>
                        <td class='source'>    :ok</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>34</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>35</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>36</td>
                        <td class='hits'></td>
                        <td class='source'>end</td>
                      </tr>
                  
                
              </tbody>
            </table>
          </div>
        
          <div class='file'>
            <h2 id='test/support/conn_case.ex'>test/support/conn_case.ex</h1>
            <div id='stats' class='high'>
              <div class='percentage'>100</div>
              <div class='sloc'>23</div>
              <div class='hits'>494</div>
              <div class='misses'>0</div>
            </div>
            <table id='source'>
              <thead>
                <tr>
                  <th>Line</th>
                  <th>Hits</th>
                  <th>Source</th>
                </tr>
              <tbody>
                
                  
                      <tr>
                        <td class='line'>0</td>
                        <td class='hits'></td>
                        <td class='source'>defmodule ParkappWeb.ConnCase do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>1</td>
                        <td class='hits'></td>
                        <td class='source'>  @moduledoc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>2</td>
                        <td class='hits'></td>
                        <td class='source'>  This module defines the test case to be used by</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>3</td>
                        <td class='hits'></td>
                        <td class='source'>  tests that require setting up a connection.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>4</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>5</td>
                        <td class='hits'></td>
                        <td class='source'>  Such tests rely on `Phoenix.ConnTest` and also</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>6</td>
                        <td class='hits'></td>
                        <td class='source'>  import other functionality to make it easier</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>7</td>
                        <td class='hits'></td>
                        <td class='source'>  to build common datastructures and query the data layer.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>8</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>9</td>
                        <td class='hits'></td>
                        <td class='source'>  Finally, if the test case interacts with the database,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>10</td>
                        <td class='hits'></td>
                        <td class='source'>  it cannot be async. For this reason, every test runs</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>11</td>
                        <td class='hits'></td>
                        <td class='source'>  inside a transaction which is reset at the beginning</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>12</td>
                        <td class='hits'></td>
                        <td class='source'>  of the test unless the test case is marked as async.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>13</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>14</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>15</td>
                        <td class='hits'></td>
                        <td class='source'>  use ExUnit.CaseTemplate</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>16</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>17</td>
                        <td class='hits'>9</td>
                        <td class='source'>  using do</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>18</td>
                        <td class='hits'></td>
                        <td class='source'>    quote do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>19</td>
                        <td class='hits'></td>
                        <td class='source'>      # Import conveniences for testing with connections</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>20</td>
                        <td class='hits'></td>
                        <td class='source'>      use Phoenix.ConnTest</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>21</td>
                        <td class='hits'></td>
                        <td class='source'>      import ParkappWeb.Router.Helpers</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>22</td>
                        <td class='hits'></td>
                        <td class='source'>      import ParkappWeb.ConnCase</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>23</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>24</td>
                        <td class='hits'></td>
                        <td class='source'>      # The default endpoint for testing</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>25</td>
                        <td class='hits'></td>
                        <td class='source'>      @endpoint ParkappWeb.Endpoint</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>26</td>
                        <td class='hits'></td>
                        <td class='source'>    end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>27</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>28</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>29</td>
                        <td class='hits'></td>
                        <td class='source'>  setup tags do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>30</td>
                        <td class='hits'>95</td>
                        <td class='source'>    :ok = Ecto.Adapters.SQL.Sandbox.checkout(Parkapp.Repo)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>31</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>32</td>
                        <td class='hits'>95</td>
                        <td class='source'>    unless tags[:async] do</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>33</td>
                        <td class='hits'>92</td>
                        <td class='source'>      Ecto.Adapters.SQL.Sandbox.mode(Parkapp.Repo, {:shared, self()})</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>34</td>
                        <td class='hits'></td>
                        <td class='source'>    end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>35</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>36</td>
                        <td class='hits'></td>
                        <td class='source'>    {:ok, conn: Phoenix.ConnTest.build_conn()}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>37</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>38</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>39</td>
                        <td class='hits'></td>
                        <td class='source'>  alias Parkapp.DataCase</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>40</td>
                        <td class='hits'></td>
                        <td class='source'>  # Import conveniences for testing with connections</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>41</td>
                        <td class='hits'></td>
                        <td class='source'>  use Phoenix.ConnTest</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>42</td>
                        <td class='hits'></td>
                        <td class='source'>  import ParkappWeb.Router.Helpers</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>43</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>44</td>
                        <td class='hits'></td>
                        <td class='source'>  # The default endpoint for testing</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>45</td>
                        <td class='hits'></td>
                        <td class='source'>  @endpoint ParkappWeb.Endpoint</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>46</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>47</td>
                        <td class='hits'></td>
                        <td class='source'>  def get_unauthorized_message, do: &quot;{\&quot;error\&quot;:\&quot;unauthenticated\&quot;}&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>48</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>49</td>
                        <td class='hits'></td>
                        <td class='source'>  def get_jwt_token() do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>50</td>
                        <td class='hits'></td>
                        <td class='source'>    build_conn()</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>51</td>
                        <td class='hits'>3</td>
                        <td class='source'>    |&gt; get_jwt_token()</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>52</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>53</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>54</td>
                        <td class='hits'></td>
                        <td class='source'>  def get_jwt_token(conn) do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>55</td>
                        <td class='hits'>26</td>
                        <td class='source'>    device = DataCase.device_fixture()</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>56</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>57</td>
                        <td class='hits'>26</td>
                        <td class='source'>    jwt =</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>58</td>
                        <td class='hits'>26</td>
                        <td class='source'>      authenticate_phase2(device.device_id, conn)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>59</td>
                        <td class='hits'></td>
                        <td class='source'>      |&gt; get_from_resp_body(&quot;token&quot;)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>60</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>61</td>
                        <td class='hits'>26</td>
                        <td class='source'>    {jwt, device.device_id}</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>62</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>63</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>64</td>
                        <td class='hits'></td>
                        <td class='source'>  def get_jwt_token_2(conn) do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>65</td>
                        <td class='hits'>1</td>
                        <td class='source'>    device_id = Ecto.UUID.generate()</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>66</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>67</td>
                        <td class='hits'>1</td>
                        <td class='source'>    device =</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>68</td>
                        <td class='hits'></td>
                        <td class='source'>      DataCase.device_fixture(%{</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>69</td>
                        <td class='hits'></td>
                        <td class='source'>        device_id: device_id</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>70</td>
                        <td class='hits'></td>
                        <td class='source'>      })</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>71</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>72</td>
                        <td class='hits'>1</td>
                        <td class='source'>    jwt =</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>73</td>
                        <td class='hits'>1</td>
                        <td class='source'>      authenticate_phase2(device.device_id, conn)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>74</td>
                        <td class='hits'></td>
                        <td class='source'>      |&gt; get_from_resp_body(&quot;token&quot;)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>75</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>76</td>
                        <td class='hits'>1</td>
                        <td class='source'>    {jwt, device.device_id}</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>77</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>78</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>79</td>
                        <td class='hits'></td>
                        <td class='source'>  def authenticate_phase2(device_id, conn) do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>80</td>
                        <td class='hits'></td>
                        <td class='source'>    conn</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>81</td>
                        <td class='hits'>28</td>
                        <td class='source'>    |&gt; post(</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>82</td>
                        <td class='hits'></td>
                        <td class='source'>      authentication_path(conn, :authenticate_phase2,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>83</td>
                        <td class='hits'></td>
                        <td class='source'>        device_id: device_id,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>84</td>
                        <td class='hits'></td>
                        <td class='source'>        encrypted_secret: DataCase.get_encrypted_secret()</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>85</td>
                        <td class='hits'></td>
                        <td class='source'>      )</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>86</td>
                        <td class='hits'></td>
                        <td class='source'>    )</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>87</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>88</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>89</td>
                        <td class='hits'></td>
                        <td class='source'>  def get_from_resp_body(conn, key) do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>90</td>
                        <td class='hits'></td>
                        <td class='source'>    conn</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>91</td>
                        <td class='hits'></td>
                        <td class='source'>    |&gt; Map.get(:resp_body, &quot;&quot;)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>92</td>
                        <td class='hits'></td>
                        <td class='source'>    |&gt; Poison.decode!()</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>93</td>
                        <td class='hits'>28</td>
                        <td class='source'>    |&gt; Map.get(key, &quot;&quot;)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>94</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>95</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>96</td>
                        <td class='hits'></td>
                        <td class='source'>  def get_webhook_mock(http_body) do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>97</td>
                        <td class='hits'>5</td>
                        <td class='source'>    iv = &quot;000000000000000000000000&quot;</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>98</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>99</td>
                        <td class='hits'>5</td>
                        <td class='source'>    iv_from_http_header = iv |&gt; Base.decode16!(case: :mixed)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>100</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>101</td>
                        <td class='hits'>5</td>
                        <td class='source'>    secret_from_config =</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>102</td>
                        <td class='hits'></td>
                        <td class='source'>      Application.get_env(:parkapp, :mb_way_api, [])</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>103</td>
                        <td class='hits'></td>
                        <td class='source'>      |&gt; Enum.into(%{})</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>104</td>
                        <td class='hits'></td>
                        <td class='source'>      |&gt; Map.get(:decrypt_secret, &quot;&quot;)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>105</td>
                        <td class='hits'></td>
                        <td class='source'>      |&gt; Base.decode16!(case: :lower)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>106</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>107</td>
                        <td class='hits'>5</td>
                        <td class='source'>    {http_body_encrypted, auth_tag_from_http_header} =</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>108</td>
                        <td class='hits'></td>
                        <td class='source'>      :crypto.block_encrypt(</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>109</td>
                        <td class='hits'></td>
                        <td class='source'>        :aes_gcm,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>110</td>
                        <td class='hits'></td>
                        <td class='source'>        secret_from_config,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>111</td>
                        <td class='hits'></td>
                        <td class='source'>        iv_from_http_header,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>112</td>
                        <td class='hits'></td>
                        <td class='source'>        {&quot;&quot;, http_body}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>113</td>
                        <td class='hits'></td>
                        <td class='source'>      )</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>114</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>115</td>
                        <td class='hits'>5</td>
                        <td class='source'>    http_body_encrypted =</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>116</td>
                        <td class='hits'></td>
                        <td class='source'>      http_body_encrypted</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>117</td>
                        <td class='hits'></td>
                        <td class='source'>      |&gt; Base.encode16()</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>118</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>119</td>
                        <td class='hits'>5</td>
                        <td class='source'>    auth_tag_from_http_header =</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>120</td>
                        <td class='hits'></td>
                        <td class='source'>      auth_tag_from_http_header</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>121</td>
                        <td class='hits'></td>
                        <td class='source'>      |&gt; Base.encode16()</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>122</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>123</td>
                        <td class='hits'>5</td>
                        <td class='source'>    {http_body_encrypted, iv, auth_tag_from_http_header}</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>124</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>125</td>
                        <td class='hits'></td>
                        <td class='source'>end</td>
                      </tr>
                  
                
              </tbody>
            </table>
          </div>
        
          <div class='file'>
            <h2 id='test/support/data_case.ex'>test/support/data_case.ex</h1>
            <div id='stats' class='high'>
              <div class='percentage'>100</div>
              <div class='sloc'>18</div>
              <div class='hits'>490</div>
              <div class='misses'>0</div>
            </div>
            <table id='source'>
              <thead>
                <tr>
                  <th>Line</th>
                  <th>Hits</th>
                  <th>Source</th>
                </tr>
              <tbody>
                
                  
                      <tr>
                        <td class='line'>0</td>
                        <td class='hits'></td>
                        <td class='source'>defmodule Parkapp.DataCase do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>1</td>
                        <td class='hits'></td>
                        <td class='source'>  @moduledoc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>2</td>
                        <td class='hits'></td>
                        <td class='source'>  This module defines the setup for tests requiring</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>3</td>
                        <td class='hits'></td>
                        <td class='source'>  access to the application&#39;s data layer.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>4</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>5</td>
                        <td class='hits'></td>
                        <td class='source'>  You may define functions here to be used as helpers in</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>6</td>
                        <td class='hits'></td>
                        <td class='source'>  your tests.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>7</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>8</td>
                        <td class='hits'></td>
                        <td class='source'>  Finally, if the test case interacts with the database,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>9</td>
                        <td class='hits'></td>
                        <td class='source'>  it cannot be async. For this reason, every test runs</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>10</td>
                        <td class='hits'></td>
                        <td class='source'>  inside a transaction which is reset at the beginning</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>11</td>
                        <td class='hits'></td>
                        <td class='source'>  of the test unless the test case is marked as async.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>12</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>13</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>14</td>
                        <td class='hits'></td>
                        <td class='source'>  use ExUnit.CaseTemplate</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>15</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>16</td>
                        <td class='hits'>5</td>
                        <td class='source'>  using do</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>17</td>
                        <td class='hits'></td>
                        <td class='source'>    quote do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>18</td>
                        <td class='hits'></td>
                        <td class='source'>      alias Parkapp.Repo</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>19</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>20</td>
                        <td class='hits'></td>
                        <td class='source'>      import Ecto</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>21</td>
                        <td class='hits'></td>
                        <td class='source'>      import Ecto.Changeset</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>22</td>
                        <td class='hits'></td>
                        <td class='source'>      import Ecto.Query</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>23</td>
                        <td class='hits'></td>
                        <td class='source'>      import Parkapp.DataCase</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>24</td>
                        <td class='hits'></td>
                        <td class='source'>    end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>25</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>26</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>27</td>
                        <td class='hits'></td>
                        <td class='source'>  setup tags do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>28</td>
                        <td class='hits'>52</td>
                        <td class='source'>    :ok = Ecto.Adapters.SQL.Sandbox.checkout(Parkapp.Repo)</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>29</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>30</td>
                        <td class='hits'>52</td>
                        <td class='source'>    unless tags[:async] do</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>31</td>
                        <td class='hits'>52</td>
                        <td class='source'>      Ecto.Adapters.SQL.Sandbox.mode(Parkapp.Repo, {:shared, self()})</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>32</td>
                        <td class='hits'></td>
                        <td class='source'>    end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>33</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>34</td>
                        <td class='hits'></td>
                        <td class='source'>    :ok</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>35</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>36</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>37</td>
                        <td class='hits'></td>
                        <td class='source'>  @doc &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>38</td>
                        <td class='hits'></td>
                        <td class='source'>  A helper that transform changeset errors to a map of messages.</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>39</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>40</td>
                        <td class='hits'></td>
                        <td class='source'>      assert {:error, changeset} = Accounts.create_user(%{password: &quot;short&quot;})</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>41</td>
                        <td class='hits'></td>
                        <td class='source'>      assert &quot;password is too short&quot; in errors_on(changeset).password</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>42</td>
                        <td class='hits'></td>
                        <td class='source'>      assert %{password: [&quot;password is too short&quot;]} = errors_on(changeset)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>43</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>44</td>
                        <td class='hits'></td>
                        <td class='source'>  &quot;&quot;&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>45</td>
                        <td class='hits'></td>
                        <td class='source'>  def errors_on(changeset) do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>46</td>
                        <td class='hits'>4</td>
                        <td class='source'>    Ecto.Changeset.traverse_errors(changeset, fn {message, opts} -&gt;</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>47</td>
                        <td class='hits'>7</td>
                        <td class='source'>      Enum.reduce(opts, message, fn {key, value}, acc -&gt;</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>48</td>
                        <td class='hits'>5</td>
                        <td class='source'>        String.replace(acc, &quot;%{#{key}}&quot;, to_string(value))</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>49</td>
                        <td class='hits'></td>
                        <td class='source'>      end)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>50</td>
                        <td class='hits'></td>
                        <td class='source'>    end)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>51</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>52</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>53</td>
                        <td class='hits'></td>
                        <td class='source'>  alias Parkapp.Auth.Devices</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>54</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>55</td>
                        <td class='hits'></td>
                        <td class='source'>  @public_key &quot;MIIBCgKCAQEAjMeo71xLBPFZOWXbZ8rUbDjJzC/p6gk9JLR4RjqJEb9dnSm+qAbA8fG4SKguHJgs5BxJEMJmm7kG1C7GgTPlvFQdhdNRjw23aC34CTEaOuDznuH6y8fjqwrA6gu7ECg/gtACc+R87ArS/mn5w9aeLQcXBKzr3Gi8Yc1Ws9eaa3ukNSVC+GV9SfMWhS9JeiEUc00VbH3UgPFogHOya7PF2ddUckYN4pgxnZ0X39Prx5s/X1oA9lSolVbGxnbQfk4NPgEoKNLj90vQknJN7oPd50DcH3tlSKaOBu2lK1fcJs6Q7cTSukT/kzZxI8uojPpgjaE7fsZwvAsis0ScCabsxQIDAQAB&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>56</td>
                        <td class='hits'></td>
                        <td class='source'>  @device_id Ecto.UUID.generate()</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>57</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>58</td>
                        <td class='hits'></td>
                        <td class='source'>  @secret &quot;yOW3UGXIYLHYUOqfcb0xo4aZk8vXU3ROqBa0yt637n5wddhR88hX720aEt3TixSRGBZtykixQuxBTz1zgSAvVLOiS7lzxEAJ7hPuyCC4FdJ4VlfpEkjFc38iN3If1U_I1s1d5irL5sBQHEKi5hsa1TcSj9Gab-pXRux4lITO7SrYSz6DqDmjkW24GpIaU6O0HtxoZAW-mtB4I9cXDFAnIccbgdqyfk0vAXD8zreMAjsroLJFTjb4Wj5GXXhle_sD&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>59</td>
                        <td class='hits'></td>
                        <td class='source'>  @encrypted_secret &quot;SvYl1oOnKCWq7Z463QdEM/7VvEGwzyajve5AT2RXuekIiWTssT5ZJd3vdYMBK3D7kZUFkDA8fAo3s8+flFFoi6sugSsu9x04cmEA3godnU/LQOv77ZzxZwPyJPHcjJqM/H2PZI2dgTIsMclFJk/D6QMKK2ehXsil6VTW9wus/7eSGSthCCAb+X5gt8N0iaw3HyUcfJA3UW/lcvV/tX8FQAPrU91T+xOudDwHwNgrRXXnHlifhhjgzSJitmBswQ3k3jGf5RWgV0vOecuY7yumY0sTE0TXmWK9L7igIr4ZHTI1I6xuk5tCtW8tGGyW6KHdCzJAvdDRLg6gq1PgGUP7SQ==&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>60</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>61</td>
                        <td class='hits'></td>
                        <td class='source'>  @attrs %{device_id: @device_id, key: @public_key}</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>62</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>63</td>
                        <td class='hits'></td>
                        <td class='source'>  def device_fixture(attrs \\ %{}) do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>64</td>
                        <td class='hits'>68</td>
                        <td class='source'>    {:ok, device} =</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>65</td>
                        <td class='hits'></td>
                        <td class='source'>      Enum.into(attrs, @attrs)</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>66</td>
                        <td class='hits'></td>
                        <td class='source'>      |&gt; Devices.create_device()</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>67</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>68</td>
                        <td class='hits'>68</td>
                        <td class='source'>    device = Devices.get_device!(device.device_id)</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>69</td>
                        <td class='hits'>68</td>
                        <td class='source'>    {:ok, device} = Devices.update_device_secret(device, %{secret: @secret})</td>
                      </tr>
                    
                
                  
                      <tr class='hit'>
                        <td class='line'>70</td>
                        <td class='hits'>68</td>
                        <td class='source'>    device</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>71</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>72</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>73</td>
                        <td class='hits'></td>
                        <td class='source'>  def get_encrypted_secret(), do: @encrypted_secret</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>74</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>75</td>
                        <td class='hits'>3</td>
                        <td class='source'>  def get_basic_device_attrs(), do: @attrs</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>76</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>77</td>
                        <td class='hits'></td>
                        <td class='source'>  alias Parkapp.ReservationsContext</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>78</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>79</td>
                        <td class='hits'></td>
                        <td class='source'>  alias Parkapp.Reservations.{</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>80</td>
                        <td class='hits'></td>
                        <td class='source'>    ReservationType,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>81</td>
                        <td class='hits'></td>
                        <td class='source'>    Reservation</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>82</td>
                        <td class='hits'></td>
                        <td class='source'>  }</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>83</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>84</td>
                        <td class='hits'></td>
                        <td class='source'>  def reservation_fkey_fix() do</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>85</td>
                        <td class='hits'></td>
                        <td class='source'>    {</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>86</td>
                        <td class='hits'></td>
                        <td class='source'>      ReservationType.Enum.single_use(),</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>87</td>
                        <td class='hits'>8</td>
                        <td class='source'>      device_fixture().device_id</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>88</td>
                        <td class='hits'></td>
                        <td class='source'>    }</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>89</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>90</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>91</td>
                        <td class='hits'></td>
                        <td class='source'>  def reservation_fixture() do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>92</td>
                        <td class='hits'>8</td>
                        <td class='source'>    {type_id, device_id} = reservation_fkey_fix()</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>93</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>94</td>
                        <td class='hits'>8</td>
                        <td class='source'>    {:ok, %Reservation{} = reservation} =</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>95</td>
                        <td class='hits'></td>
                        <td class='source'>      ReservationsContext.create_reservation_initial_state(%{</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>96</td>
                        <td class='hits'></td>
                        <td class='source'>        reservation_type_id: type_id,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>97</td>
                        <td class='hits'></td>
                        <td class='source'>        device_id: device_id,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>98</td>
                        <td class='hits'></td>
                        <td class='source'>        barcode: &quot;some barcode&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>99</td>
                        <td class='hits'></td>
                        <td class='source'>        locator: &quot;some locator&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>100</td>
                        <td class='hits'></td>
                        <td class='source'>      })</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>101</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>102</td>
                        <td class='hits'>8</td>
                        <td class='source'>    reservation</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>103</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>104</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>105</td>
                        <td class='hits'></td>
                        <td class='source'>  def reservation_fixture(device_id) do</td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>106</td>
                        <td class='hits'>3</td>
                        <td class='source'>    {:ok, %Reservation{} = reservation} =</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>107</td>
                        <td class='hits'></td>
                        <td class='source'>      ReservationsContext.create_reservation_initial_state(%{</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>108</td>
                        <td class='hits'></td>
                        <td class='source'>        reservation_type_id: ReservationType.Enum.single_use(),</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>109</td>
                        <td class='hits'></td>
                        <td class='source'>        device_id: device_id,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>110</td>
                        <td class='hits'></td>
                        <td class='source'>        barcode: &quot;some barcode&quot;,</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>111</td>
                        <td class='hits'></td>
                        <td class='source'>        locator: &quot;some locator&quot;</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>112</td>
                        <td class='hits'></td>
                        <td class='source'>      })</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>113</td>
                        <td class='hits'></td>
                        <td class='source'></td>
                      </tr>
                  
                
                  
                      <tr class='hit'>
                        <td class='line'>114</td>
                        <td class='hits'>3</td>
                        <td class='source'>    reservation</td>
                      </tr>
                    
                
                  
                      <tr>
                        <td class='line'>115</td>
                        <td class='hits'></td>
                        <td class='source'>  end</td>
                      </tr>
                  
                
                  
                      <tr>
                        <td class='line'>116</td>
                        <td class='hits'></td>
                        <td class='source'>end</td>
                      </tr>
                  
                
              </tbody>
            </table>
          </div>
        
      </div>
    </div>
  </body>
</html>
